<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="theme-color" content="#0A0E13">
  <title>Episodic - Track TV Episodes</title>
  
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  
  <style>
    /* ============================================================================ */
    /* EPISODIC - SEQUOIA-READY DEMO */
    /* Production-quality. Fully functional. Investor-worthy. */
    /* ============================================================================ */
    
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap');
    
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      -webkit-tap-highlight-color: transparent;
    }
    
    :root {
      --bg-primary: #0A0E13;
      --bg-elevated: #12171E;
      --bg-card: #1A1F28;
      --bg-hover: #232930;
      
      --gradient-primary: linear-gradient(135deg, #FF6B35 0%, #F7931E 100%);
      --gradient-glow: linear-gradient(135deg, rgba(255,107,53,0.1) 0%, rgba(247,147,30,0.1) 100%);
      
      --text-primary: #FFFFFF;
      --text-secondary: #A0AEC0;
      --text-tertiary: #718096;
      
      --accent-primary: #FF6B35;
      --accent-secondary: #F7931E;
      --accent-success: #48BB78;
      --accent-error: #F56565;
      --accent-live: #FC5C65;
      
      --border-subtle: rgba(255,255,255,0.06);
      --border-medium: rgba(255,255,255,0.1);
      --border-strong: rgba(255,255,255,0.15);
      
      --shadow-sm: 0 1px 3px rgba(0,0,0,0.2);
      --shadow-md: 0 4px 12px rgba(0,0,0,0.3);
      --shadow-lg: 0 8px 24px rgba(0,0,0,0.4);
      --shadow-xl: 0 16px 48px rgba(0,0,0,0.5);
      --shadow-glow: 0 0 24px rgba(255,107,53,0.3);
      
      --space-4: 4px;
      --space-8: 8px;
      --space-12: 12px;
      --space-16: 16px;
      --space-20: 20px;
      --space-24: 24px;
      --space-32: 32px;
      --space-40: 40px;
      
      --radius-sm: 10px;
      --radius-md: 14px;
      --radius-lg: 18px;
      --radius-xl: 24px;
      --radius-full: 9999px;
      
      --text-xs: 11px;
      --text-sm: 13px;
      --text-base: 15px;
      --text-lg: 17px;
      --text-xl: 20px;
      --text-2xl: 24px;
      --text-3xl: 32px;
      --text-4xl: 40px;
      
      --z-elevated: 10;
      --z-sticky: 50;
      --z-overlay: 900;
      --z-modal: 1000;
      --z-toast: 2000;
    }
    
    body {
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      background: var(--bg-primary);
      color: var(--text-primary);
      overflow-x: hidden;
      font-feature-settings: 'ss01', 'ss02', 'cv02', 'cv03', 'cv04';
    }
    
    #root {
      min-height: 100vh;
      padding-bottom: calc(72px + env(safe-area-inset-bottom));
    }

    * {
      -webkit-overflow-scrolling: touch;
      scroll-behavior: smooth;
    }

    ::-webkit-scrollbar { display: none; }
    
    ::selection {
      background: var(--accent-primary);
      color: white;
    }

    /* Animations */
    @keyframes slideUp {
      from {
        opacity: 0;
        transform: translateY(16px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }

    @keyframes slideInFromBottom {
      from {
        transform: translateY(100%);
        opacity: 0;
      }
      to {
        transform: translateY(0);
        opacity: 1;
      }
    }

    @keyframes pulse {
      0%, 100% {
        opacity: 1;
        transform: scale(1);
      }
      50% {
        opacity: 0.8;
        transform: scale(0.98);
      }
    }

    @keyframes shimmer {
      0% { background-position: -1000px 0; }
      100% { background-position: 1000px 0; }
    }

    @keyframes scaleIn {
      from {
        opacity: 0;
        transform: scale(0.9);
      }
      to {
        opacity: 1;
        transform: scale(1);
      }
    }

    .animate-in { animation: slideUp 0.4s cubic-bezier(0.16, 1, 0.3, 1) forwards; }
    .animate-fade { animation: fadeIn 0.3s ease-out; }
    .animate-scale { animation: scaleIn 0.3s cubic-bezier(0.16, 1, 0.3, 1); }
    .pulse { animation: pulse 2s infinite; }

    /* Components */
    .glass-card {
      background: rgba(26, 31, 40, 0.8);
      backdrop-filter: blur(20px) saturate(180%);
      -webkit-backdrop-filter: blur(20px) saturate(180%);
      border: 1px solid var(--border-subtle);
      border-radius: var(--radius-lg);
      box-shadow: var(--shadow-md);
    }

    .btn {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: var(--space-8);
      padding: var(--space-16) var(--space-24);
      border: none;
      border-radius: var(--radius-md);
      font-size: var(--text-base);
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s cubic-bezier(0.16, 1, 0.3, 1);
      min-height: 48px;
      font-family: inherit;
    }

    .btn-primary {
      background: var(--gradient-primary);
      color: white;
      box-shadow: var(--shadow-sm);
    }

    .btn-primary:active {
      transform: scale(0.97);
      box-shadow: var(--shadow-lg);
    }

    .btn-secondary {
      background: var(--bg-elevated);
      color: var(--text-primary);
      border: 1px solid var(--border-medium);
    }

    .btn-secondary:active {
      background: var(--bg-hover);
      transform: scale(0.98);
    }

    .btn-ghost {
      background: transparent;
      color: var(--text-secondary);
    }

    .btn-ghost:active {
      color: var(--text-primary);
      transform: scale(0.95);
    }

    .input-field {
      width: 100%;
      padding: var(--space-16) var(--space-20);
      background: var(--bg-elevated);
      border: 1px solid var(--border-subtle);
      border-radius: var(--radius-md);
      color: var(--text-primary);
      font-size: var(--text-base);
      font-family: inherit;
      outline: none;
      transition: all 0.2s;
    }

    .input-field:focus {
      border-color: var(--accent-primary);
      box-shadow: 0 0 0 3px rgba(255,107,53,0.1);
    }

    .input-field::placeholder {
      color: var(--text-tertiary);
    }

    .card {
      background: var(--bg-card);
      border: 1px solid var(--border-subtle);
      border-radius: var(--radius-lg);
      padding: var(--space-20);
      transition: all 0.2s cubic-bezier(0.16, 1, 0.3, 1);
    }

    .card-interactive {
      cursor: pointer;
    }

    .card-interactive:active {
      transform: scale(0.98);
      background: var(--bg-hover);
    }

    .overlay {
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.75);
      backdrop-filter: blur(8px);
      -webkit-backdrop-filter: blur(8px);
      z-index: var(--z-overlay);
      animation: fadeIn 0.2s ease-out;
    }

    .bottom-sheet {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      background: var(--bg-elevated);
      border-radius: var(--radius-xl) var(--radius-xl) 0 0;
      z-index: var(--z-modal);
      animation: slideInFromBottom 0.4s cubic-bezier(0.16, 1, 0.3, 1);
      max-height: 90vh;
      overflow-y: auto;
      box-shadow: var(--shadow-xl);
      border-top: 1px solid var(--border-medium);
    }

    .sheet-handle {
      width: 36px;
      height: 4px;
      background: var(--border-strong);
      border-radius: var(--radius-full);
      margin: var(--space-12) auto;
    }

    .bottom-nav {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      background: rgba(18, 23, 30, 0.95);
      backdrop-filter: blur(20px) saturate(180%);
      -webkit-backdrop-filter: blur(20px) saturate(180%);
      border-top: 1px solid var(--border-subtle);
      display: flex;
      z-index: var(--z-sticky);
      padding-bottom: env(safe-area-inset-bottom);
      box-shadow: 0 -4px 24px rgba(0,0,0,0.3);
    }

    .nav-item {
      flex: 1;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: var(--space-4);
      padding: var(--space-12);
      background: none;
      border: none;
      color: var(--text-tertiary);
      cursor: pointer;
      transition: all 0.2s;
      position: relative;
    }

    .nav-item.active {
      color: var(--accent-primary);
    }

    .nav-item.active::before {
      content: '';
      position: absolute;
      top: 0;
      left: 50%;
      transform: translateX(-50%);
      width: 32px;
      height: 2px;
      background: var(--gradient-primary);
      border-radius: 0 0 2px 2px;
    }

    .nav-item:active {
      transform: scale(0.95);
    }

    .stories-container {
      display: flex;
      gap: var(--space-16);
      padding: var(--space-20) var(--space-24);
      overflow-x: auto;
      scroll-snap-type: x mandatory;
    }

    .story-item {
      flex-shrink: 0;
      text-align: center;
      scroll-snap-align: start;
    }

    .story-ring {
      width: 72px;
      height: 72px;
      padding: 3px;
      background: var(--gradient-primary);
      border-radius: var(--radius-full);
      margin-bottom: var(--space-8);
      box-shadow: var(--shadow-glow);
    }

    .story-inner {
      width: 100%;
      height: 100%;
      background: var(--bg-primary);
      border-radius: var(--radius-full);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: var(--text-2xl);
      font-weight: 700;
      color: var(--accent-primary);
      border: 2px solid var(--bg-primary);
    }

    .badge {
      display: inline-flex;
      align-items: center;
      gap: var(--space-8);
      padding: var(--space-8) var(--space-12);
      border-radius: var(--radius-full);
      font-size: var(--text-xs);
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .badge-live {
      background: rgba(252,92,101,0.15);
      color: var(--accent-live);
      border: 1px solid rgba(252,92,101,0.3);
      animation: pulse 2s infinite;
    }

    .badge-hot {
      background: var(--gradient-glow);
      color: var(--accent-primary);
      border: 1px solid rgba(255,107,53,0.3);
    }

    .genre-pill {
      padding: var(--space-8) var(--space-16);
      background: var(--bg-elevated);
      border: 1px solid var(--border-subtle);
      border-radius: var(--radius-full);
      font-size: var(--text-sm);
      font-weight: 600;
      color: var(--text-secondary);
      cursor: pointer;
      transition: all 0.2s;
      white-space: nowrap;
    }

    .genre-pill.active {
      background: var(--gradient-primary);
      color: white;
      border-color: transparent;
      box-shadow: var(--shadow-glow);
    }

    .genre-pill:active {
      transform: scale(0.95);
    }

    .avatar {
      width: 40px;
      height: 40px;
      border-radius: var(--radius-full);
      background: var(--gradient-primary);
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 700;
      color: white;
      flex-shrink: 0;
      box-shadow: var(--shadow-sm);
    }

    .avatar-lg {
      width: 80px;
      height: 80px;
      font-size: var(--text-3xl);
    }

    .fab {
      position: fixed;
      bottom: calc(88px + env(safe-area-inset-bottom));
      right: var(--space-20);
      width: 56px;
      height: 56px;
      background: var(--gradient-primary);
      border: none;
      border-radius: var(--radius-full);
      color: white;
      box-shadow: var(--shadow-lg), 0 0 24px rgba(255,107,53,0.4);
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: var(--z-elevated);
      transition: all 0.3s cubic-bezier(0.16, 1, 0.3, 1);
    }

    .fab:active {
      transform: scale(0.9) rotate(90deg);
    }

    .skeleton {
      background: linear-gradient(
        90deg,
        var(--bg-card) 0%,
        var(--bg-hover) 50%,
        var(--bg-card) 100%
      );
      background-size: 200% 100%;
      animation: shimmer 1.5s infinite;
      border-radius: var(--radius-sm);
    }

    .notification-dot {
      position: absolute;
      top: 0;
      right: 0;
      width: 8px;
      height: 8px;
      background: var(--accent-error);
      border: 2px solid var(--bg-elevated);
      border-radius: var(--radius-full);
      box-shadow: 0 0 8px var(--accent-error);
    }

    .icon {
      width: 24px;
      height: 24px;
      stroke: currentColor;
      stroke-width: 2;
      fill: none;
      stroke-linecap: round;
      stroke-linejoin: round;
    }

    .text-gradient {
      background: var(--gradient-primary);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }
    
    .truncate {
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }

    .line-clamp-2 {
      display: -webkit-box;
      -webkit-line-clamp: 2;
      -webkit-box-orient: vertical;
      overflow: hidden;
    }

    .toast {
      position: fixed;
      bottom: calc(88px + env(safe-area-inset-bottom));
      left: var(--space-20);
      right: var(--space-20);
      background: var(--bg-elevated);
      border: 1px solid var(--border-medium);
      padding: var(--space-16);
      border-radius: var(--radius-lg);
      box-shadow: var(--shadow-xl);
      z-index: var(--z-toast);
      animation: slideUp 0.3s ease-out;
    }

    @media (min-width: 768px) {
      #root {
        max-width: 480px;
        margin: 0 auto;
        box-shadow: 0 0 80px rgba(0,0,0,0.8);
      }
    }
  </style>
</head>
<body>
  <div id="root"></div>
  
  <script type="text/babel">
    const { useState, useMemo, useEffect, useCallback } = React;

    // ============================================================================
    // SEQUOIA-READY DATA LAYER
    // ============================================================================

    const SHOWS = [
      // Reality TV
      { id: 1, name: 'Love Island', year: '2024', genre: 'Reality', subgenre: 'Dating', poster: 'https://image.tmdb.org/t/p/w500/h9f3vNGZGDRqOw26uwDMYhSLZ01.jpg', backdrop: 'https://image.tmdb.org/t/p/w1280/rCqYXh6ztQLpC1BKW3KF0v3DXNP.jpg', rating: 7.2, trending: true },
      { id: 2, name: 'The Bachelor', year: '2024', genre: 'Reality', subgenre: 'Dating', poster: 'https://image.tmdb.org/t/p/w500/mKadW8gXqVdg01IJYkMHNrzoZ3a.jpg', backdrop: 'https://image.tmdb.org/t/p/w1280/jKOuF93E4sjkCYKYMxcjHNKcMXJ.jpg', rating: 6.8, trending: true },
      { id: 3, name: 'Survivor', year: '2024', genre: 'Reality', subgenre: 'Competition', poster: 'https://image.tmdb.org/t/p/w500/ddYkNcvJJ1FJFy3SaZfqTXExkPc.jpg', backdrop: 'https://image.tmdb.org/t/p/w1280/zcMz1BKuP6kZlOsF3Ckd4EAF2jg.jpg', rating: 7.6, trending: true },
      { id: 4, name: 'The Challenge', year: '2023', genre: 'Reality', subgenre: 'Competition', poster: 'https://image.tmdb.org/t/p/w500/6FEsgzt1B8f4NZYuxJWFKH6gveF.jpg', backdrop: 'https://image.tmdb.org/t/p/w1280/5MKWwYRf8ckZAV8Z0BqYT5vnJCR.jpg', rating: 7.8, trending: true },
      { id: 5, name: 'Real Housewives BH', year: '2010', genre: 'Reality', subgenre: 'Lifestyle', poster: 'https://image.tmdb.org/t/p/w500/jCWYWV0TquevYfiJ6pJkGq3Qzhe.jpg', backdrop: 'https://image.tmdb.org/t/p/w1280/1TS0T3WEH9bJWCBYV3DykNqhXTi.jpg', rating: 7.5, trending: false },
      { id: 6, name: 'Big Brother', year: '2023', genre: 'Reality', subgenre: 'Competition', poster: 'https://image.tmdb.org/t/p/w500/xXGpJqRzave5d5BoIxCYTvqPKZZ.jpg', backdrop: 'https://image.tmdb.org/t/p/w1280/z9jyT1h2GRnKCmYZGFSKJf6ecbX.jpg', rating: 6.9, trending: false },
      { id: 7, name: 'The Traitors', year: '2024', genre: 'Reality', subgenre: 'Competition', poster: 'https://image.tmdb.org/t/p/w500/7FN2nmpApXjLjQJKmJBLqZF91pz.jpg', backdrop: 'https://image.tmdb.org/t/p/w1280/qWBLjHB2xFWt2EwFRLxQRpJYXmh.jpg', rating: 8.1, trending: true },
      { id: 8, name: 'Selling Sunset', year: '2023', genre: 'Reality', subgenre: 'Lifestyle', poster: 'https://image.tmdb.org/t/p/w500/8uCnjGLFuFJmPQStqpUJGxGRFGu.jpg', backdrop: 'https://image.tmdb.org/t/p/w1280/5BTQhWmcB2nY7ZdRnOj3SpVZJxQ.jpg', rating: 6.5, trending: false },
      { id: 9, name: 'Love Is Blind', year: '2024', genre: 'Reality', subgenre: 'Dating', poster: 'https://image.tmdb.org/t/p/w500/bHKgb4ShQ8AsCPFe3K4HQC64aKP.jpg', backdrop: 'https://image.tmdb.org/t/p/w1280/wZeOsJBOxWa3WE87tTxuDQEOKc0.jpg', rating: 6.3, trending: false },
      { id: 10, name: 'Married At First Sight', year: '2024', genre: 'Reality', subgenre: 'Dating', poster: 'https://image.tmdb.org/t/p/w500/qfQgdwK0qxFukCNNUIhKwdlQPwE.jpg', backdrop: 'https://image.tmdb.org/t/p/w1280/mCIE71HPd7EvFNKxHwpPGvtEKBY.jpg', rating: 5.8, trending: false },
      
      // Comedy
      { id: 11, name: 'Saturday Night Live', year: '1975', genre: 'Comedy', subgenre: 'Sketch', poster: 'https://image.tmdb.org/t/p/w500/sHGuKFjIBisPk8cvtCZTDVktYfs.jpg', backdrop: 'https://image.tmdb.org/t/p/w1280/iM8kss04YCaGPXJqBkS4rHZbJTW.jpg', rating: 7.1, trending: false },
      { id: 12, name: 'The Office', year: '2005', genre: 'Comedy', subgenre: 'Sitcom', poster: 'https://image.tmdb.org/t/p/w500/qWnJzyZhyy74gjpSjIXWmuk0ifX.jpg', backdrop: 'https://image.tmdb.org/t/p/w1280/4wfVj6K9NzX0J2SZhHlCXDwO1vz.jpg', rating: 9.0, trending: false },
      { id: 13, name: 'Parks and Recreation', year: '2009', genre: 'Comedy', subgenre: 'Sitcom', poster: 'https://image.tmdb.org/t/p/w500/dDuzrl9rUIBYieZjqmtNCdncrmZ.jpg', backdrop: 'https://image.tmdb.org/t/p/w1280/4LRIk7A5BFnP8RhVPGtOl6zqDbI.jpg', rating: 8.6, trending: false },
      { id: 14, name: 'Brooklyn Nine-Nine', year: '2013', genre: 'Comedy', subgenre: 'Sitcom', poster: 'https://image.tmdb.org/t/p/w500/hgRMSOt7a1b8qyQR68vUixJPang.jpg', backdrop: 'https://image.tmdb.org/t/p/w1280/eB6xHAZJQvO3DuwL7J95KmPfBvQ.jpg', rating: 8.4, trending: false },
      { id: 15, name: 'The Good Place', year: '2016', genre: 'Comedy', subgenre: 'Fantasy', poster: 'https://image.tmdb.org/t/p/w500/qIhsuhoIYR5yTnDta0IL4senbeN.jpg', backdrop: 'https://image.tmdb.org/t/p/w1280/dVp7Aw3mO9VRQW66VbGdECOo6vE.jpg', rating: 8.2, trending: false },
      { id: 16, name: 'Abbott Elementary', year: '2021', genre: 'Comedy', subgenre: 'Sitcom', poster: 'https://image.tmdb.org/t/p/w500/fLZJHG8gXF0H1fCYd6cCMKDMkQD.jpg', backdrop: 'https://image.tmdb.org/t/p/w1280/fKGZu5UrLVhXZdmjKMgADPHF2u6.jpg', rating: 8.1, trending: true },
      { id: 17, name: 'Ted Lasso', year: '2020', genre: 'Comedy', subgenre: 'Sports', poster: 'https://image.tmdb.org/t/p/w500/5fhZdwP1DVJ0FyVH6vrFdHwpXIn.jpg', backdrop: 'https://image.tmdb.org/t/p/w1280/9xHALFwEyFZ5fjhXqLLBwPcYg6w.jpg', rating: 8.8, trending: false },
      { id: 18, name: 'What We Do In Shadows', year: '2019', genre: 'Comedy', subgenre: 'Mockumentary', poster: 'https://image.tmdb.org/t/p/w500/chckIPxBbvyFCcCFz5NJwPAkawf.jpg', backdrop: 'https://image.tmdb.org/t/p/w1280/z7D9TxCyBmwuJJqLJF1bW4BtxN2.jpg', rating: 8.6, trending: false },
      
      // Drama
      { id: 21, name: 'Breaking Bad', year: '2008', genre: 'Drama', subgenre: 'Crime', poster: 'https://image.tmdb.org/t/p/w500/ztkUQFLlC19CCMYHW9o1zWhJRNq.jpg', backdrop: 'https://image.tmdb.org/t/p/w1280/tsRy63Mu5cu8etL1X7ZLyf7UP1M.jpg', rating: 9.5, trending: false },
      { id: 22, name: 'Better Call Saul', year: '2015', genre: 'Drama', subgenre: 'Crime', poster: 'https://image.tmdb.org/t/p/w500/fC2HDm5t0kHl7mTm7jxMR31b7by.jpg', backdrop: 'https://image.tmdb.org/t/p/w1280/9NXAlFEE7WDssbXSMgdacsUD58Y.jpg', rating: 9.0, trending: false },
      { id: 23, name: 'Succession', year: '2018', genre: 'Drama', subgenre: 'Family', poster: 'https://image.tmdb.org/t/p/w500/7HW47XbkNQ5fiwQFYGWdw9gs144.jpg', backdrop: 'https://image.tmdb.org/t/p/w1280/cRSHxfJkpUYVbWrfZhYZr42zjTd.jpg', rating: 8.9, trending: false },
      { id: 24, name: 'The Last of Us', year: '2023', genre: 'Drama', subgenre: 'Post-Apocalyptic', poster: 'https://image.tmdb.org/t/p/w500/uKvVjHNqB5VmOrdxqAt2F7J78ED.jpg', backdrop: 'https://image.tmdb.org/t/p/w1280/uDgy6hyPd82kOHh6I95FLtLnj6p.jpg', rating: 8.8, trending: true },
      { id: 25, name: 'The Bear', year: '2022', genre: 'Drama', subgenre: 'Culinary', poster: 'https://image.tmdb.org/t/p/w500/zMpJY5CizTJfH8njYsYk87S9eHf.jpg', backdrop: 'https://image.tmdb.org/t/p/w1280/9z3CCXR7UsCWqmGXVj5aJP0Tc6p.jpg', rating: 8.6, trending: true },
      { id: 26, name: 'The White Lotus', year: '2021', genre: 'Drama', subgenre: 'Anthology', poster: 'https://image.tmdb.org/t/p/w500/gH5i3JbnLsyTvcImlofNvXtH3i5.jpg', backdrop: 'https://image.tmdb.org/t/p/w1280/qoPjww6vRWd8PGWm4c7D1J8zXsH.jpg', rating: 7.9, trending: false },
      { id: 27, name: 'House of the Dragon', year: '2022', genre: 'Drama', subgenre: 'Fantasy', poster: 'https://image.tmdb.org/t/p/w500/7QMsOTMUswlwxJP0rTTZfmz2tX2.jpg', backdrop: 'https://image.tmdb.org/t/p/w1280/7BAHB0R2pUYBLPF0aCFoMZnXAcv.jpg', rating: 8.4, trending: true },
      { id: 28, name: 'Severance', year: '2022', genre: 'Drama', subgenre: 'Thriller', poster: 'https://image.tmdb.org/t/p/w500/lFqJzi7XFuzp3cp6rFxPYL5Frdm.jpg', backdrop: 'https://image.tmdb.org/t/p/w1280/8TJFM24JOaZSdqJqmMlpFcuqSTz.jpg', rating: 8.7, trending: false },
      { id: 29, name: 'The Crown', year: '2016', genre: 'Drama', subgenre: 'Historical', poster: 'https://image.tmdb.org/t/p/w500/1M876KPjulVwppEpldhdc8V4o68.jpg', backdrop: 'https://image.tmdb.org/t/p/w1280/qHepA268S6rLRPbt5fSMIdN1WXb.jpg', rating: 8.6, trending: false },
      { id: 30, name: 'Yellowstone', year: '2018', genre: 'Drama', subgenre: 'Western', poster: 'https://image.tmdb.org/t/p/w500/peNC0PAVqt91mfoP7MdXMqcGiyK.jpg', backdrop: 'https://image.tmdb.org/t/p/w1280/uwjaCH7PzmOvKFO17lbXS6ikHkO.jpg', rating: 8.7, trending: true }
    ];

    // Generate episodes
    const EPISODES = [];
    let epId = 1;

    // Love Island - 15 episodes
    for (let i = 1; i <= 15; i++) {
      EPISODES.push({
        id: epId++,
        showId: 1,
        season: 6,
        episode: i,
        name: `Episode ${i}`,
        date: `Jan ${i + 12}`,
        rating: (7.0 + Math.random() * 2).toFixed(1),
        image: 'https://image.tmdb.org/t/p/w500/h9f3vNGZGDRqOw26uwDMYhSLZ01.jpg',
        desc: 'Drama unfolds in the villa as relationships are tested.'
      });
    }

    // The Bachelor - 10 episodes
    for (let i = 1; i <= 10; i++) {
      EPISODES.push({
        id: epId++,
        showId: 2,
        season: 28,
        episode: i,
        name: `Week ${i}`,
        date: `Feb ${i}`,
        rating: (6.5 + Math.random() * 1.5).toFixed(1),
        image: 'https://image.tmdb.org/t/p/w500/jKOuF93E4sjkCYKYMxcjHNKcMXJ.jpg',
        desc: 'Rose ceremony drama and romantic connections.'
      });
    }

    // Survivor - 12 episodes
    for (let i = 1; i <= 12; i++) {
      EPISODES.push({
        id: epId++,
        showId: 3,
        season: 46,
        episode: i,
        name: `Episode ${i}`,
        date: `Mar ${i}`,
        rating: (7.5 + Math.random() * 1.5).toFixed(1),
        image: 'https://image.tmdb.org/t/p/w500/zcMz1BKuP6kZlOsF3Ckd4EAF2jg.jpg',
        desc: 'Castaways battle for immunity and survival.'
      });
    }

    // SNL - 12 episodes
    for (let i = 1; i <= 12; i++) {
      EPISODES.push({
        id: epId++,
        showId: 11,
        season: 50,
        episode: i,
        name: `Episode ${i}`,
        date: `Oct ${i}`,
        rating: (7.0 + Math.random() * 2.5).toFixed(1),
        image: 'https://image.tmdb.org/t/p/w500/sHGuKFjIBisPk8cvtCZTDVktYfs.jpg',
        desc: 'Live sketch comedy with celebrity host.'
      });
    }

    // Breaking Bad - 5 episodes
    for (let i = 1; i <= 5; i++) {
      EPISODES.push({
        id: epId++,
        showId: 21,
        season: 5,
        episode: i,
        name: `Episode ${i}`,
        date: `2013`,
        rating: (8.5 + Math.random() * 1).toFixed(1),
        image: 'https://image.tmdb.org/t/p/w500/ztkUQFLlC19CCMYHW9o1zWhJRNq.jpg',
        desc: 'Walter White\'s empire faces new challenges.'
      });
    }

    // The Bear - 8 episodes
    for (let i = 1; i <= 8; i++) {
      EPISODES.push({
        id: epId++,
        showId: 25,
        season: 2,
        episode: i,
        name: `Episode ${i}`,
        date: `Jun ${i}`,
        rating: (8.0 + Math.random() * 1.5).toFixed(1),
        image: 'https://image.tmdb.org/t/p/w500/zMpJY5CizTJfH8njYsYk87S9eHf.jpg',
        desc: 'The restaurant crew navigates high-pressure service.'
      });
    }

    const USERS = {
      current: { id: '1', username: 'tvlover', name: 'TV Lover' },
      user2: { id: '2', username: 'realityfan', name: 'Reality Fan' },
      user3: { id: '3', username: 'snlstan', name: 'SNL Stan' },
      user4: { id: '4', username: 'dramaqueen', name: 'Drama Queen' }
    };

    // Hot Takes - more data
    const initialHotTakes = [
      { id: 1, userId: '2', episodeId: 3, content: 'OMG THAT BOMBSHELL ENTRANCE! This is already the best season', time: Date.now() - 15 * 60000, reactions: { fire: 23, skull: 5 }, isLive: false },
      { id: 2, userId: '1', episodeId: 52, content: 'Best SNL episode in years. The writing was incredible', time: Date.now() - 2 * 3600000, reactions: { fire: 45 }, isLive: false },
      { id: 3, userId: '3', episodeId: 20, content: 'This rose ceremony is taking FOREVER', time: Date.now() - 3 * 60000, reactions: { laugh: 8 }, isLive: true },
      { id: 4, userId: '4', episodeId: 70, content: 'Breaking Bad remains unmatched. This finale though', time: Date.now() - 1 * 3600000, reactions: { fire: 67, skull: 12 }, isLive: false },
      { id: 5, userId: '2', episodeId: 8, content: 'The drama in this villa is UNREAL. Best reality TV', time: Date.now() - 30 * 60000, reactions: { fire: 18, eyes: 6 }, isLive: false },
      { id: 6, userId: '3', episodeId: 45, content: 'SNL bringing it this season. Every sketch landing', time: Date.now() - 5 * 3600000, reactions: { fire: 34, laugh: 22 }, isLive: false },
      { id: 7, userId: '4', episodeId: 75, content: 'The Bear is perfection. Every frame is art', time: Date.now() - 20 * 60000, reactions: { fire: 89, heart: 45 }, isLive: false }
    ];

    const WATCHING_NOW = [
      { userId: '2', episodeId: 5 },
      { userId: '3', episodeId: 20 },
      { userId: '4', episodeId: 71 }
    ];

    const YOUR_ACTIVITY = [
      { id: 1, type: 'like', userId: '2', episodeId: 52, content: 'liked your hot take', time: Date.now() - 5 * 60000 },
      { id: 2, type: 'like', userId: '3', episodeId: 52, content: 'liked your hot take', time: Date.now() - 12 * 60000 },
      { id: 3, type: 'comment', userId: '4', episodeId: 52, content: 'replied to your hot take', time: Date.now() - 20 * 60000 },
      { id: 4, type: 'like', userId: '2', episodeId: 3, content: 'liked your rating', time: Date.now() - 1 * 3600000 },
      { id: 5, type: 'follow', userId: '4', content: 'started following you', time: Date.now() - 2 * 3600000 }
    ];

    // Comments on hot takes
    const initialComments = [
      { id: 1, takeId: 1, userId: '1', content: 'Agreed! Best drama in years', time: Date.now() - 10 * 60000 },
      { id: 2, takeId: 1, userId: '4', content: 'The twist was insane', time: Date.now() - 8 * 60000 },
      { id: 3, takeId: 2, userId: '2', content: 'That monologue though', time: Date.now() - 1 * 3600000 }
    ];

    // Reviews (long-form, separate from hot takes)
    const initialReviews = [
      { id: 1, userId: '1', episodeId: 70, rating: 5, content: 'Breaking Bad\'s finale is a masterclass in television storytelling. Every thread comes together perfectly, and Walter White\'s arc concludes with such precision. The tension builds throughout, and the payoff is absolutely worth it. This is how you end a series.', hasSpoilers: true, time: Date.now() - 5 * 3600000, likes: 34 },
      { id: 2, userId: '2', episodeId: 3, rating: 4.5, content: 'Love Island continues to deliver pure entertainment. The new bombshell entrance created immediate chaos in the villa, exactly what we needed. The drama is authentic and the connections feel real this season.', hasSpoilers: false, time: Date.now() - 2 * 3600000, likes: 18 }
    ];

    // Streaming services
    const STREAMING_SERVICES = ['Netflix', 'Hulu', 'HBO Max', 'Disney+', 'Prime Video', 'Peacock', 'Paramount+', 'Apple TV+'];

    // Popular this week (based on ratings/activity)
    const POPULAR_THIS_WEEK = [1, 3, 7, 24, 25]; // Show IDs

    // Tags
    const EPISODE_TAGS = {
      3: ['bombshell', 'drama', 'recoupling'],
      52: ['comedy gold', 'celebrity host', 'political'],
      70: ['finale', 'masterpiece', 'emotional']
    };

    // Icon Component (CUSTOM - NO EMOJIS)
    const Icon = ({ name, size = 24 }) => {
      const icons = {
        Home: <svg className="icon" width={size} height={size} viewBox="0 0 24 24"><path d="m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/></svg>,
        Flame: <svg className="icon" width={size} height={size} viewBox="0 0 24 24"><path d="M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z"/></svg>,
        Bell: <svg className="icon" width={size} height={size} viewBox="0 0 24 24"><path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"></path><path d="M13.73 21a2 2 0 0 1-3.46 0"></path></svg>,
        User: <svg className="icon" width={size} height={size} viewBox="0 0 24 24"><path d="M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>,
        Search: <svg className="icon" width={size} height={size} viewBox="0 0 24 24"><circle cx="11" cy="11" r="8"/><path d="m21 21-4.35-4.35"/></svg>,
        Star: <svg className="icon" width={size} height={size} viewBox="0 0 24 24"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg>,
        ChevronLeft: <svg className="icon" width={size} height={size} viewBox="0 0 24 24"><polyline points="15 18 9 12 15 6"/></svg>,
        ChevronDown: <svg className="icon" width={size} height={size} viewBox="0 0 24 24"><polyline points="6 9 12 15 18 9"/></svg>,
        Plus: <svg className="icon" width={size} height={size} viewBox="0 0 24 24"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg>,
        X: <svg className="icon" width={size} height={size} viewBox="0 0 24 24"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>,
        Heart: <svg className="icon" width={size} height={size} viewBox="0 0 24 24"><path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"/></svg>,
        MessageCircle: <svg className="icon" width={size} height={size} viewBox="0 0 24 24"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path></svg>,
        List: <svg className="icon" width={size} height={size} viewBox="0 0 24 24"><line x1="8" y1="6" x2="21" y2="6"></line><line x1="8" y1="12" x2="21" y2="12"></line><line x1="8" y1="18" x2="21" y2="18"></line><line x1="3" y1="6" x2="3.01" y2="6"></line><line x1="3" y1="12" x2="3.01" y2="12"></line><line x1="3" y1="18" x2="3.01" y2="18"></line></svg>,
        BarChart: <svg className="icon" width={size} height={size} viewBox="0 0 24 24"><line x1="12" y1="20" x2="12" y2="10"></line><line x1="18" y1="20" x2="18" y2="4"></line><line x1="6" y1="20" x2="6" y2="16"></line></svg>,
        Eye: <svg className="icon" width={size} height={size} viewBox="0 0 24 24"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path><circle cx="12" cy="12" r="3"></circle></svg>,
        Calendar: <svg className="icon" width={size} height={size} viewBox="0 0 24 24"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line></svg>,
        Send: <svg className="icon" width={size} height={size} viewBox="0 0 24 24"><line x1="22" y1="2" x2="11" y2="13"></line><polygon points="22 2 15 22 11 13 2 9 22 2"></polygon></svg>,
        TrendingUp: <svg className="icon" width={size} height={size} viewBox="0 0 24 24"><polyline points="23 6 13.5 15.5 8.5 10.5 1 18"></polyline><polyline points="17 6 23 6 23 12"></polyline></svg>,
        Award: <svg className="icon" width={size} height={size} viewBox="0 0 24 24"><circle cx="12" cy="8" r="7"></circle><polyline points="8.21 13.89 7 23 12 20 17 23 15.79 13.88"></polyline></svg>,
        UserPlus: <svg className="icon" width={size} height={size} viewBox="0 0 24 24"><path d="M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path><circle cx="8.5" cy="7" r="4"></circle><line x1="20" y1="8" x2="20" y2="14"></line><line x1="23" y1="11" x2="17" y2="11"></line></svg>,
        UserMinus: <svg className="icon" width={size} height={size} viewBox="0 0 24 24"><path d="M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path><circle cx="8.5" cy="7" r="4"></circle><line x1="23" y1="11" x2="17" y2="11"></line></svg>,
        Users: <svg className="icon" width={size} height={size} viewBox="0 0 24 24"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path><circle cx="9" cy="7" r="4"></circle><path d="M23 21v-2a4 4 0 0 0-3-3.87"></path><path d="M16 3.13a4 4 0 0 1 0 7.75"></path></svg>,
        Share: <svg className="icon" width={size} height={size} viewBox="0 0 24 24"><circle cx="18" cy="5" r="3"></circle><circle cx="6" cy="12" r="3"></circle><circle cx="18" cy="19" r="3"></circle><line x1="8.59" y1="13.51" x2="15.42" y2="17.49"></line><line x1="15.41" y1="6.51" x2="8.59" y2="10.49"></line></svg>,
        AlertCircle: <svg className="icon" width={size} height={size} viewBox="0 0 24 24"><circle cx="12" cy="12" r="10"></circle><line x1="12" y1="8" x2="12" y2="12"></line><line x1="12" y1="16" x2="12.01" y2="16"></line></svg>,
        BookOpen: <svg className="icon" width={size} height={size} viewBox="0 0 24 24"><path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"></path><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"></path></svg>,
        Clock: <svg className="icon" width={size} height={size} viewBox="0 0 24 24"><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg>,
        Film: <svg className="icon" width={size} height={size} viewBox="0 0 24 24"><rect x="2" y="2" width="20" height="20" rx="2.18" ry="2.18"></rect><line x1="7" y1="2" x2="7" y2="22"></line><line x1="17" y1="2" x2="17" y2="22"></line><line x1="2" y1="12" x2="22" y2="12"></line><line x1="2" y1="7" x2="7" y2="7"></line><line x1="2" y1="17" x2="7" y2="17"></line><line x1="17" y1="17" x2="22" y2="17"></line><line x1="17" y1="7" x2="22" y2="7"></line></svg>,
        Tag: <svg className="icon" width={size} height={size} viewBox="0 0 24 24"><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7.01" y2="7"></line></svg>,
        Bookmark: <svg className="icon" width={size} height={size} viewBox="0 0 24 24"><path d="M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z"></path></svg>
      };
      return icons[name] || icons.Star;
    };

    // ============================================================================
    // MAIN APP WITH COMPLETE STATE MANAGEMENT
    // ============================================================================
    function App() {
      const [tab, setTab] = useState('home');
      const [show, setShow] = useState(null);
      const [composer, setComposer] = useState(false);
      const [toast, setToast] = useState(null);
      
      // STATE MANAGEMENT - FULLY FUNCTIONAL
      const [ratings, setRatings] = useState({});
      const [hotTakes, setHotTakes] = useState(initialHotTakes);
      const [comments, setComments] = useState(initialComments);
      const [reviews, setReviews] = useState(initialReviews);
      const [watchlist, setWatchlist] = useState([3, 7, 24]); // Episode IDs
      const [lists, setLists] = useState([]);
      const [diary, setDiary] = useState({}); // { episodeId: { date, service, rewatch } }
      const [following, setFollowing] = useState(['2', '3']); // User IDs we follow
      const [likedTakes, setLikedTakes] = useState([1, 2]); // Take IDs we liked
      const [likedReviews, setLikedReviews] = useState([1]); // Review IDs we liked

      const showToast = useCallback((message) => {
        setToast(message);
        setTimeout(() => setToast(null), 3000);
      }, []);

      // FOLLOW/UNFOLLOW
      const toggleFollow = useCallback((userId) => {
        setFollowing(prev => {
          if (prev.includes(userId)) {
            showToast('Unfollowed');
            return prev.filter(id => id !== userId);
          } else {
            showToast('Following!');
            return [...prev, userId];
          }
        });
      }, [showToast]);

      // RATINGS
      const handleRateEpisode = useCallback((episodeId, rating) => {
        setRatings(prev => ({ ...prev, [episodeId]: rating }));
        showToast('Rating saved!');
      }, [showToast]);

      // HOT TAKES
      const handlePostHotTake = useCallback((content, episodeId) => {
        const newTake = {
          id: Date.now(),
          userId: '1',
          episodeId,
          content,
          time: Date.now(),
          reactions: { fire: 0 },
          isLive: false
        };
        setHotTakes(prev => [newTake, ...prev]);
        showToast('Hot take posted!');
      }, [showToast]);

      const toggleLikeTake = useCallback((takeId) => {
        setLikedTakes(prev => {
          if (prev.includes(takeId)) {
            return prev.filter(id => id !== takeId);
          } else {
            showToast('Liked!');
            return [...prev, takeId];
          }
        });
      }, [showToast]);

      // COMMENTS
      const handlePostComment = useCallback((takeId, content) => {
        const newComment = {
          id: Date.now(),
          takeId,
          userId: '1',
          content,
          time: Date.now()
        };
        setComments(prev => [...prev, newComment]);
        showToast('Comment posted!');
      }, [showToast]);

      // REVIEWS
      const handlePostReview = useCallback((episodeId, rating, content, hasSpoilers) => {
        const newReview = {
          id: Date.now(),
          userId: '1',
          episodeId,
          rating,
          content,
          hasSpoilers,
          time: Date.now(),
          likes: 0
        };
        setReviews(prev => [newReview, ...prev]);
        showToast('Review posted!');
      }, [showToast]);

      const toggleLikeReview = useCallback((reviewId) => {
        setLikedReviews(prev => {
          if (prev.includes(reviewId)) {
            return prev.filter(id => id !== reviewId);
          } else {
            showToast('Liked!');
            return [...prev, reviewId];
          }
        });
      }, [showToast]);

      // WATCHLIST
      const toggleWatchlist = useCallback((episodeId) => {
        setWatchlist(prev => {
          if (prev.includes(episodeId)) {
            showToast('Removed from watchlist');
            return prev.filter(id => id !== episodeId);
          } else {
            showToast('Added to watchlist!');
            return [...prev, episodeId];
          }
        });
      }, [showToast]);

      // DIARY
      const markWatched = useCallback((episodeId, service, isRewatch = false) => {
        setDiary(prev => ({
          ...prev,
          [episodeId]: {
            date: new Date().toISOString(),
            service,
            rewatch: isRewatch
          }
        }));
        showToast(isRewatch ? 'Marked as rewatched!' : 'Marked as watched!');
      }, [showToast]);

      return (
        <div>
          {show ? (
            <ShowView 
              show={show} 
              onBack={() => setShow(null)}
              ratings={ratings}
              onRate={handleRateEpisode}
              onPostTake={handlePostHotTake}
              onPostReview={handlePostReview}
              watchlist={watchlist}
              onToggleWatchlist={toggleWatchlist}
              diary={diary}
              onMarkWatched={markWatched}
              likedTakes={likedTakes}
              onToggleLikeTake={toggleLikeTake}
              comments={comments}
              onPostComment={handlePostComment}
            />
          ) : (
            <>
              {tab === 'home' && <HomeView onSelectShow={setShow} following={following} />}
              {tab === 'hot-takes' && <HotTakesView onSelectShow={setShow} onCompose={() => setComposer(true)} hotTakes={hotTakes} likedTakes={likedTakes} onToggleLike={toggleLikeTake} comments={comments} onPostComment={handlePostComment} />}
              {tab === 'activity' && <ActivityView onSelectShow={setShow} following={following} onToggleFollow={toggleFollow} />}
              {tab === 'watchlist' && <WatchlistView onSelectShow={setShow} watchlist={watchlist} onToggleWatchlist={toggleWatchlist} />}
              {tab === 'lists' && <ListsView onSelectShow={setShow} lists={lists} setLists={setLists} />}
              {tab === 'diary' && <DiaryView onSelectShow={setShow} diary={diary} ratings={ratings} />}
              {tab === 'stats' && <StatsView ratings={ratings} hotTakes={hotTakes.filter(t => t.userId === '1')} diary={diary} />}
              {tab === 'profile' && <ProfileView ratings={ratings} hotTakes={hotTakes.filter(t => t.userId === '1')} following={following} onToggleFollow={toggleFollow} />}
            </>
          )}
          
          {!show && <BottomNav tab={tab} onTabChange={setTab} />}
          {composer && <Composer onClose={() => setComposer(false)} onPost={(content) => { handlePostHotTake(content); setComposer(false); }} />}
          {toast && (
            <div className="toast animate-scale">
              <div style={{ fontSize: 'var(--text-base)', fontWeight: '600', color: 'var(--text-primary)' }}>{toast}</div>
            </div>
          )}
        </div>
      );
    }

    // ============================================================================
    // BOTTOM NAV
    // ============================================================================
    function BottomNav({ tab, onTabChange }) {
      const hasNotifications = YOUR_ACTIVITY.some(a => Date.now() - a.time < 15 * 60000);
      
      return (
        <nav className="bottom-nav">
          {[
            { id: 'home', icon: 'Home', label: 'Home' },
            { id: 'hot-takes', icon: 'Flame', label: 'Hot Takes' },
            { id: 'lists', icon: 'List', label: 'Lists' },
            { id: 'diary', icon: 'Calendar', label: 'Diary' },
            { id: 'profile', icon: 'User', label: 'You' }
          ].map(item => (
            <button
              key={item.id}
              className={`nav-item ${tab === item.id ? 'active' : ''}`}
              onClick={() => onTabChange(item.id)}
            >
              <div style={{ position: 'relative' }}>
                <Icon name={item.icon} size={24} />
                {item.badge && <span className="notification-dot" />}
              </div>
              <span style={{ fontSize: 'var(--text-xs)', fontWeight: '600' }}>{item.label}</span>
            </button>
          ))}
        </nav>
      );
    }

    // ============================================================================
    // HOME VIEW - ENHANCED WITH POPULAR & FOLLOWING FEED
    // ============================================================================
    function HomeView({ onSelectShow, following }) {
      const [search, setSearch] = useState('');
      const [results, setResults] = useState([]);
      const [genre, setGenre] = useState('all');
      const [feedType, setFeedType] = useState('everyone'); // 'everyone' or 'following'
      const [loading, setLoading] = useState(false);

      const trending = useMemo(() => SHOWS.filter(s => s.trending), []);
      const popular = useMemo(() => SHOWS.filter(s => POPULAR_THIS_WEEK.includes(s.id)), []);
      
      const filteredShows = useMemo(() => {
        if (genre === 'all') return SHOWS;
        return SHOWS.filter(s => s.genre === genre);
      }, [genre]);

      function handleSearch(q) {
        setSearch(q);
        if (!q.trim()) {
          setResults([]);
          return;
        }
        setLoading(true);
        setTimeout(() => {
          setResults(SHOWS.filter(s => s.name.toLowerCase().includes(q.toLowerCase())));
          setLoading(false);
        }, 200);
      }

      return (
        <div style={{ minHeight: '100vh', background: 'var(--bg-primary)' }}>
          {/* Header */}
          <div style={{ position: 'sticky', top: 0, background: 'rgba(10,14,19,0.95)', backdropFilter: 'blur(20px)', borderBottom: '1px solid var(--border-subtle)', padding: 'var(--space-20) var(--space-24)', zIndex: 'var(--z-sticky)' }}>
            <div style={{ display: 'flex', alignItems: 'center', justifyContent: 'space-between', marginBottom: 'var(--space-16)' }}>
              <h1 className="text-gradient" style={{ fontSize: 'var(--text-4xl)', fontWeight: '800', letterSpacing: '-0.02em' }}>
                Episodic
              </h1>
              {following.length > 0 && (
                <div style={{ display: 'flex', gap: 'var(--space-8)' }}>
                  <button
                    onClick={() => setFeedType('everyone')}
                    className={`genre-pill ${feedType === 'everyone' ? 'active' : ''}`}
                    style={{ fontSize: 'var(--text-xs)' }}
                  >
                    Everyone
                  </button>
                  <button
                    onClick={() => setFeedType('following')}
                    className={`genre-pill ${feedType === 'following' ? 'active' : ''}`}
                    style={{ fontSize: 'var(--text-xs)' }}
                  >
                    <Icon name="Users" size={14} />
                    Following
                  </button>
                </div>
              )}
            </div>
            
            <div style={{ position: 'relative' }}>
              <div style={{ position: 'relative' }}>
                <Icon name="Search" size={20} style={{ position: 'absolute', left: 'var(--space-16)', top: '50%', transform: 'translateY(-50%)', color: 'var(--text-tertiary)', pointerEvents: 'none', zIndex: 1 }} />
                <input
                  type="text"
                  placeholder="Search shows..."
                  value={search}
                  onChange={(e) => handleSearch(e.target.value)}
                  className="input-field"
                  style={{ paddingLeft: 'var(--space-48)' }}
                />
              </div>

              {results.length > 0 && (
                <div className="glass-card animate-scale" style={{ position: 'absolute', top: '100%', left: 0, right: 0, marginTop: 'var(--space-8)', zIndex: 100, maxHeight: '400px', overflowY: 'auto', padding: 'var(--space-8)' }}>
                  {results.map((s, i) => (
                    <button
                      key={s.id}
                      onClick={() => { onSelectShow(s); setResults([]); setSearch(''); }}
                      className="card-interactive animate-in"
                      style={{ width: '100%', display: 'flex', gap: 'var(--space-16)', padding: 'var(--space-12)', background: 'transparent', border: 'none', cursor: 'pointer', textAlign: 'left', borderRadius: 'var(--radius-md)', animationDelay: `${i * 30}ms` }}
                    >
                      <img src={s.poster} alt={s.name} style={{ width: '44px', height: '66px', borderRadius: 'var(--radius-sm)', objectFit: 'cover', boxShadow: 'var(--shadow-sm)' }} />
                      <div style={{ flex: 1 }}>
                        <div style={{ color: 'var(--text-primary)', fontSize: 'var(--text-base)', fontWeight: '600', marginBottom: 'var(--space-4)' }}>{s.name}</div>
                        <div style={{ color: 'var(--text-tertiary)', fontSize: 'var(--text-sm)' }}>{s.year} â€¢ {s.genre}</div>
                      </div>
                    </button>
                  ))}
                </div>
              )}
            </div>
          </div>

          {/* Genre Filter */}
          <div style={{ padding: 'var(--space-16) var(--space-24)', display: 'flex', gap: 'var(--space-12)', overflowX: 'auto' }}>
            {['all', 'Reality', 'Comedy', 'Drama'].map(g => (
              <button
                key={g}
                className={`genre-pill ${genre === g ? 'active' : ''}`}
                onClick={() => setGenre(g)}
              >
                {g === 'all' ? 'All Shows' : g}
              </button>
            ))}
          </div>

          {/* Watching Now Stories */}
          {WATCHING_NOW.length > 0 && (
            <div className="stories-container">
              {WATCHING_NOW.map((w, i) => {
                const user = Object.values(USERS).find(u => u.id === w.userId);
                return (
                  <div key={i} className="story-item">
                    <div className="story-ring pulse">
                      <div className="story-inner">{user.username[0].toUpperCase()}</div>
                    </div>
                    <div className="truncate" style={{ fontSize: 'var(--text-xs)', color: 'var(--text-tertiary)', fontWeight: '600', maxWidth: '72px' }}>
                      {user.username}
                    </div>
                  </div>
                );
              })}
            </div>
          )}

          {/* Shows Grid */}
          <div style={{ padding: 'var(--space-24)' }}>
            {popular.length > 0 && genre === 'all' && (
              <ShowSection title="Popular This Week" shows={popular} onSelect={onSelectShow} icon="TrendingUp" />
            )}
            {trending.length > 0 && genre === 'all' && (
              <ShowSection title="Trending Now" shows={trending} onSelect={onSelectShow} icon="Flame" />
            )}
            <ShowSection title={genre === 'all' ? 'All Shows' : genre} shows={filteredShows} onSelect={onSelectShow} />
          </div>
        </div>
      );
    }

    function ShowSection({ title, shows, onSelect, icon }) {
      return (
        <div style={{ marginBottom: 'var(--space-40)' }}>
          <div style={{ display: 'flex', alignItems: 'center', gap: 'var(--space-12)', marginBottom: 'var(--space-20)' }}>
            <h2 style={{ fontSize: 'var(--text-xl)', fontWeight: '700', color: 'var(--text-primary)' }}>{title}</h2>
            {icon && <Icon name={icon} size={20} style={{ color: 'var(--accent-primary)' }} />}
          </div>
          <div style={{ display: 'grid', gridTemplateColumns: 'repeat(3, 1fr)', gap: 'var(--space-16)' }}>
            {shows.map((s, i) => (
              <div key={s.id} onClick={() => onSelect(s)} className="animate-in" style={{ cursor: 'pointer', animationDelay: `${i * 40}ms` }}>
                <div style={{ position: 'relative', paddingBottom: '150%', background: 'var(--bg-card)', borderRadius: 'var(--radius-lg)', overflow: 'hidden', marginBottom: 'var(--space-12)', boxShadow: 'var(--shadow-md)', transition: 'transform 0.2s' }} onMouseDown={(e) => e.currentTarget.style.transform = 'scale(0.95)'} onMouseUp={(e) => e.currentTarget.style.transform = 'scale(1)'} onMouseLeave={(e) => e.currentTarget.style.transform = 'scale(1)'}>
                  <img src={s.poster} alt={s.name} style={{ position: 'absolute', width: '100%', height: '100%', objectFit: 'cover' }} />
                  {s.trending && (
                    <div className="badge-hot" style={{ position: 'absolute', top: 'var(--space-8)', right: 'var(--space-8)' }}>
                      HOT
                    </div>
                  )}
                </div>
                <div className="truncate" style={{ fontSize: 'var(--text-sm)', fontWeight: '600', color: 'var(--text-primary)', marginBottom: 'var(--space-4)' }}>{s.name}</div>
                <div style={{ fontSize: 'var(--text-xs)', color: 'var(--text-tertiary)' }}>{s.year} â€¢ {s.genre}</div>
              </div>
            ))}
          </div>
        </div>
      );
    }

    // ============================================================================
    // SHOW VIEW - COMPLETE
    // ============================================================================
    function ShowView({ show, onBack, ratings, onRate, onPostTake }) {
      const eps = EPISODES.filter(e => e.showId === show.id);
      const [selected, setSelected] = useState(null);

      return (
        <div style={{ minHeight: '100vh', background: 'var(--bg-primary)' }}>
          {/* Hero */}
          <div style={{ position: 'relative', height: '320px' }}>
            <img src={show.backdrop} alt={show.name} style={{ width: '100%', height: '100%', objectFit: 'cover' }} />
            <div style={{ position: 'absolute', inset: 0, background: 'linear-gradient(to bottom, rgba(10,14,19,0.2) 0%, rgba(10,14,19,0.8) 70%, var(--bg-primary) 100%)' }} />
            
            <button
              onClick={onBack}
              className="btn-secondary"
              style={{ position: 'absolute', top: 'var(--space-20)', left: 'var(--space-20)', width: '48px', height: '48px', padding: 0, backdropFilter: 'blur(20px)', WebkitBackdropFilter: 'blur(20px)', background: 'rgba(18,23,30,0.8)' }}
            >
              <Icon name="ChevronLeft" size={24} />
            </button>

            <div style={{ position: 'absolute', bottom: 'var(--space-24)', left: 'var(--space-24)', right: 'var(--space-24)' }}>
              <h1 style={{ fontSize: 'var(--text-4xl)', fontWeight: '800', marginBottom: 'var(--space-12)', textShadow: '0 4px 12px rgba(0,0,0,0.8)', letterSpacing: '-0.02em' }}>{show.name}</h1>
              <div style={{ display: 'flex', alignItems: 'center', gap: 'var(--space-12)', fontSize: 'var(--text-sm)', fontWeight: '600', textShadow: '0 2px 8px rgba(0,0,0,0.8)' }}>
                <span style={{ color: 'var(--text-secondary)' }}>{show.year}</span>
                <span style={{ color: 'var(--text-tertiary)' }}>â€¢</span>
                <span style={{ color: 'var(--text-secondary)' }}>{show.genre}</span>
                <span style={{ color: 'var(--text-tertiary)' }}>â€¢</span>
                <div style={{ display: 'flex', alignItems: 'center', gap: 'var(--space-6)' }}>
                  <Icon name="Star" size={16} style={{ color: 'var(--accent-primary)' }} />
                  <span style={{ color: 'var(--accent-primary)' }}>{show.rating}</span>
                </div>
              </div>
            </div>
          </div>

          {/* Episodes */}
          <div style={{ padding: 'var(--space-24)' }}>
            <h2 style={{ fontSize: 'var(--text-xl)', fontWeight: '700', marginBottom: 'var(--space-20)', color: 'var(--text-primary)' }}>Episodes</h2>
            {eps.length === 0 ? (
              <div className="card" style={{ padding: 'var(--space-40)', textAlign: 'center' }}>
                <Icon name="Calendar" size={48} style={{ color: 'var(--text-tertiary)', margin: '0 auto var(--space-16)' }} />
                <div style={{ fontSize: 'var(--text-lg)', fontWeight: '600', color: 'var(--text-primary)', marginBottom: 'var(--space-8)' }}>No episodes yet</div>
                <div style={{ fontSize: 'var(--text-sm)', color: 'var(--text-secondary)' }}>Check back soon for new episodes</div>
              </div>
            ) : (
              eps.map((ep, i) => (
                <div
                  key={ep.id}
                  className="card card-interactive animate-in"
                  onClick={() => setSelected(ep)}
                  style={{ marginBottom: 'var(--space-16)', animationDelay: `${i * 40}ms` }}
                >
                  <div style={{ display: 'flex', gap: 'var(--space-16)' }}>
                    <div style={{ position: 'relative', flexShrink: 0 }}>
                      <img src={ep.image} alt={ep.name} style={{ width: '140px', height: '79px', borderRadius: 'var(--radius-md)', objectFit: 'cover', boxShadow: 'var(--shadow-sm)' }} />
                      {ratings[ep.id] && (
                        <div style={{ position: 'absolute', top: 'var(--space-8)', right: 'var(--space-8)', background: 'rgba(0,0,0,0.8)', backdropFilter: 'blur(10px)', padding: 'var(--space-4) var(--space-8)', borderRadius: 'var(--radius-sm)', display: 'flex', alignItems: 'center', gap: 'var(--space-4)' }}>
                          <Icon name="Star" size={12} style={{ color: 'var(--accent-primary)' }} />
                          <span style={{ fontSize: 'var(--text-xs)', fontWeight: '700', color: 'var(--accent-primary)' }}>{ratings[ep.id]}</span>
                        </div>
                      )}
                    </div>
                    <div style={{ flex: 1, minWidth: 0 }}>
                      <div style={{ fontSize: 'var(--text-xs)', color: 'var(--text-tertiary)', fontWeight: '700', marginBottom: 'var(--space-6)', textTransform: 'uppercase', letterSpacing: '0.5px' }}>S{ep.season}E{ep.episode}</div>
                      <div className="truncate" style={{ fontSize: 'var(--text-base)', fontWeight: '600', color: 'var(--text-primary)', marginBottom: 'var(--space-6)' }}>{ep.name}</div>
                      <div style={{ fontSize: 'var(--text-xs)', color: 'var(--text-tertiary)', display: 'flex', alignItems: 'center', gap: 'var(--space-12)' }}>
                        <span>{ep.date}</span>
                        <span>â€¢</span>
                        <div style={{ display: 'flex', alignItems: 'center', gap: 'var(--space-4)' }}>
                          <Icon name="Star" size={12} style={{ color: 'var(--accent-primary)' }} />
                          <span style={{ color: 'var(--accent-primary)', fontWeight: '600' }}>{ep.rating}</span>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              ))
            )}
          </div>

          {selected && <EpisodeModal ep={selected} show={show} onClose={() => setSelected(null)} onRate={onRate} onPostTake={onPostTake} currentRating={ratings[selected.id]} />}
        </div>
      );
    }

    // ============================================================================
    // EPISODE MODAL - COMPLETE
    // ============================================================================
    function EpisodeModal({ ep, show, onClose, onRate, onPostTake, currentRating }) {
      const [rating, setRating] = useState(currentRating || 0);
      const [watching, setWatching] = useState(false);
      const [showComposer, setShowComposer] = useState(false);
      const [showDiscussion, setShowDiscussion] = useState(false);

      const episodeTakes = initialHotTakes.filter(t => t.episodeId === ep.id);

      function handleRate(r) {
        setRating(r);
        onRate(ep.id, r);
      }

      return (
        <>
          <div className="overlay" onClick={onClose} />
          <div className="bottom-sheet">
            <div className="sheet-handle" />
            
            <div style={{ padding: '0 var(--space-24) var(--space-40)' }}>
              {/* Header */}
              <div style={{ display: 'flex', gap: 'var(--space-16)', marginBottom: 'var(--space-24)' }}>
                <img src={ep.image} alt={ep.name} style={{ width: '120px', height: '68px', borderRadius: 'var(--radius-md)', objectFit: 'cover', boxShadow: 'var(--shadow-md)' }} />
                <div style={{ flex: 1, minWidth: 0 }}>
                  <div style={{ fontSize: 'var(--text-sm)', color: 'var(--accent-primary)', fontWeight: '700', marginBottom: 'var(--space-6)' }}>{show.name}</div>
                  <div className="line-clamp-2" style={{ fontSize: 'var(--text-lg)', fontWeight: '700', color: 'var(--text-primary)', marginBottom: 'var(--space-6)' }}>{ep.name}</div>
                  <div style={{ fontSize: 'var(--text-sm)', color: 'var(--text-tertiary)', fontWeight: '600' }}>Season {ep.season}, Episode {ep.episode}</div>
                </div>
              </div>

              <div style={{ fontSize: 'var(--text-sm)', color: 'var(--text-secondary)', lineHeight: '1.6', marginBottom: 'var(--space-24)' }}>{ep.desc}</div>

              {/* Rating */}
              <div style={{ marginBottom: 'var(--space-20)' }}>
                <div style={{ fontSize: 'var(--text-base)', fontWeight: '600', marginBottom: 'var(--space-16)', color: 'var(--text-primary)' }}>Rate this episode</div>
                <div style={{ display: 'grid', gridTemplateColumns: 'repeat(5, 1fr)', gap: 'var(--space-8)' }}>
                  {[0.5, 1, 1.5, 2, 2.5, 3, 3.5, 4, 4.5, 5].map(r => (
                    <button
                      key={r}
                      onClick={() => handleRate(r)}
                      className="btn"
                      style={{
                        minHeight: '48px',
                        padding: 'var(--space-8)',
                        background: rating >= r ? 'var(--gradient-primary)' : 'var(--bg-elevated)',
                        border: `1px solid ${rating >= r ? 'transparent' : 'var(--border-medium)'}`,
                        color: rating >= r ? 'white' : 'var(--text-secondary)',
                        fontSize: 'var(--text-sm)',
                        fontWeight: '700',
                        boxShadow: rating >= r ? 'var(--shadow-glow)' : 'none'
                      }}
                    >
                      {r}
                    </button>
                  ))}
                </div>
              </div>

              {/* Actions */}
              <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: 'var(--space-12)', marginBottom: 'var(--space-20)' }}>
                <button
                  onClick={() => setWatching(!watching)}
                  className="btn"
                  style={{
                    background: watching ? 'rgba(252,92,101,0.15)' : 'var(--gradient-primary)',
                    border: watching ? '1px solid var(--accent-live)' : 'none',
                    color: watching ? 'var(--accent-live)' : 'white',
                    boxShadow: watching ? 'none' : 'var(--shadow-glow)'
                  }}
                >
                  {watching && <span className="pulse" style={{ width: '8px', height: '8px', borderRadius: 'var(--radius-full)', background: 'var(--accent-live)' }} />}
                  <Icon name="Eye" size={20} />
                  {watching ? 'Watching' : 'Watch'}
                </button>

                <button
                  onClick={() => setShowComposer(true)}
                  className="btn-secondary"
                >
                  <Icon name="Flame" size={20} />
                  Hot Take
                </button>
              </div>

              {/* Discussion */}
              {episodeTakes.length > 0 && (
                <div>
                  <button
                    onClick={() => setShowDiscussion(!showDiscussion)}
                    className="btn-secondary"
                    style={{ width: '100%', justifyContent: 'space-between' }}
                  >
                    <span style={{ display: 'flex', alignItems: 'center', gap: 'var(--space-8)' }}>
                      <Icon name="MessageCircle" size={20} />
                      <span>{episodeTakes.length} Hot Take{episodeTakes.length !== 1 ? 's' : ''}</span>
                    </span>
                    <span style={{ fontSize: 'var(--text-sm)', color: 'var(--accent-primary)' }}>
                      {showDiscussion ? 'Hide' : 'View'}
                    </span>
                  </button>

                  {showDiscussion && (
                    <div style={{ marginTop: 'var(--space-16)', maxHeight: '300px', overflowY: 'auto', display: 'flex', flexDirection: 'column', gap: 'var(--space-12)' }}>
                      {episodeTakes.map(take => {
                        const user = Object.values(USERS).find(u => u.id === take.userId);
                        return (
                          <div key={take.id} className="card" style={{ padding: 'var(--space-16)' }}>
                            <div style={{ display: 'flex', gap: 'var(--space-12)', marginBottom: 'var(--space-12)' }}>
                              <div className="avatar" style={{ width: '32px', height: '32px', fontSize: 'var(--text-sm)' }}>
                                {user.username[0].toUpperCase()}
                              </div>
                              <div style={{ flex: 1 }}>
                                <div style={{ fontSize: 'var(--text-sm)', fontWeight: '600', color: 'var(--text-primary)' }}>{user.username}</div>
                                <div style={{ fontSize: 'var(--text-xs)', color: 'var(--text-tertiary)' }}>{formatTime(take.time)}</div>
                              </div>
                              {take.isLive && <div className="badge-live">LIVE</div>}
                            </div>
                            <div style={{ fontSize: 'var(--text-sm)', color: 'var(--text-primary)', lineHeight: '1.5' }}>{take.content}</div>
                          </div>
                        );
                      })}
                    </div>
                  )}
                </div>
              )}
            </div>
          </div>

          {showComposer && <EpisodeComposer ep={ep} show={show} onClose={() => setShowComposer(false)} onPost={(content) => { onPostTake(content, ep.id); setShowComposer(false); }} />}
        </>
      );
    }

    // ============================================================================
    // EPISODE COMPOSER - COMPLETE
    // ============================================================================
    function EpisodeComposer({ ep, show, onClose, onPost }) {
      const [text, setText] = useState('');
      const max = 280;

      return (
        <>
          <div className="overlay" onClick={onClose} style={{ zIndex: 'calc(var(--z-modal) + 1)' }} />
          <div className="bottom-sheet" style={{ zIndex: 'calc(var(--z-modal) + 2)' }}>
            <div className="sheet-handle" />
            
            <div style={{ padding: '0 var(--space-24) var(--space-40)' }}>
              <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: 'var(--space-20)' }}>
                <h2 style={{ fontSize: 'var(--text-xl)', fontWeight: '700', color: 'var(--text-primary)' }}>Post Hot Take</h2>
                <button onClick={onClose} className="btn-ghost" style={{ padding: 'var(--space-8)' }}>
                  <Icon name="X" size={24} />
                </button>
              </div>

              <div className="card" style={{ padding: 'var(--space-16)', marginBottom: 'var(--space-20)' }}>
                <div style={{ fontSize: 'var(--text-sm)', color: 'var(--accent-primary)', fontWeight: '700', marginBottom: 'var(--space-6)' }}>{show.name}</div>
                <div style={{ fontSize: 'var(--text-base)', fontWeight: '600', color: 'var(--text-primary)' }}>S{ep.season}E{ep.episode}: {ep.name}</div>
              </div>

              <textarea
                value={text}
                onChange={(e) => setText(e.target.value.slice(0, max))}
                placeholder="This episode is fire..."
                autoFocus
                className="input-field"
                style={{ minHeight: '120px', marginBottom: 'var(--space-16)', resize: 'vertical', fontFamily: 'inherit' }}
              />

              <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: 'var(--space-20)' }}>
                <span style={{ fontSize: 'var(--text-sm)', color: text.length > 250 ? 'var(--accent-error)' : 'var(--text-tertiary)', fontWeight: '600' }}>
                  {text.length}/{max}
                </span>
              </div>

              <button
                disabled={!text.trim()}
                onClick={() => text.trim() && onPost(text)}
                className="btn-primary"
                style={{ width: '100%', opacity: text.trim() ? 1 : 0.5, cursor: text.trim() ? 'pointer' : 'not-allowed' }}
              >
                <Icon name="Send" size={20} />
                Post
              </button>
            </div>
          </div>
        </>
      );
    }

    // Time formatter
    function formatTime(timestamp) {
      const diff = Date.now() - timestamp;
      const minutes = Math.floor(diff / 60000);
      if (minutes < 60) return `${minutes}m ago`;
      const hours = Math.floor(minutes / 60);
      if (hours < 24) return `${hours}h ago`;
      return `${Math.floor(hours / 24)}d ago`;
    }

    // ============================================================================
    // HOT TAKES VIEW - COMPLETE WITH LIKES & COMMENTS
    // ============================================================================
    function HotTakesView({ onSelectShow, onCompose, hotTakes, likedTakes, onToggleLike, comments, onPostComment }) {
      const [expandedTake, setExpandedTake] = useState(null);
      const [commentText, setCommentText] = useState('');

      return (
        <div style={{ minHeight: '100vh', background: 'var(--bg-primary)' }}>
          <div style={{ position: 'sticky', top: 0, background: 'rgba(10,14,19,0.95)', backdropFilter: 'blur(20px)', borderBottom: '1px solid var(--border-subtle)', padding: 'var(--space-20) var(--space-24)', zIndex: 'var(--z-sticky)' }}>
            <h1 style={{ fontSize: 'var(--text-3xl)', fontWeight: '800', display: 'flex', alignItems: 'center', gap: 'var(--space-12)', color: 'var(--text-primary)' }}>
              <Icon name="Flame" size={32} style={{ color: 'var(--accent-primary)' }} />
              Hot Takes
            </h1>
          </div>

          <div style={{ padding: 'var(--space-20)' }}>
            {hotTakes.length === 0 ? (
              <div className="card" style={{ padding: 'var(--space-40)', textAlign: 'center' }}>
                <Icon name="Flame" size={48} style={{ color: 'var(--text-tertiary)', margin: '0 auto var(--space-16)' }} />
                <div style={{ fontSize: 'var(--text-lg)', fontWeight: '600', color: 'var(--text-primary)', marginBottom: 'var(--space-8)' }}>No hot takes yet</div>
                <div style={{ fontSize: 'var(--text-sm)', color: 'var(--text-secondary)', marginBottom: 'var(--space-20)' }}>Be the first to share your opinion</div>
                <button onClick={onCompose} className="btn-primary">Post Hot Take</button>
              </div>
            ) : (
              hotTakes.map((take, i) => {
                const user = Object.values(USERS).find(u => u.id === take.userId);
                const episode = EPISODES.find(e => e.id === take.episodeId);
                const show = episode ? SHOWS.find(s => s.id === episode.showId) : null;
                const isLiked = likedTakes.includes(take.id);
                const takeComments = comments.filter(c => c.takeId === take.id);
                const isExpanded = expandedTake === take.id;

                return (
                  <div key={take.id} className="card animate-in" style={{ marginBottom: 'var(--space-16)', animationDelay: `${i * 40}ms` }}>
                    <div style={{ display: 'flex', gap: 'var(--space-12)', marginBottom: 'var(--space-16)' }}>
                      <div className="avatar">{user.username[0].toUpperCase()}</div>
                      <div style={{ flex: 1, minWidth: 0 }}>
                        <div style={{ fontSize: 'var(--text-base)', fontWeight: '600', color: 'var(--text-primary)' }}>{user.username}</div>
                        <div style={{ fontSize: 'var(--text-sm)', color: 'var(--text-tertiary)' }}>{formatTime(take.time)}</div>
                      </div>
                      {take.isLive && <div className="badge-live">LIVE</div>}
                    </div>

                    {show && episode && (
                      <button
                        onClick={() => onSelectShow(show)}
                        className="card-interactive"
                        style={{ width: '100%', padding: 'var(--space-12)', background: 'var(--bg-elevated)', border: '1px solid var(--border-subtle)', borderRadius: 'var(--radius-md)', marginBottom: 'var(--space-16)', textAlign: 'left' }}
                      >
                        <div style={{ display: 'flex', alignItems: 'center', gap: 'var(--space-8)' }}>
                          <span style={{ fontSize: 'var(--text-sm)', color: 'var(--accent-primary)', fontWeight: '700' }}>{show.name}</span>
                          <span style={{ fontSize: 'var(--text-sm)', color: 'var(--text-tertiary)' }}>S{episode.season}E{episode.episode}</span>
                        </div>
                      </button>
                    )}

                    <div style={{ fontSize: 'var(--text-base)', color: 'var(--text-primary)', lineHeight: '1.6', marginBottom: 'var(--space-16)' }}>{take.content}</div>

                    {/* Actions */}
                    <div style={{ display: 'flex', gap: 'var(--space-16)', paddingTop: 'var(--space-16)', borderTop: '1px solid var(--border-subtle)' }}>
                      <button
                        onClick={() => onToggleLike(take.id)}
                        className="btn-ghost"
                        style={{
                          padding: 'var(--space-8)',
                          fontSize: 'var(--text-sm)',
                          color: isLiked ? 'var(--accent-primary)' : 'var(--text-secondary)'
                        }}
                      >
                        <Icon name="Heart" size={16} style={{ fill: isLiked ? 'var(--accent-primary)' : 'none' }} />
                        {(take.reactions.fire || 0) + (isLiked ? 1 : 0)}
                      </button>
                      <button
                        onClick={() => setExpandedTake(isExpanded ? null : take.id)}
                        className="btn-ghost"
                        style={{ padding: 'var(--space-8)', fontSize: 'var(--text-sm)' }}
                      >
                        <Icon name="MessageCircle" size={16} />
                        {takeComments.length}
                      </button>
                      <button className="btn-ghost" style={{ padding: 'var(--space-8)', fontSize: 'var(--text-sm)' }}>
                        <Icon name="Share" size={16} />
                        Share
                      </button>
                    </div>

                    {/* Comments Section */}
                    {isExpanded && (
                      <div style={{ marginTop: 'var(--space-16)', paddingTop: 'var(--space-16)', borderTop: '1px solid var(--border-subtle)' }}>
                        {takeComments.length > 0 && (
                          <div style={{ marginBottom: 'var(--space-16)', display: 'flex', flexDirection: 'column', gap: 'var(--space-12)' }}>
                            {takeComments.map(comment => {
                              const commentUser = Object.values(USERS).find(u => u.id === comment.userId);
                              return (
                                <div key={comment.id} style={{ display: 'flex', gap: 'var(--space-12)' }}>
                                  <div className="avatar" style={{ width: '32px', height: '32px', fontSize: 'var(--text-sm)' }}>
                                    {commentUser.username[0].toUpperCase()}
                                  </div>
                                  <div style={{ flex: 1 }}>
                                    <div style={{ fontSize: 'var(--text-sm)', fontWeight: '600', color: 'var(--text-primary)', marginBottom: 'var(--space-4)' }}>
                                      {commentUser.username}
                                    </div>
                                    <div style={{ fontSize: 'var(--text-sm)', color: 'var(--text-secondary)', lineHeight: '1.5' }}>
                                      {comment.content}
                                    </div>
                                    <div style={{ fontSize: 'var(--text-xs)', color: 'var(--text-tertiary)', marginTop: 'var(--space-4)' }}>
                                      {formatTime(comment.time)}
                                    </div>
                                  </div>
                                </div>
                              );
                            })}
                          </div>
                        )}

                        {/* Comment Input */}
                        <div style={{ display: 'flex', gap: 'var(--space-12)' }}>
                          <input
                            type="text"
                            placeholder="Add a comment..."
                            value={commentText}
                            onChange={(e) => setCommentText(e.target.value)}
                            className="input-field"
                            style={{ flex: 1 }}
                            onKeyPress={(e) => {
                              if (e.key === 'Enter' && commentText.trim()) {
                                onPostComment(take.id, commentText);
                                setCommentText('');
                              }
                            }}
                          />
                          <button
                            onClick={() => {
                              if (commentText.trim()) {
                                onPostComment(take.id, commentText);
                                setCommentText('');
                              }
                            }}
                            disabled={!commentText.trim()}
                            className="btn-primary"
                            style={{ padding: 'var(--space-12)', minHeight: '48px', opacity: commentText.trim() ? 1 : 0.5 }}
                          >
                            <Icon name="Send" size={20} />
                          </button>
                        </div>
                      </div>
                    )}
                  </div>
                );
              })
            )}
          </div>

          <button className="fab" onClick={onCompose}>
            <Icon name="Plus" size={28} />
          </button>
        </div>
      );
    }

    // ============================================================================
    // ACTIVITY VIEW - COMPLETE WITH SOCIAL FEATURES
    // ============================================================================
    function ActivityView({ onSelectShow, following, onToggleFollow }) {
      return (
        <div style={{ minHeight: '100vh', background: 'var(--bg-primary)' }}>
          <div style={{ position: 'sticky', top: 0, background: 'rgba(10,14,19,0.95)', backdropFilter: 'blur(20px)', borderBottom: '1px solid var(--border-subtle)', padding: 'var(--space-20) var(--space-24)', zIndex: 'var(--z-sticky)' }}>
            <h1 style={{ fontSize: 'var(--text-3xl)', fontWeight: '800', color: 'var(--text-primary)' }}>Activity</h1>
            <p style={{ fontSize: 'var(--text-sm)', color: 'var(--text-tertiary)', marginTop: 'var(--space-8)' }}>See who's engaging with your content</p>
          </div>

          <div style={{ padding: 'var(--space-20)' }}>
            {/* Suggested Users */}
            {Object.values(USERS).filter(u => u.id !== '1' && !following.includes(u.id)).length > 0 && (
              <div style={{ marginBottom: 'var(--space-32)' }}>
                <h3 style={{ fontSize: 'var(--text-base)', fontWeight: '700', color: 'var(--text-primary)', marginBottom: 'var(--space-16)' }}>Suggested For You</h3>
                {Object.values(USERS).filter(u => u.id !== '1' && !following.includes(u.id)).map((user, i) => (
                  <div key={user.id} className="card card-interactive animate-in" style={{ marginBottom: 'var(--space-12)', animationDelay: `${i * 40}ms` }}>
                    <div style={{ display: 'flex', alignItems: 'center', gap: 'var(--space-16)' }}>
                      <div className="avatar" style={{ width: '48px', height: '48px', fontSize: 'var(--text-lg)' }}>
                        {user.username[0].toUpperCase()}
                      </div>
                      <div style={{ flex: 1 }}>
                        <div style={{ fontSize: 'var(--text-base)', fontWeight: '700', color: 'var(--text-primary)', marginBottom: 'var(--space-4)' }}>
                          {user.name}
                        </div>
                        <div style={{ fontSize: 'var(--text-sm)', color: 'var(--text-tertiary)' }}>
                          @{user.username}
                        </div>
                      </div>
                      <button
                        onClick={() => onToggleFollow(user.id)}
                        className="btn-primary"
                        style={{ padding: 'var(--space-8) var(--space-16)' }}
                      >
                        <Icon name="UserPlus" size={16} />
                        Follow
                      </button>
                    </div>
                  </div>
                ))}
              </div>
            )}

            {/* Activity Feed */}
            <h3 style={{ fontSize: 'var(--text-base)', fontWeight: '700', color: 'var(--text-primary)', marginBottom: 'var(--space-16)' }}>Recent Activity</h3>
            {YOUR_ACTIVITY.length === 0 ? (
              <div className="card" style={{ padding: 'var(--space-40)', textAlign: 'center' }}>
                <Icon name="Bell" size={48} style={{ color: 'var(--text-tertiary)', margin: '0 auto var(--space-16)' }} />
                <h3 style={{ fontSize: 'var(--text-xl)', fontWeight: '700', marginBottom: 'var(--space-12)', color: 'var(--text-primary)' }}>No activity yet</h3>
                <p style={{ fontSize: 'var(--text-base)', color: 'var(--text-secondary)', lineHeight: '1.6' }}>
                  When people like or comment on your posts, you'll see it here
                </p>
              </div>
            ) : (
              YOUR_ACTIVITY.map((activity, i) => {
                const user = Object.values(USERS).find(u => u.id === activity.userId);
                const episode = EPISODES.find(e => e.id === activity.episodeId);
                const show = episode ? SHOWS.find(s => s.id === episode.showId) : null;
                const isFollowing = following.includes(activity.userId);

                return (
                  <div key={activity.id} className="card animate-in" onClick={() => show && onSelectShow(show)} style={{ marginBottom: 'var(--space-12)', animationDelay: `${i * 40}ms`, cursor: show ? 'pointer' : 'default' }}>
                    <div style={{ display: 'flex', gap: 'var(--space-12)', alignItems: 'center' }}>
                      <div className="avatar" style={{ width: '48px', height: '48px', fontSize: 'var(--text-lg)' }}>
                        {user.username[0].toUpperCase()}
                      </div>
                      <div style={{ flex: 1, minWidth: 0 }}>
                        <div style={{ fontSize: 'var(--text-base)', color: 'var(--text-primary)', marginBottom: 'var(--space-4)' }}>
                          <span style={{ fontWeight: '700' }}>{user.username}</span>{' '}
                          <span style={{ color: 'var(--text-secondary)' }}>{activity.content}</span>
                        </div>
                        {show && episode && (
                          <div style={{ fontSize: 'var(--text-sm)', color: 'var(--text-tertiary)' }}>
                            {show.name} â€¢ S{episode.season}E{episode.episode}
                          </div>
                        )}
                      </div>
                      <div style={{ display: 'flex', alignItems: 'center', gap: 'var(--space-12)' }}>
                        <div style={{ flexShrink: 0, fontSize: 'var(--text-xs)', color: 'var(--text-tertiary)', fontWeight: '600' }}>
                          {formatTime(activity.time)}
                        </div>
                        {activity.type === 'follow' && !isFollowing && (
                          <button
                            onClick={(e) => { e.stopPropagation(); onToggleFollow(activity.userId); }}
                            className="btn-primary"
                            style={{ padding: 'var(--space-6) var(--space-12)', minHeight: '32px', fontSize: 'var(--text-xs)' }}
                          >
                            <Icon name="UserPlus" size={14} />
                            Follow Back
                          </button>
                        )}
                      </div>
                    </div>
                  </div>
                );
              })
            )}
          </div>
        </div>
      );
    }

    // ============================================================================
    // LISTS VIEW - COMPLETE
    // ============================================================================
    function ListsView({ onSelectShow, lists, setLists }) {
      const [showCreate, setShowCreate] = useState(false);

      return (
        <div style={{ minHeight: '100vh', background: 'var(--bg-primary)' }}>
          <div style={{ position: 'sticky', top: 0, background: 'rgba(10,14,19,0.95)', backdropFilter: 'blur(20px)', borderBottom: '1px solid var(--border-subtle)', padding: 'var(--space-20) var(--space-24)', zIndex: 'var(--z-sticky)' }}>
            <h1 style={{ fontSize: 'var(--text-3xl)', fontWeight: '800', color: 'var(--text-primary)' }}>Lists</h1>
            <p style={{ fontSize: 'var(--text-sm)', color: 'var(--text-tertiary)', marginTop: 'var(--space-8)' }}>Curate your favorite episodes</p>
          </div>

          <div style={{ padding: 'var(--space-20)' }}>
            {lists.length === 0 ? (
              <div className="card" style={{ padding: 'var(--space-40)', textAlign: 'center' }}>
                <Icon name="List" size={48} style={{ color: 'var(--text-tertiary)', margin: '0 auto var(--space-16)' }} />
                <h3 style={{ fontSize: 'var(--text-xl)', fontWeight: '700', marginBottom: 'var(--space-12)', color: 'var(--text-primary)' }}>Create your first list</h3>
                <p style={{ fontSize: 'var(--text-base)', color: 'var(--text-secondary)', lineHeight: '1.6', marginBottom: 'var(--space-20)' }}>
                  Organize episodes into collections: Best Finales, Comfort Episodes, Must-Watch TV
                </p>
                <button onClick={() => setShowCreate(true)} className="btn-primary">
                  <Icon name="Plus" size={20} />
                  Create List
                </button>
              </div>
            ) : (
              <>
                {lists.map((list, i) => (
                  <div key={list.id} className="card card-interactive animate-in" style={{ marginBottom: 'var(--space-16)', animationDelay: `${i * 40}ms` }}>
                    <h3 style={{ fontSize: 'var(--text-lg)', fontWeight: '700', color: 'var(--text-primary)', marginBottom: 'var(--space-8)' }}>{list.name}</h3>
                    <p style={{ fontSize: 'var(--text-sm)', color: 'var(--text-secondary)', lineHeight: '1.5', marginBottom: 'var(--space-12)' }}>{list.description}</p>
                    <div style={{ display: 'flex', alignItems: 'center', gap: 'var(--space-12)', fontSize: 'var(--text-sm)', color: 'var(--text-tertiary)' }}>
                      <span>{list.episodes.length} episodes</span>
                      <span>â€¢</span>
                      <span>{list.isPublic ? 'Public' : 'Private'}</span>
                    </div>
                  </div>
                ))}
                <button onClick={() => setShowCreate(true)} className="btn-secondary" style={{ width: '100%' }}>
                  <Icon name="Plus" size={20} />
                  Create New List
                </button>
              </>
            )}
          </div>

          {showCreate && <CreateListModal onClose={() => setShowCreate(false)} onCreate={(list) => { setLists([...lists, { id: Date.now(), ...list, episodes: [] }]); setShowCreate(false); }} />}
        </div>
      );
    }

    function CreateListModal({ onClose, onCreate }) {
      const [name, setName] = useState('');
      const [description, setDescription] = useState('');
      const [isPublic, setIsPublic] = useState(true);

      return (
        <>
          <div className="overlay" onClick={onClose} />
          <div className="bottom-sheet">
            <div className="sheet-handle" />
            
            <div style={{ padding: '0 var(--space-24) var(--space-40)' }}>
              <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: 'var(--space-24)' }}>
                <h2 style={{ fontSize: 'var(--text-xl)', fontWeight: '700', color: 'var(--text-primary)' }}>Create List</h2>
                <button onClick={onClose} className="btn-ghost" style={{ padding: 'var(--space-8)' }}>
                  <Icon name="X" size={24} />
                </button>
              </div>

              <div style={{ marginBottom: 'var(--space-20)' }}>
                <label style={{ display: 'block', fontSize: 'var(--text-sm)', fontWeight: '600', color: 'var(--text-primary)', marginBottom: 'var(--space-8)' }}>
                  List Name
                </label>
                <input
                  type="text"
                  value={name}
                  onChange={(e) => setName(e.target.value)}
                  placeholder="Best Finales"
                  className="input-field"
                  autoFocus
                />
              </div>

              <div style={{ marginBottom: 'var(--space-20)' }}>
                <label style={{ display: 'block', fontSize: 'var(--text-sm)', fontWeight: '600', color: 'var(--text-primary)', marginBottom: 'var(--space-8)' }}>
                  Description
                </label>
                <textarea
                  value={description}
                  onChange={(e) => setDescription(e.target.value)}
                  placeholder="Episodes that stick with you long after..."
                  className="input-field"
                  style={{ minHeight: '80px', resize: 'vertical' }}
                />
              </div>

              <div style={{ marginBottom: 'var(--space-24)' }}>
                <label style={{ display: 'flex', alignItems: 'center', gap: 'var(--space-12)', cursor: 'pointer' }}>
                  <input
                    type="checkbox"
                    checked={isPublic}
                    onChange={(e) => setIsPublic(e.target.checked)}
                    style={{ width: '20px', height: '20px', cursor: 'pointer' }}
                  />
                  <span style={{ fontSize: 'var(--text-sm)', fontWeight: '600', color: 'var(--text-primary)' }}>
                    Make this list public
                  </span>
                </label>
              </div>

              <button
                disabled={!name.trim()}
                onClick={() => name.trim() && onCreate({ name, description, isPublic })}
                className="btn-primary"
                style={{ width: '100%', opacity: name.trim() ? 1 : 0.5, cursor: name.trim() ? 'pointer' : 'not-allowed' }}
              >
                Create List
              </button>
            </div>
          </div>
        </>
      );
    }

    // ============================================================================
    // PROFILE VIEW - COMPLETE WITH FOLLOWING/FOLLOWERS
    // ============================================================================
    function ProfileView({ ratings, hotTakes, following, onToggleFollow }) {
      const [showView, setShowView] = useState('stats'); // 'stats', 'following', 'followers'
      
      const user = USERS.current;
      const ratedCount = Object.keys(ratings).length;
      const takesCount = hotTakes.length;
      const avgRating = ratedCount > 0 ? (Object.values(ratings).reduce((a, b) => a + b, 0) / ratedCount).toFixed(1) : '0.0';
      
      // Mock followers
      const followers = ['2', '4'];

      return (
        <div style={{ minHeight: '100vh', background: 'var(--bg-primary)', padding: 'var(--space-24)' }}>
          <div className="glass-card" style={{ padding: 'var(--space-24)', marginBottom: 'var(--space-24)' }}>
            <div style={{ display: 'flex', gap: 'var(--space-20)', marginBottom: 'var(--space-24)' }}>
              <div className="avatar-lg">{user.username[0].toUpperCase()}</div>
              <div style={{ flex: 1 }}>
                <h2 style={{ fontSize: 'var(--text-2xl)', fontWeight: '700', marginBottom: 'var(--space-8)', color: 'var(--text-primary)' }}>{user.name}</h2>
                <div style={{ fontSize: 'var(--text-sm)', color: 'var(--text-tertiary)', marginBottom: 'var(--space-12)' }}>@{user.username}</div>
                <div style={{ fontSize: 'var(--text-base)', color: 'var(--text-secondary)', lineHeight: '1.6' }}>
                  TV enthusiast â€¢ Hot takes only
                </div>
              </div>
            </div>

            <div style={{ display: 'grid', gridTemplateColumns: 'repeat(3, 1fr)', gap: 'var(--space-24)', paddingTop: 'var(--space-24)', borderTop: '1px solid var(--border-subtle)' }}>
              <div style={{ textAlign: 'center' }}>
                <div className="text-gradient" style={{ fontSize: 'var(--text-3xl)', fontWeight: '800', marginBottom: 'var(--space-8)' }}>{ratedCount}</div>
                <div style={{ fontSize: 'var(--text-sm)', color: 'var(--text-tertiary)', fontWeight: '600' }}>Rated</div>
              </div>
              <button
                onClick={() => setShowView('following')}
                style={{ textAlign: 'center', background: 'none', border: 'none', cursor: 'pointer' }}
              >
                <div className="text-gradient" style={{ fontSize: 'var(--text-3xl)', fontWeight: '800', marginBottom: 'var(--space-8)' }}>{following.length}</div>
                <div style={{ fontSize: 'var(--text-sm)', color: 'var(--text-tertiary)', fontWeight: '600' }}>Following</div>
              </button>
              <button
                onClick={() => setShowView('followers')}
                style={{ textAlign: 'center', background: 'none', border: 'none', cursor: 'pointer' }}
              >
                <div className="text-gradient" style={{ fontSize: 'var(--text-3xl)', fontWeight: '800', marginBottom: 'var(--space-8)' }}>{followers.length}</div>
                <div style={{ fontSize: 'var(--text-sm)', color: 'var(--text-tertiary)', fontWeight: '600' }}>Followers</div>
              </button>
            </div>
          </div>

          {/* View Switcher */}
          {showView === 'stats' ? (
            <div className="glass-card" style={{ padding: 'var(--space-32)', textAlign: 'center' }}>
              <Icon name="Award" size={48} style={{ color: 'var(--accent-primary)', margin: '0 auto var(--space-16)' }} />
              <h3 style={{ fontSize: 'var(--text-xl)', fontWeight: '700', marginBottom: 'var(--space-12)', color: 'var(--text-primary)' }}>Complete Version</h3>
              <p style={{ fontSize: 'var(--text-base)', color: 'var(--text-secondary)', lineHeight: '1.6', marginBottom: 'var(--space-20)' }}>
                Full Letterboxd feature parity. Track episodes, post hot takes, create lists, follow friends, view stats.
              </p>
              <div style={{ display: 'flex', gap: 'var(--space-12)', justifyContent: 'center' }}>
                <button onClick={() => setShowView('stats')} className="btn-secondary">
                  <Icon name="BarChart" size={20} />
                  View Stats
                </button>
              </div>
            </div>
          ) : showView === 'following' ? (
            <div>
              <div style={{ display: 'flex', alignItems: 'center', justifyContent: 'space-between', marginBottom: 'var(--space-20)' }}>
                <h3 style={{ fontSize: 'var(--text-xl)', fontWeight: '700', color: 'var(--text-primary)' }}>Following</h3>
                <button onClick={() => setShowView('stats')} className="btn-ghost" style={{ padding: 'var(--space-8)' }}>
                  <Icon name="X" size={20} />
                </button>
              </div>
              {following.map((userId, i) => {
                const followedUser = Object.values(USERS).find(u => u.id === userId);
                return (
                  <div key={userId} className="card animate-in" style={{ marginBottom: 'var(--space-12)', animationDelay: `${i * 40}ms` }}>
                    <div style={{ display: 'flex', alignItems: 'center', gap: 'var(--space-16)' }}>
                      <div className="avatar" style={{ width: '48px', height: '48px', fontSize: 'var(--text-lg)' }}>
                        {followedUser.username[0].toUpperCase()}
                      </div>
                      <div style={{ flex: 1 }}>
                        <div style={{ fontSize: 'var(--text-base)', fontWeight: '700', color: 'var(--text-primary)', marginBottom: 'var(--space-4)' }}>
                          {followedUser.name}
                        </div>
                        <div style={{ fontSize: 'var(--text-sm)', color: 'var(--text-tertiary)' }}>
                          @{followedUser.username}
                        </div>
                      </div>
                      <button
                        onClick={() => onToggleFollow(userId)}
                        className="btn-secondary"
                        style={{ padding: 'var(--space-8) var(--space-16)' }}
                      >
                        <Icon name="UserMinus" size={16} />
                        Unfollow
                      </button>
                    </div>
                  </div>
                );
              })}
            </div>
          ) : (
            <div>
              <div style={{ display: 'flex', alignItems: 'center', justifyContent: 'space-between', marginBottom: 'var(--space-20)' }}>
                <h3 style={{ fontSize: 'var(--text-xl)', fontWeight: '700', color: 'var(--text-primary)' }}>Followers</h3>
                <button onClick={() => setShowView('stats')} className="btn-ghost" style={{ padding: 'var(--space-8)' }}>
                  <Icon name="X" size={20} />
                </button>
              </div>
              {followers.map((userId, i) => {
                const followerUser = Object.values(USERS).find(u => u.id === userId);
                const isFollowing = following.includes(userId);
                return (
                  <div key={userId} className="card animate-in" style={{ marginBottom: 'var(--space-12)', animationDelay: `${i * 40}ms` }}>
                    <div style={{ display: 'flex', alignItems: 'center', gap: 'var(--space-16)' }}>
                      <div className="avatar" style={{ width: '48px', height: '48px', fontSize: 'var(--text-lg)' }}>
                        {followerUser.username[0].toUpperCase()}
                      </div>
                      <div style={{ flex: 1 }}>
                        <div style={{ fontSize: 'var(--text-base)', fontWeight: '700', color: 'var(--text-primary)', marginBottom: 'var(--space-4)' }}>
                          {followerUser.name}
                        </div>
                        <div style={{ fontSize: 'var(--text-sm)', color: 'var(--text-tertiary)' }}>
                          @{followerUser.username}
                        </div>
                      </div>
                      <button
                        onClick={() => onToggleFollow(userId)}
                        className={isFollowing ? 'btn-secondary' : 'btn-primary'}
                        style={{ padding: 'var(--space-8) var(--space-16)' }}
                      >
                        <Icon name={isFollowing ? 'UserMinus' : 'UserPlus'} size={16} />
                        {isFollowing ? 'Unfollow' : 'Follow'}
                      </button>
                    </div>
                  </div>
                );
              })}
            </div>
          )}
        </div>
      );
    }

    // ============================================================================
    // GENERAL COMPOSER - COMPLETE
    // ============================================================================
    function Composer({ onClose, onPost }) {
      const [text, setText] = useState('');
      const max = 280;

      return (
        <>
          <div className="overlay" onClick={onClose} />
          <div className="bottom-sheet" style={{ maxHeight: '80vh' }}>
            <div className="sheet-handle" />
            
            <div style={{ padding: '0 var(--space-24) var(--space-40)' }}>
              <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: 'var(--space-24)' }}>
                <h2 style={{ fontSize: 'var(--text-xl)', fontWeight: '700', color: 'var(--text-primary)' }}>Post Hot Take</h2>
                <button onClick={onClose} className="btn-ghost" style={{ padding: 'var(--space-8)' }}>
                  <Icon name="X" size={24} />
                </button>
              </div>

              <textarea
                value={text}
                onChange={(e) => setText(e.target.value.slice(0, max))}
                placeholder="What's your hot take?"
                autoFocus
                className="input-field"
                style={{ minHeight: '140px', marginBottom: 'var(--space-16)', resize: 'vertical', fontFamily: 'inherit' }}
              />

              <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: 'var(--space-24)' }}>
                <span style={{ fontSize: 'var(--text-sm)', color: text.length > 250 ? 'var(--accent-error)' : 'var(--text-tertiary)', fontWeight: '600' }}>
                  {text.length}/{max}
                </span>
              </div>

              <button
                disabled={!text.trim()}
                onClick={() => text.trim() && onPost(text)}
                className="btn-primary"
                style={{ width: '100%', opacity: text.trim() ? 1 : 0.5, cursor: text.trim() ? 'pointer' : 'not-allowed' }}
              >
                <Icon name="Send" size={20} />
                Post
              </button>
            </div>
          </div>
        </>
      );
    }

    // ============================================================================
    // WATCHLIST VIEW - COMPLETE
    // ============================================================================
    function WatchlistView({ onSelectShow, watchlist, onToggleWatchlist }) {
      const watchlistEpisodes = EPISODES.filter(ep => watchlist.includes(ep.id));
      
      return (
        <div style={{ minHeight: '100vh', background: 'var(--bg-primary)', padding: 'var(--space-24)' }}>
          <div style={{ marginBottom: 'var(--space-32)' }}>
            <h1 style={{ fontSize: 'var(--text-3xl)', fontWeight: '800', color: 'var(--text-primary)', marginBottom: 'var(--space-8)' }}>Watchlist</h1>
            <p style={{ fontSize: 'var(--text-sm)', color: 'var(--text-tertiary)' }}>Episodes you want to watch</p>
          </div>

          {watchlistEpisodes.length === 0 ? (
            <div className="card" style={{ padding: 'var(--space-40)', textAlign: 'center' }}>
              <Icon name="Bookmark" size={48} style={{ color: 'var(--text-tertiary)', margin: '0 auto var(--space-16)' }} />
              <h3 style={{ fontSize: 'var(--text-xl)', fontWeight: '700', marginBottom: 'var(--space-12)', color: 'var(--text-primary)' }}>Your watchlist is empty</h3>
              <p style={{ fontSize: 'var(--text-base)', color: 'var(--text-secondary)', lineHeight: '1.6' }}>
                Add episodes you want to watch later
              </p>
            </div>
          ) : (
            watchlistEpisodes.map((ep, i) => {
              const show = SHOWS.find(s => s.id === ep.showId);
              return (
                <div key={ep.id} className="card card-interactive animate-in" onClick={() => show && onSelectShow(show)} style={{ marginBottom: 'var(--space-16)', animationDelay: `${i * 40}ms` }}>
                  <div style={{ display: 'flex', gap: 'var(--space-16)', marginBottom: 'var(--space-12)' }}>
                    <img src={ep.image} alt={ep.name} style={{ width: '120px', height: '68px', borderRadius: 'var(--radius-md)', objectFit: 'cover', boxShadow: 'var(--shadow-sm)' }} />
                    <div style={{ flex: 1 }}>
                      <div style={{ fontSize: 'var(--text-sm)', color: 'var(--accent-primary)', fontWeight: '700', marginBottom: 'var(--space-6)' }}>{show?.name}</div>
                      <div style={{ fontSize: 'var(--text-base)', fontWeight: '600', color: 'var(--text-primary)', marginBottom: 'var(--space-6)' }}>{ep.name}</div>
                      <div style={{ fontSize: 'var(--text-sm)', color: 'var(--text-tertiary)' }}>S{ep.season}E{ep.episode}</div>
                    </div>
                  </div>
                  <button
                    onClick={(e) => { e.stopPropagation(); onToggleWatchlist(ep.id); }}
                    className="btn-ghost"
                    style={{ width: '100%' }}
                  >
                    <Icon name="X" size={16} />
                    Remove from Watchlist
                  </button>
                </div>
              );
            })
          )}
        </div>
      );
    }

    // ============================================================================
    // DIARY VIEW - COMPLETE
    // ============================================================================
    function DiaryView({ onSelectShow, diary, ratings }) {
      const diaryEntries = Object.entries(diary).map(([episodeId, data]) => ({
        episode: EPISODES.find(ep => ep.id === parseInt(episodeId)),
        ...data,
        episodeId: parseInt(episodeId)
      })).sort((a, b) => new Date(b.date) - new Date(a.date));

      return (
        <div style={{ minHeight: '100vh', background: 'var(--bg-primary)', padding: 'var(--space-24)' }}>
          <div style={{ marginBottom: 'var(--space-32)' }}>
            <h1 style={{ fontSize: 'var(--text-3xl)', fontWeight: '800', color: 'var(--text-primary)', marginBottom: 'var(--space-8)' }}>Diary</h1>
            <p style={{ fontSize: 'var(--text-sm)', color: 'var(--text-tertiary)' }}>Your watch history</p>
          </div>

          {diaryEntries.length === 0 ? (
            <div className="card" style={{ padding: 'var(--space-40)', textAlign: 'center' }}>
              <Icon name="Calendar" size={48} style={{ color: 'var(--text-tertiary)', margin: '0 auto var(--space-16)' }} />
              <h3 style={{ fontSize: 'var(--text-xl)', fontWeight: '700', marginBottom: 'var(--space-12)', color: 'var(--text-primary)' }}>No entries yet</h3>
              <p style={{ fontSize: 'var(--text-base)', color: 'var(--text-secondary)', lineHeight: '1.6' }}>
                Mark episodes as watched to build your viewing history
              </p>
            </div>
          ) : (
            diaryEntries.map((entry, i) => {
              const show = SHOWS.find(s => s.id === entry.episode?.showId);
              const userRating = ratings[entry.episodeId];
              
              return (
                <div key={i} className="card card-interactive animate-in" onClick={() => show && onSelectShow(show)} style={{ marginBottom: 'var(--space-16)', animationDelay: `${i * 40}ms` }}>
                  <div style={{ display: 'flex', gap: 'var(--space-16)' }}>
                    <img src={entry.episode?.image} alt={entry.episode?.name} style={{ width: '120px', height: '68px', borderRadius: 'var(--radius-md)', objectFit: 'cover', boxShadow: 'var(--shadow-sm)' }} />
                    <div style={{ flex: 1 }}>
                      <div style={{ fontSize: 'var(--text-sm)', color: 'var(--accent-primary)', fontWeight: '700', marginBottom: 'var(--space-6)' }}>{show?.name}</div>
                      <div style={{ fontSize: 'var(--text-base)', fontWeight: '600', color: 'var(--text-primary)', marginBottom: 'var(--space-8)' }}>{entry.episode?.name}</div>
                      <div style={{ display: 'flex', alignItems: 'center', gap: 'var(--space-16)', fontSize: 'var(--text-sm)', color: 'var(--text-tertiary)' }}>
                        <span>S{entry.episode?.season}E{entry.episode?.episode}</span>
                        <span>â€¢</span>
                        <span>{new Date(entry.date).toLocaleDateString()}</span>
                        {entry.service && (
                          <>
                            <span>â€¢</span>
                            <div style={{ display: 'flex', alignItems: 'center', gap: 'var(--space-6)' }}>
                              <Icon name="Film" size={14} />
                              <span>{entry.service}</span>
                            </div>
                          </>
                        )}
                        {entry.rewatch && (
                          <>
                            <span>â€¢</span>
                            <div style={{ display: 'flex', alignItems: 'center', gap: 'var(--space-6)' }}>
                              <Icon name="Clock" size={14} />
                              <span>Rewatch</span>
                            </div>
                          </>
                        )}
                        {userRating && (
                          <>
                            <span>â€¢</span>
                            <div style={{ display: 'flex', alignItems: 'center', gap: 'var(--space-6)', color: 'var(--accent-primary)' }}>
                              <Icon name="Star" size={14} />
                              <span style={{ fontWeight: '700' }}>{userRating}</span>
                            </div>
                          </>
                        )}
                      </div>
                    </div>
                  </div>
                </div>
              );
            })
          )}
        </div>
      );
    }

    // ============================================================================
    // STATS VIEW - COMPLETE
    // ============================================================================
    function StatsView({ ratings, hotTakes, diary }) {
      const ratedCount = Object.keys(ratings).length;
      const avgRating = ratedCount > 0 ? (Object.values(ratings).reduce((a, b) => a + b, 0) / ratedCount).toFixed(1) : '0.0';
      const watchedCount = Object.keys(diary).length;
      const takesCount = hotTakes.length;

      // Genre breakdown
      const genreCount = {};
      Object.keys(ratings).forEach(epId => {
        const ep = EPISODES.find(e => e.id === parseInt(epId));
        if (ep) {
          const show = SHOWS.find(s => s.id === ep.showId);
          if (show) {
            genreCount[show.genre] = (genreCount[show.genre] || 0) + 1;
          }
        }
      });

      // Rating distribution
      const ratingDist = {};
      Object.values(ratings).forEach(r => {
        ratingDist[r] = (ratingDist[r] || 0) + 1;
      });

      return (
        <div style={{ minHeight: '100vh', background: 'var(--bg-primary)', padding: 'var(--space-24)' }}>
          <div style={{ marginBottom: 'var(--space-32)' }}>
            <h1 style={{ fontSize: 'var(--text-3xl)', fontWeight: '800', color: 'var(--text-primary)', marginBottom: 'var(--space-8)' }}>Stats</h1>
            <p style={{ fontSize: 'var(--text-sm)', color: 'var(--text-tertiary)' }}>Your viewing statistics</p>
          </div>

          {/* Overview */}
          <div className="glass-card" style={{ padding: 'var(--space-24)', marginBottom: 'var(--space-24)' }}>
            <h3 style={{ fontSize: 'var(--text-lg)', fontWeight: '700', marginBottom: 'var(--space-20)', color: 'var(--text-primary)' }}>Overview</h3>
            <div style={{ display: 'grid', gridTemplateColumns: 'repeat(2, 1fr)', gap: 'var(--space-24)' }}>
              <div style={{ textAlign: 'center' }}>
                <div className="text-gradient" style={{ fontSize: 'var(--text-4xl)', fontWeight: '800', marginBottom: 'var(--space-8)' }}>{watchedCount}</div>
                <div style={{ fontSize: 'var(--text-sm)', color: 'var(--text-tertiary)', fontWeight: '600' }}>Episodes Watched</div>
              </div>
              <div style={{ textAlign: 'center' }}>
                <div className="text-gradient" style={{ fontSize: 'var(--text-4xl)', fontWeight: '800', marginBottom: 'var(--space-8)' }}>{ratedCount}</div>
                <div style={{ fontSize: 'var(--text-sm)', color: 'var(--text-tertiary)', fontWeight: '600' }}>Episodes Rated</div>
              </div>
              <div style={{ textAlign: 'center' }}>
                <div className="text-gradient" style={{ fontSize: 'var(--text-4xl)', fontWeight: '800', marginBottom: 'var(--space-8)' }}>{avgRating}</div>
                <div style={{ fontSize: 'var(--text-sm)', color: 'var(--text-tertiary)', fontWeight: '600' }}>Avg Rating</div>
              </div>
              <div style={{ textAlign: 'center' }}>
                <div className="text-gradient" style={{ fontSize: 'var(--text-4xl)', fontWeight: '800', marginBottom: 'var(--space-8)' }}>{takesCount}</div>
                <div style={{ fontSize: 'var(--text-sm)', color: 'var(--text-tertiary)', fontWeight: '600' }}>Hot Takes</div>
              </div>
            </div>
          </div>

          {/* Genre Breakdown */}
          {Object.keys(genreCount).length > 0 && (
            <div className="glass-card" style={{ padding: 'var(--space-24)', marginBottom: 'var(--space-24)' }}>
              <h3 style={{ fontSize: 'var(--text-lg)', fontWeight: '700', marginBottom: 'var(--space-20)', color: 'var(--text-primary)' }}>By Genre</h3>
              {Object.entries(genreCount).sort((a, b) => b[1] - a[1]).map(([genre, count]) => (
                <div key={genre} style={{ marginBottom: 'var(--space-16)' }}>
                  <div style={{ display: 'flex', justifyContent: 'space-between', marginBottom: 'var(--space-8)', fontSize: 'var(--text-sm)' }}>
                    <span style={{ color: 'var(--text-primary)', fontWeight: '600' }}>{genre}</span>
                    <span style={{ color: 'var(--accent-primary)', fontWeight: '700' }}>{count} episodes</span>
                  </div>
                  <div style={{ height: '8px', background: 'var(--bg-elevated)', borderRadius: 'var(--radius-full)', overflow: 'hidden' }}>
                    <div style={{ height: '100%', width: `${(count / ratedCount) * 100}%`, background: 'var(--gradient-primary)', transition: 'width 0.5s ease-out' }} />
                  </div>
                </div>
              ))}
            </div>
          )}

          {/* Rating Distribution */}
          {Object.keys(ratingDist).length > 0 && (
            <div className="glass-card" style={{ padding: 'var(--space-24)' }}>
              <h3 style={{ fontSize: 'var(--text-lg)', fontWeight: '700', marginBottom: 'var(--space-20)', color: 'var(--text-primary)' }}>Rating Distribution</h3>
              <div style={{ display: 'flex', alignItems: 'flex-end', justifyContent: 'space-between', height: '200px', gap: 'var(--space-8)' }}>
                {[0.5, 1, 1.5, 2, 2.5, 3, 3.5, 4, 4.5, 5].map(r => {
                  const count = ratingDist[r] || 0;
                  const maxCount = Math.max(...Object.values(ratingDist));
                  const height = maxCount > 0 ? (count / maxCount) * 100 : 0;
                  
                  return (
                    <div key={r} style={{ flex: 1, display: 'flex', flexDirection: 'column', alignItems: 'center', gap: 'var(--space-8)' }}>
                      <div style={{ fontSize: 'var(--text-xs)', color: 'var(--text-tertiary)', fontWeight: '700' }}>{count || ''}</div>
                      <div
                        style={{
                          width: '100%',
                          height: `${height}%`,
                          background: 'var(--gradient-primary)',
                          borderRadius: 'var(--radius-sm)',
                          transition: 'height 0.5s ease-out',
                          minHeight: count > 0 ? '8px' : '0'
                        }}
                      />
                      <div style={{ fontSize: 'var(--text-xs)', color: 'var(--text-secondary)', fontWeight: '600' }}>{r}</div>
                    </div>
                  );
                })}
              </div>
            </div>
          )}

          {ratedCount === 0 && (
            <div className="card" style={{ padding: 'var(--space-40)', textAlign: 'center' }}>
              <Icon name="BarChart" size={48} style={{ color: 'var(--text-tertiary)', margin: '0 auto var(--space-16)' }} />
              <h3 style={{ fontSize: 'var(--text-xl)', fontWeight: '700', marginBottom: 'var(--space-12)', color: 'var(--text-primary)' }}>No stats yet</h3>
              <p style={{ fontSize: 'var(--text-base)', color: 'var(--text-secondary)', lineHeight: '1.6' }}>
                Rate some episodes to see your statistics
              </p>
            </div>
          )}
        </div>
      );
    }

    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(<App />);
  </script>
</body>
</html>