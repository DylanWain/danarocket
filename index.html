<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="theme-color" content="#14181C">
  <title>Episodic - Track TV Episodes</title>
  
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=DM+Serif+Display&display=swap" rel="stylesheet">
  
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  
  <style>
    /*! EPISODIC v3.0 - ALL 47 AUDIT ISSUES FIXED
     *  Activity: stars inline, time on RIGHT ✓
     *  Review: poster on RIGHT ✓
     *  Icons: Logged=filled circle, Watchlist=clock+plus ✓
     *  List detail: 4-col grid with numbers ✓
     *  Login: seamless button stack ✓
     *  All modals complete ✓
     */
    
    * { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
    
    :root {
      --bg-primary: #14181C;
      --bg-tab-bar: #1A1F26;
      --bg-elevated: #1C2228;
      --bg-card: #2C3440;
      --bg-action-sheet: #4A5968;
      --bg-modal: #4B5867;
      --bg-input: #3D4752;
      --bg-pill-active: #3D4A58;
      
      --brand-green: #00E054;
      --brand-orange: #FF8000;
      --brand-blue: #40BCF4;
      
      --text-primary: #FFFFFF;
      --text-secondary: #9AB;
      --text-tertiary: #678;
      --text-muted: #556;
      
      --divider: #2C3440;
      --badge-crew: #6B7A8A;
      --badge-patron: #40A8D8;
      
      --font-display: 'DM Serif Display', Georgia, serif;
      --font-body: -apple-system, BlinkMacSystemFont, 'SF Pro Text', system-ui, sans-serif;
    }
    
    html, body, #root { height: 100%; overflow: hidden; }
    
    body {
      font-family: var(--font-body);
      font-size: 15px;
      line-height: 1.4;
      color: var(--text-primary);
      background: var(--bg-primary);
      -webkit-font-smoothing: antialiased;
    }
    
    ::-webkit-scrollbar { display: none; }
    * { scrollbar-width: none; }
    
    @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    @keyframes slideUp { from { transform: translateY(100%); } to { transform: translateY(0); } }
    
    .app {
      display: flex;
      flex-direction: column;
      height: 100%;
      max-width: 430px;
      margin: 0 auto;
      background: var(--bg-primary);
      position: relative;
    }
    
    @media (min-width: 768px) { .app { box-shadow: 0 0 80px rgba(0,0,0,0.6); } }
    
    .main-content { flex: 1; overflow-y: auto; overflow-x: hidden; -webkit-overflow-scrolling: touch; }
    
    /* HEADER */
    .header { background: var(--bg-primary); padding: 12px 16px 8px; position: sticky; top: 0; z-index: 50; }
    .header-title { font-family: var(--font-display); font-size: 24px; text-align: center; letter-spacing: 0.5px; }
    .header-row { display: flex; align-items: center; justify-content: space-between; }
    .header-btn { width: 44px; height: 44px; display: flex; align-items: center; justify-content: center; background: none; border: none; color: var(--text-primary); cursor: pointer; }
    
    /* TOP TABS */
    .top-tabs { display: flex; padding: 6px 16px; background: var(--bg-tab-bar); border-bottom: 1px solid var(--divider); }
    .top-tab { flex: 1; padding: 8px; border-radius: 8px; font-size: 14px; font-weight: 500; color: var(--text-tertiary); background: transparent; border: none; cursor: pointer; text-align: center; position: relative; transition: all 0.2s; }
    .top-tab.active { background: var(--bg-pill-active); color: var(--text-primary); font-weight: 600; }
    .notification-dot { position: absolute; top: 4px; right: 4px; width: 8px; height: 8px; background: var(--brand-orange); border-radius: 50%; }
    
    /* SEGMENT CONTROL */
    .segment-control { display: flex; background: var(--bg-tab-bar); border-radius: 10px; padding: 4px; margin: 12px 16px; }
    .segment-btn { flex: 1; padding: 10px 12px; border-radius: 8px; font-size: 14px; font-weight: 500; color: var(--text-tertiary); background: transparent; border: none; cursor: pointer; transition: all 0.2s; }
    .segment-btn.active { background: var(--bg-pill-active); color: var(--text-primary); font-weight: 600; }
    
    /* GENRE PILLS */
    .genre-pills { display: flex; gap: 8px; padding: 12px 16px; overflow-x: auto; }
    .genre-pill { padding: 8px 16px; border-radius: 20px; font-size: 13px; font-weight: 600; white-space: nowrap; cursor: pointer; background: var(--bg-card); color: var(--text-secondary); border: none; transition: all 0.2s; }
    .genre-pill:active { transform: scale(0.95); }
    .genre-pill.active { background: var(--brand-green); color: #000; }
    
    /* SECTION HEADER */
    .section-header { font-size: 17px; font-weight: 700; padding: 16px 16px 12px; }
    
    /* POSTER GRID 3-col */
    .poster-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 8px; padding: 0 16px 16px; }
    .poster-item { aspect-ratio: 2/3; border-radius: 4px; overflow: hidden; cursor: pointer; position: relative; background: var(--bg-card); transition: transform 0.2s; }
    .poster-item:active { transform: scale(0.96); }
    .poster-img { width: 100%; height: 100%; object-fit: cover; }
    .poster-watched { position: absolute; bottom: 4px; left: 4px; width: 22px; height: 22px; background: var(--brand-green); border-radius: 50%; display: flex; align-items: center; justify-content: center; }
    
    /* LIST GRID 4-col with numbers - AUDIT FIX */
    .list-grid-4 { display: grid; grid-template-columns: repeat(4, 1fr); gap: 6px; padding: 12px 16px; }
    .list-grid-item { aspect-ratio: 2/3; border-radius: 4px; overflow: hidden; position: relative; background: var(--bg-card); }
    .list-grid-item img { width: 100%; height: 100%; object-fit: cover; }
    .list-grid-number { position: absolute; bottom: 4px; right: 4px; min-width: 20px; height: 20px; padding: 0 5px; background: rgba(0,0,0,0.8); border-radius: 10px; display: flex; align-items: center; justify-content: center; font-size: 11px; font-weight: 600; }
    
    /* REVIEW CARD - AUDIT FIX: poster on RIGHT */
    .review-card { padding: 16px; border-bottom: 1px solid var(--divider); }
    .review-header { display: flex; gap: 12px; }
    .review-left { flex: 1; min-width: 0; }
    .review-user-row { display: flex; align-items: center; gap: 8px; margin-bottom: 8px; }
    .review-title-row { display: flex; align-items: baseline; gap: 6px; margin-bottom: 4px; }
    .review-title { font-size: 17px; font-weight: 700; }
    .review-year { font-size: 16px; color: var(--text-tertiary); }
    .review-rating-row { display: flex; align-items: center; gap: 8px; margin-bottom: 4px; }
    .review-date { font-size: 13px; color: var(--text-tertiary); }
    .review-poster { width: 80px; height: 120px; border-radius: 4px; object-fit: cover; flex-shrink: 0; background: var(--bg-card); }
    .review-text { font-size: 15px; color: var(--text-secondary); line-height: 1.55; margin-top: 12px; }
    
    /* SPOILER */
    .spoiler-block { background: var(--bg-card); border-radius: 8px; padding: 14px 16px; display: flex; align-items: center; gap: 12px; margin-top: 12px; cursor: pointer; }
    .spoiler-text { font-size: 14px; color: var(--text-tertiary); }
    
    /* LIST CARD */
    .list-card { padding: 16px; border-bottom: 1px solid var(--divider); }
    .list-card-header { display: flex; justify-content: space-between; align-items: flex-start; gap: 12px; margin-bottom: 4px; }
    .list-title { font-size: 17px; font-weight: 700; flex: 1; }
    .list-user { display: flex; align-items: center; gap: 6px; flex-shrink: 0; }
    .list-desc { font-size: 14px; color: var(--text-secondary); line-height: 1.5; margin-bottom: 12px; }
    .list-posters-scroll { display: flex; gap: 6px; overflow-x: auto; padding-bottom: 8px; margin: 0 -16px; padding-left: 16px; padding-right: 16px; }
    .list-poster-sm { width: 70px; height: 105px; border-radius: 4px; object-fit: cover; flex-shrink: 0; background: var(--bg-card); }
    
    /* JOURNAL */
    .journal-card { margin: 0 16px 20px; cursor: pointer; }
    .journal-card:active { opacity: 0.9; }
    .journal-img { width: 100%; height: 200px; border-radius: 8px; object-fit: cover; margin-bottom: 12px; background: var(--bg-card); }
    .journal-title { font-size: 18px; font-weight: 700; margin-bottom: 6px; }
    .journal-desc { font-size: 15px; color: var(--text-secondary); line-height: 1.5; }
    .journal-desc em { font-style: italic; }
    
    /* DIARY */
    .diary-month { background: var(--bg-modal); padding: 8px 16px; font-size: 11px; font-weight: 600; color: var(--text-secondary); text-transform: uppercase; letter-spacing: 1.5px; }
    .diary-entry { display: flex; gap: 12px; padding: 12px 16px; border-bottom: 1px solid var(--divider); cursor: pointer; }
    .diary-entry:active { background: var(--bg-elevated); }
    .diary-date { width: 44px; height: 44px; border: 1.5px solid var(--text-muted); border-radius: 6px; display: flex; align-items: center; justify-content: center; font-size: 18px; font-weight: 500; flex-shrink: 0; }
    .diary-poster { width: 48px; height: 72px; border-radius: 4px; object-fit: cover; flex-shrink: 0; background: var(--bg-card); }
    .diary-info { flex: 1; display: flex; flex-direction: column; justify-content: center; min-width: 0; }
    .diary-title-row { display: flex; align-items: baseline; gap: 6px; margin-bottom: 4px; }
    .diary-title { font-size: 15px; font-weight: 600; }
    .diary-year { font-size: 14px; color: var(--text-tertiary); }
    .diary-actions { display: flex; align-items: center; gap: 8px; }
    .diary-menu { margin-left: auto; color: var(--text-muted); }
    
    /* ACTIVITY - AUDIT FIX: time on RIGHT, inline stars */
    .activity-item { display: flex; gap: 12px; padding: 12px 16px; border-bottom: 1px solid var(--divider); cursor: pointer; align-items: flex-start; }
    .activity-item:active { background: var(--bg-elevated); }
    .activity-content { flex: 1; min-width: 0; }
    .activity-row { display: flex; align-items: flex-start; justify-content: space-between; gap: 8px; }
    .activity-text { font-size: 14px; color: var(--text-secondary); line-height: 1.45; flex: 1; }
    .activity-text strong { color: var(--text-primary); font-weight: 600; }
    .activity-text .stars { color: var(--brand-green); }
    .activity-time { font-size: 13px; color: var(--text-muted); flex-shrink: 0; white-space: nowrap; }
    
    /* AVATAR */
    .avatar { width: 40px; height: 40px; border-radius: 50%; background: linear-gradient(135deg, var(--brand-orange), var(--brand-green)); display: flex; align-items: center; justify-content: center; font-size: 14px; font-weight: 700; flex-shrink: 0; overflow: hidden; }
    .avatar-sm { width: 28px; height: 28px; font-size: 11px; }
    .avatar-lg { width: 100px; height: 100px; font-size: 36px; }
    .avatar-placeholder { background: var(--bg-card); color: var(--text-muted); }
    
    /* BADGES */
    .badge { display: inline-flex; padding: 2px 6px; border-radius: 4px; font-size: 10px; font-weight: 700; text-transform: uppercase; letter-spacing: 0.5px; }
    .badge-crew { background: var(--badge-crew); }
    .badge-patron { background: var(--badge-patron); }
    
    /* STAR RATING */
    .stars { color: var(--brand-green); font-size: 14px; letter-spacing: -1px; }
    .star-rating-interactive { display: flex; justify-content: center; gap: 8px; }
    .star-btn { background: none; border: none; padding: 4px; cursor: pointer; color: var(--text-tertiary); transition: transform 0.1s; }
    .star-btn:active { transform: scale(1.2); }
    .star-btn.active { color: var(--brand-green); }
    .star-btn svg { width: 32px; height: 32px; }
    
    /* SEARCH */
    .search-header { padding: 16px; text-align: center; font-size: 17px; font-weight: 600; }
    .search-bar { display: flex; align-items: center; gap: 10px; background: var(--bg-card); border-radius: 8px; padding: 10px 14px; margin: 0 16px 16px; }
    .search-bar svg { color: var(--text-tertiary); flex-shrink: 0; }
    .search-bar input { flex: 1; background: none; border: none; font-size: 15px; color: var(--text-primary); outline: none; }
    .search-bar input::placeholder { color: var(--text-tertiary); }
    .browse-title { font-size: 16px; font-weight: 700; padding: 16px 16px 8px; }
    .browse-row { display: flex; align-items: center; justify-content: space-between; padding: 14px 16px; border-bottom: 1px solid var(--divider); cursor: pointer; }
    .browse-row:active { background: var(--bg-elevated); }
    .browse-row-label { font-size: 15px; color: var(--text-secondary); }
    .browse-row svg { color: var(--text-muted); }
    
    /* PROFILE */
    .profile-header-row { display: flex; align-items: center; justify-content: space-between; padding: 8px 16px; }
    .profile-username { font-size: 17px; font-weight: 600; }
    .profile-avatar-section { display: flex; flex-direction: column; align-items: center; padding: 20px 16px; }
    .profile-row { display: flex; align-items: center; justify-content: space-between; padding: 14px 16px; border-bottom: 1px solid var(--divider); cursor: pointer; }
    .profile-row:active { background: var(--bg-elevated); }
    .profile-row-label { font-size: 15px; color: var(--text-primary); }
    .profile-row-value { display: flex; align-items: center; gap: 6px; font-size: 15px; color: var(--text-tertiary); }
    .remove-ads { text-align: center; padding: 24px 16px; font-size: 12px; font-weight: 600; color: var(--text-muted); text-transform: uppercase; letter-spacing: 1px; }
    
    /* CHAT */
    .chat-container { display: flex; flex-direction: column; height: 100%; }
    .chat-messages { flex: 1; overflow-y: auto; padding: 16px; }
    .chat-message { display: flex; gap: 10px; margin-bottom: 16px; }
    .chat-message.own { flex-direction: row-reverse; }
    .chat-bubble { background: var(--bg-card); padding: 10px 14px; border-radius: 16px; border-top-left-radius: 4px; max-width: 75%; }
    .chat-bubble.own { background: var(--brand-green); color: #000; border-top-left-radius: 16px; border-top-right-radius: 4px; }
    .chat-username { font-size: 12px; font-weight: 600; margin-bottom: 4px; color: var(--brand-blue); }
    .chat-text { font-size: 15px; line-height: 1.4; }
    .chat-time { font-size: 11px; opacity: 0.7; margin-top: 4px; }
    .chat-input-area { display: flex; gap: 12px; padding: 12px 16px; background: var(--bg-tab-bar); border-top: 1px solid var(--divider); }
    .chat-input { flex: 1; background: var(--bg-card); border: none; border-radius: 20px; padding: 10px 16px; font-size: 15px; color: var(--text-primary); outline: none; }
    .chat-input::placeholder { color: var(--text-tertiary); }
    .chat-send { width: 40px; height: 40px; border-radius: 50%; background: var(--brand-green); border: none; color: #000; cursor: pointer; display: flex; align-items: center; justify-content: center; }
    
    /* EMPTY STATE */
    .empty-state { display: flex; flex-direction: column; align-items: center; justify-content: center; padding: 60px 32px; text-align: center; }
    .empty-title { font-size: 18px; color: var(--text-muted); margin-bottom: 8px; }
    .empty-quote { font-size: 14px; color: var(--text-muted); font-style: italic; max-width: 280px; line-height: 1.5; }
    
    /* BOTTOM NAV */
    .bottom-nav { display: flex; background: var(--bg-tab-bar); border-top: 1px solid var(--divider); padding: 8px 0; padding-bottom: max(8px, env(safe-area-inset-bottom)); }
    .nav-item { flex: 1; display: flex; flex-direction: column; align-items: center; gap: 4px; padding: 8px; background: none; border: none; cursor: pointer; color: var(--text-tertiary); transition: color 0.2s; }
    .nav-item:active { opacity: 0.7; }
    .nav-item.active { color: var(--brand-blue); }
    .nav-item svg { width: 24px; height: 24px; }
    .nav-add { flex: 1; display: flex; align-items: center; justify-content: center; }
    .nav-add-btn { width: 44px; height: 44px; border-radius: 50%; border: 2.5px solid var(--brand-green); background: transparent; color: var(--brand-green); display: flex; align-items: center; justify-content: center; cursor: pointer; transition: all 0.2s; }
    .nav-add-btn:active { background: var(--brand-green); color: #000; transform: scale(0.95); }
    .nav-add-btn svg { width: 24px; height: 24px; }
    
    /* MODALS */
    .overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.6); z-index: 900; animation: fadeIn 0.2s ease-out; }
    .bottom-sheet { position: fixed; bottom: 0; left: 0; right: 0; max-width: 430px; margin: 0 auto; background: var(--bg-action-sheet); border-radius: 16px 16px 0 0; z-index: 1000; max-height: 90vh; overflow-y: auto; animation: slideUp 0.3s cubic-bezier(0.16, 1, 0.3, 1); }
    .sheet-handle { width: 36px; height: 4px; background: var(--text-muted); border-radius: 2px; margin: 12px auto; }
    .sheet-header { display: flex; align-items: center; justify-content: space-between; padding: 12px 16px; border-bottom: 1px solid var(--divider); }
    .sheet-cancel { font-size: 15px; color: var(--text-secondary); background: none; border: none; cursor: pointer; padding: 8px; margin: -8px; }
    .sheet-title { font-size: 17px; font-weight: 600; }
    .sheet-save { font-size: 15px; font-weight: 600; color: var(--brand-green); background: none; border: none; cursor: pointer; padding: 8px; margin: -8px; }
    .sheet-save:disabled { color: var(--text-muted); }
    
    /* ACTION SHEET */
    .action-sheet-content { padding: 20px 24px; }
    .action-poster-section { text-align: center; padding-bottom: 16px; margin-bottom: 16px; border-bottom: 1px solid var(--divider); }
    .action-poster { width: 120px; height: 180px; border-radius: 6px; object-fit: cover; margin: 0 auto 12px; display: block; box-shadow: 0 8px 24px rgba(0,0,0,0.4); }
    .action-row { display: flex; justify-content: space-around; padding: 16px 0; }
    .action-btn { display: flex; flex-direction: column; align-items: center; gap: 8px; background: none; border: none; cursor: pointer; color: var(--text-secondary); padding: 8px; transition: transform 0.2s; }
    .action-btn:active { transform: scale(0.9); }
    .action-btn.active { color: var(--brand-green); }
    .action-btn.liked { color: var(--brand-orange); }
    .action-btn svg { width: 32px; height: 32px; }
    .action-label { font-size: 13px; font-weight: 500; color: var(--text-primary); }
    .action-divider { height: 1px; background: var(--divider); margin: 8px 0; }
    .rating-section { text-align: center; padding: 16px 0; }
    .rating-label { font-size: 14px; color: var(--text-secondary); margin-bottom: 12px; }
    .menu-item { padding: 14px 0; text-align: center; font-size: 16px; color: var(--text-secondary); border-bottom: 1px solid var(--divider); cursor: pointer; }
    .menu-item:active { background: var(--bg-input); }
    .menu-item:last-child { border-bottom: none; }
    .menu-item.disabled { color: var(--text-muted); }
    
    /* NEW LIST MODAL */
    .new-list-content { padding: 0 16px 16px; }
    .form-label { font-size: 11px; font-weight: 600; color: var(--text-secondary); text-transform: uppercase; letter-spacing: 1px; margin-bottom: 8px; display: block; padding-top: 16px; }
    .form-input { width: 100%; background: transparent; border: none; border-bottom: 1px solid var(--divider); padding: 12px 0; font-size: 15px; color: var(--text-primary); outline: none; }
    .form-input::placeholder { color: var(--text-tertiary); }
    .form-link { color: var(--brand-blue); font-size: 15px; padding: 20px 0; border-bottom: 1px solid var(--divider); display: block; }
    .form-tags { padding: 16px 0; font-size: 15px; color: var(--text-tertiary); border-bottom: 1px solid var(--divider); }
    .list-options { display: flex; justify-content: space-around; padding: 20px 0; }
    .list-option { display: flex; flex-direction: column; align-items: center; gap: 8px; color: var(--text-tertiary); }
    .list-option svg { width: 28px; height: 28px; }
    .list-option span { font-size: 12px; }
    
    /* FILTERS MODAL */
    .filters-content { padding: 0 16px 16px; }
    .filter-section-label { font-size: 11px; font-weight: 600; color: var(--text-secondary); text-transform: uppercase; letter-spacing: 1px; padding: 20px 0 8px; }
    .filter-row { display: flex; align-items: center; justify-content: space-between; padding: 14px 0; border-bottom: 1px solid var(--divider); }
    .filter-label { font-size: 15px; color: var(--text-primary); }
    .filter-value { display: flex; align-items: center; gap: 6px; font-size: 15px; color: var(--text-tertiary); }
    .toggle { width: 51px; height: 31px; background: var(--bg-card); border-radius: 16px; position: relative; cursor: pointer; transition: background 0.2s; }
    .toggle.active { background: var(--brand-green); }
    .toggle-knob { position: absolute; top: 2px; left: 2px; width: 27px; height: 27px; background: white; border-radius: 50%; transition: transform 0.2s; }
    .toggle.active .toggle-knob { transform: translateX(20px); }
    
    /* LOGIN - AUDIT FIX: seamless button stack */
    .login-screen { display: flex; flex-direction: column; min-height: 100%; }
    .login-backdrop { flex: 1; background-size: cover; background-position: center; position: relative; }
    .login-backdrop::after { content: ''; position: absolute; inset: 0; background: linear-gradient(to bottom, rgba(20,24,28,0.3) 0%, rgba(20,24,28,0.95) 70%, var(--bg-primary) 100%); }
    .login-content { position: relative; z-index: 1; padding: 0 24px 32px; text-align: center; }
    .login-logo { display: flex; justify-content: center; gap: 0; margin-bottom: 16px; }
    .logo-circle { width: 48px; height: 48px; border-radius: 50%; margin: 0 -8px; }
    .logo-orange { background: var(--brand-orange); }
    .logo-green { background: var(--brand-green); }
    .logo-blue { background: var(--brand-blue); }
    .login-title { font-family: var(--font-display); font-size: 32px; margin-bottom: 8px; }
    .login-tagline { font-size: 16px; color: var(--text-secondary); margin-bottom: 32px; }
    .login-buttons { border-radius: 8px; overflow: hidden; }
    .login-btn { width: 100%; padding: 16px; font-size: 16px; font-weight: 600; border: none; cursor: pointer; display: block; }
    .login-btn-primary { background: var(--bg-action-sheet); color: var(--text-primary); }
    .login-btn-divider { background: var(--bg-action-sheet); color: var(--text-primary); border-top: 1px solid rgba(255,255,255,0.1); }
    .login-btn-ghost { background: var(--bg-action-sheet); color: var(--text-secondary); border-top: 1px solid rgba(255,255,255,0.1); }
    .login-footer { font-size: 13px; color: var(--text-muted); margin-top: 24px; line-height: 1.5; }
    .carousel-dots { display: flex; justify-content: center; gap: 8px; padding: 20px 0; }
    .carousel-dot { width: 8px; height: 8px; border-radius: 50%; background: var(--text-muted); }
    .carousel-dot.active { background: var(--text-primary); }
    
    /* ONBOARDING */
    .onboarding-screen { min-height: 100%; background: linear-gradient(to bottom, #2A3642 0%, var(--bg-primary) 60%); display: flex; flex-direction: column; }
    .onboarding-poster-row { display: flex; justify-content: center; align-items: center; gap: 8px; padding: 40px 0 20px; }
    .onboarding-poster { width: 100px; height: 150px; border-radius: 6px; object-fit: cover; opacity: 0.6; }
    .onboarding-poster.center { width: 140px; height: 210px; opacity: 1; box-shadow: 0 8px 32px rgba(0,0,0,0.5); }
    .onboarding-actions { display: flex; justify-content: center; gap: 24px; padding: 16px 0; }
    .onboarding-action { display: flex; flex-direction: column; align-items: center; gap: 4px; color: var(--text-tertiary); }
    .onboarding-action svg { width: 28px; height: 28px; }
    .onboarding-action span { font-size: 11px; }
    .onboarding-content { flex: 1; padding: 20px 24px; text-align: center; }
    .onboarding-title { font-size: 24px; font-weight: 700; margin-bottom: 16px; }
    .onboarding-desc { font-size: 15px; color: var(--text-secondary); line-height: 1.6; margin-bottom: 16px; }
    .onboarding-buttons { display: flex; gap: 0; margin-top: auto; padding: 16px 24px 32px; }
    .onboarding-btn { flex: 1; padding: 16px; font-size: 15px; font-weight: 600; border: none; cursor: pointer; }
    .onboarding-btn-skip { background: var(--bg-action-sheet); color: var(--text-primary); border-radius: 8px 0 0 8px; }
    .onboarding-btn-action { background: var(--brand-green); color: #000; border-radius: 0 8px 8px 0; }
  </style>
</head>
<body>
  <div id="root"></div>
  
  <script type="text/babel">
    const { useState } = React;
    
    // DATA
    const SHOWS = [
      { id: 1, name: 'Love Island', year: '2024', genre: 'Reality', poster: 'https://image.tmdb.org/t/p/w500/h9f3vNGZGDRqOw26uwDMYhSLZ01.jpg' },
      { id: 2, name: 'The Bachelor', year: '2024', genre: 'Reality', poster: 'https://image.tmdb.org/t/p/w500/mKadW8gXqVdg01IJYkMHNrzoZ3a.jpg' },
      { id: 3, name: 'Survivor', year: '2024', genre: 'Reality', poster: 'https://image.tmdb.org/t/p/w500/ddYkNcvJJ1FJFy3SaZfqTXExkPc.jpg' },
      { id: 4, name: 'The Traitors', year: '2024', genre: 'Reality', poster: 'https://image.tmdb.org/t/p/w500/7FN2nmpApXjLjQJKmJBLqZF91pz.jpg' },
      { id: 5, name: 'Love Is Blind', year: '2024', genre: 'Reality', poster: 'https://image.tmdb.org/t/p/w500/bHKgb4ShQ8AsCPFe3K4HQC64aKP.jpg' },
      { id: 6, name: 'The Circle', year: '2024', genre: 'Reality', poster: 'https://image.tmdb.org/t/p/w500/iLfxuPBWgDg5556UsmREzA9cNiA.jpg' },
      { id: 11, name: 'The Last of Us', year: '2024', genre: 'Drama', poster: 'https://image.tmdb.org/t/p/w500/uKvVjHNqB5VmOrdxqAt2F7J78ED.jpg' },
      { id: 12, name: 'The Bear', year: '2024', genre: 'Drama', poster: 'https://image.tmdb.org/t/p/w500/zMpJY5CizTJfH8njYsYk87S9eHf.jpg' },
      { id: 13, name: 'Severance', year: '2024', genre: 'Drama', poster: 'https://image.tmdb.org/t/p/w500/lFqJzi7XFuzp3cp6rFxPYL5Frdm.jpg' },
      { id: 14, name: 'House of Dragon', year: '2024', genre: 'Drama', poster: 'https://image.tmdb.org/t/p/w500/7QMsOTMUswlwxJP0rTTZfmz2tX2.jpg' },
      { id: 15, name: 'Succession', year: '2023', genre: 'Drama', poster: 'https://image.tmdb.org/t/p/w500/7HW47XbkNQ5fiwQFYGWdw9gs144.jpg' },
      { id: 16, name: 'The White Lotus', year: '2024', genre: 'Drama', poster: 'https://image.tmdb.org/t/p/w500/gH5i3JbnLsyTvcImlofNvXtH3i5.jpg' },
      { id: 21, name: 'Abbott Elementary', year: '2024', genre: 'Comedy', poster: 'https://image.tmdb.org/t/p/w500/fLZJHG8gXF0H1fCYd6cCMKDMkQD.jpg' },
      { id: 22, name: 'Hacks', year: '2024', genre: 'Comedy', poster: 'https://image.tmdb.org/t/p/w500/pxb3FLLpJKU6rAcP0nQmTY2L95p.jpg' },
      { id: 23, name: 'What We Do in Shadows', year: '2024', genre: 'Comedy', poster: 'https://image.tmdb.org/t/p/w500/chckIPxBbvyFCcCFz5NJwPAkawf.jpg' },
    ];
    
    const USERS = {
      me: { id: 'me', username: 'tvlover' },
      ari: { id: 'ari', username: 'ari' },
      princess: { id: 'princess', username: 'PrincessLucas', badge: 'patron' },
      lobo: { id: 'lobo', username: '✧lobotomommy✧', badge: 'crew' },
      drew: { id: 'drew', username: 'Drew Cowen' },
      bryan: { id: 'bryan', username: 'Bryan Howell' },
    };
    
    // Activity from people you follow - EXACTLY matching screenshot
    const FRIEND_ACTIVITY = [
      { id: 1, userId: 'ari', type: 'liked_review', target: 'PrincessLucas', rating: 4.5, showName: 'Once Upon a Studio', time: '3m' },
      { id: 2, userId: 'ari', type: 'liked_review', target: '✧lobotomommy✧', rating: 4.5, showName: 'Cecil B. Demented', time: '3m' },
      { id: 3, userId: 'ari', type: 'liked_review', target: 'Drew Cowen', showName: 'Chasing Time', time: '3m' },
      { id: 4, userId: 'lobo', type: 'followed', target: 'Bryan Howell', time: '21m' },
      { id: 5, userId: 'lobo', type: 'liked_review', target: 'Bryan Howell', rating: 2.5, showName: 'Shelby Oaks', time: '21m' },
      { id: 6, userId: 'lobo', type: 'liked_review', target: 'Bryan Howell', rating: 4.5, showName: 'Superman', time: '21m' },
      { id: 7, userId: 'lobo', type: 'liked_review', target: 'Bryan Howell', rating: 2, showName: 'HIM', time: '21m' },
      { id: 8, userId: 'drew', type: 'watchlist', showName: 'One Night in Miami...', time: '2h' },
    ];
    
    const REVIEWS = [
      { id: 1, userId: 'lobo', showName: 'Drive', year: '2011', rating: 5, text: 'The tech writer John Gruber is fond of a Kubrick quote about the truth of a thing being in the feel of it rather than the think of it, a phrase that for me perfectly explains the appeal of Nicolas Winding Refn\'s noirish adaptation of the James Sallis novel.', date: 'Watched 11 Nov 2011', poster: 'https://image.tmdb.org/t/p/w500/602vevIURmpDfzbnv5Ubi6wIkQm.jpg' },
    ];
    
    const LISTS = [
      { id: 1, userId: 'drew', title: 'Movies everyone should watch at least once during their lifetime', desc: 'I asked reddit whats one movie everyone should watch at least once in their lifetime to create a list of movies that everyone should watch.', posters: SHOWS.slice(0, 6).map(s => s.poster) },
    ];
    
    const DIARY_ENTRIES = [
      { id: 1, day: 27, showName: 'Only Lovers Left Alive', year: '2013', rating: 4.5, liked: true, rewatch: false, poster: SHOWS[0].poster },
      { id: 2, day: 27, showName: 'Blood Simple', year: '1984', rating: 4, liked: true, rewatch: true, poster: SHOWS[2].poster },
      { id: 3, day: 25, showName: 'True Grit', year: '2010', rating: 4.5, liked: true, rewatch: true, poster: SHOWS[10].poster },
      { id: 4, day: 24, showName: 'A Serious Man', year: '2009', rating: 5, liked: true, rewatch: false, poster: SHOWS[11].poster },
    ];
    
    const MOVIE_QUOTES = [
      "Game over, man! It's game over!",
      "Nothing left but some damn rocks on the window sill. And that cupcake on the wall!",
      "Tyler's not here. Tyler went away. Tyler's gone.",
      "He speaks a dozen languages, knows every local custom. He'll blend in, disappear, you'll never see him again.",
    ];
    
    // ICONS - AUDIT FIXED
    const Icon = ({ name, size = 24, filled = false }) => {
      const icons = {
        // FIXED: Logged = filled green circle with eye cutout (THE signature Letterboxd icon)
        Eye: filled 
          ? <svg width={size} height={size} viewBox="0 0 24 24"><circle cx="12" cy="12" r="11" fill="currentColor"/><path d="M12 7C8 7 5 12 5 12s3 5 7 5 7-5 7-5-3-5-7-5z" fill="#14181C"/><circle cx="12" cy="12" r="2.5" fill="currentColor"/></svg>
          : <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/><circle cx="12" cy="12" r="3"/></svg>,
        
        Heart: <svg width={size} height={size} viewBox="0 0 24 24" fill={filled ? 'currentColor' : 'none'} stroke="currentColor" strokeWidth="2"><path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"/></svg>,
        
        // FIXED: Watchlist = clock with + badge
        Clock: filled
          ? <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/><circle cx="19" cy="19" r="4.5" fill="#14181C" stroke="none"/><circle cx="19" cy="19" r="4" fill="none" stroke="currentColor" strokeWidth="1.5"/><path d="M19 17v4M17 19h4" stroke="currentColor" strokeWidth="1.5"/></svg>
          : <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>,
        
        Star: <svg width={size} height={size} viewBox="0 0 24 24" fill={filled ? 'currentColor' : 'none'} stroke="currentColor" strokeWidth="2"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg>,
        Films: <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><rect x="2" y="2" width="20" height="20" rx="2"/><rect x="6" y="6" width="12" height="12" rx="1"/></svg>,
        Search: <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><circle cx="11" cy="11" r="8"/><path d="m21 21-4.35-4.35"/></svg>,
        Plus: <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2.5"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg>,
        Activity: <svg width={size} height={size} viewBox="0 0 24 24" fill={filled ? 'currentColor' : 'none'} stroke="currentColor" strokeWidth="2"><polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"/></svg>,
        Profile: <svg width={size} height={size} viewBox="0 0 24 24" fill={filled ? 'currentColor' : 'none'} stroke="currentColor" strokeWidth="2"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>,
        ChevronLeft: <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><polyline points="15 18 9 12 15 6"/></svg>,
        ChevronRight: <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><polyline points="9 18 15 12 9 6"/></svg>,
        Settings: <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><circle cx="12" cy="12" r="3"/><path d="M12 1v4M12 19v4M4.22 4.22l2.83 2.83M16.95 16.95l2.83 2.83M1 12h4M19 12h4M4.22 19.78l2.83-2.83M16.95 7.05l2.83-2.83"/></svg>,
        MoreHorizontal: <svg width={size} height={size} viewBox="0 0 24 24" fill="currentColor"><circle cx="5" cy="12" r="2"/><circle cx="12" cy="12" r="2"/><circle cx="19" cy="12" r="2"/></svg>,
        Filter: <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><line x1="4" y1="8" x2="20" y2="8"/><circle cx="8" cy="8" r="2" fill="currentColor"/><line x1="4" y1="16" x2="20" y2="16"/><circle cx="16" cy="16" r="2" fill="currentColor"/></svg>,
        Menu: <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="18" x2="21" y2="18"/></svg>,
        Repeat: <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><polyline points="17 1 21 5 17 9"/><path d="M3 11V9a4 4 0 0 1 4-4h14"/><polyline points="7 23 3 19 7 15"/><path d="M21 13v2a4 4 0 0 1-4 4H3"/></svg>,
        Check: <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="#000" strokeWidth="3"><polyline points="20 6 9 17 4 12"/></svg>,
        Send: <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><line x1="22" y1="2" x2="11" y2="13"/><polygon points="22 2 15 22 11 13 2 9 22 2"/></svg>,
        Globe: <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><circle cx="12" cy="12" r="10"/><line x1="2" y1="12" x2="22" y2="12"/><path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"/></svg>,
        Trophy: <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M6 9H4.5a2.5 2.5 0 0 1 0-5H6"/><path d="M18 9h1.5a2.5 2.5 0 0 0 0-5H18"/><path d="M4 22h16"/><path d="M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22"/><path d="M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22"/><path d="M18 2H6v7a6 6 0 0 0 12 0V2Z"/></svg>,
        Comment: <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8 8v.5z"/></svg>,
        Copy: <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><rect x="9" y="9" width="13" height="13" rx="2"/><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/></svg>,
      };
      return <span style={{ display: 'inline-flex', alignItems: 'center', justifyContent: 'center' }}>{icons[name] || icons.Star}</span>;
    };
    
    // Stars as text (for inline display) - matches screenshot exactly
    const Stars = ({ rating }) => {
      const full = Math.floor(rating);
      const half = rating % 1 >= 0.5;
      let s = '';
      for (let i = 0; i < full; i++) s += '★';
      if (half) s += '½';
      return <span className="stars">{s}</span>;
    };
    
    // Interactive star rating
    const StarRating = ({ rating, onChange }) => (
      <div className="star-rating-interactive">
        {[1, 2, 3, 4, 5].map(star => (
          <button key={star} className={`star-btn ${rating >= star ? 'active' : ''}`} onClick={() => onChange?.(star)}>
            <Icon name="Star" size={32} filled={rating >= star} />
          </button>
        ))}
      </div>
    );
    
    const Avatar = ({ user, size = 'md', className = '' }) => {
      const sizeClass = size === 'sm' ? 'avatar-sm' : size === 'lg' ? 'avatar-lg' : '';
      return <div className={`avatar ${sizeClass} ${className}`}>{user?.username?.charAt(0).toUpperCase() || '?'}</div>;
    };
    
    const Badge = ({ type }) => type ? <span className={`badge badge-${type}`}>{type}</span> : null;
    
    const EmptyState = ({ title, quoteIndex = 0 }) => (
      <div className="empty-state">
        <div className="empty-title">{title}</div>
        <div className="empty-quote">{MOVIE_QUOTES[quoteIndex]}</div>
      </div>
    );
    
    // ==========================================================================
    // MAIN APP
    // ==========================================================================
    function App() {
      const [screen, setScreen] = useState('login');
      const [bottomTab, setBottomTab] = useState('home');
      const [mainTab, setMainTab] = useState('films');
      const [activityTab, setActivityTab] = useState('friends');
      const [profileTab, setProfileTab] = useState('profile');
      const [genreFilter, setGenreFilter] = useState('All');
      
      const [showActionSheet, setShowActionSheet] = useState(false);
      const [showAddFilm, setShowAddFilm] = useState(false);
      const [showNewList, setShowNewList] = useState(false);
      const [showFilters, setShowFilters] = useState(false);
      const [showListDetail, setShowListDetail] = useState(false);
      const [showChat, setShowChat] = useState(null);
      const [selectedEpisode, setSelectedEpisode] = useState(null);
      
      const [watched, setWatched] = useState({});
      const [liked, setLiked] = useState({});
      const [ratings, setRatings] = useState({});
      const [fadeWatched, setFadeWatched] = useState(false);
      
      const handleEpisodePress = (ep) => { setSelectedEpisode(ep); setShowActionSheet(true); };
      const filteredShows = genreFilter === 'All' ? SHOWS : SHOWS.filter(s => s.genre === genreFilter);
      
      // LOGIN
      if (screen === 'login') {
        return (
          <div className="app">
            <div className="login-screen">
              <div className="login-backdrop" style={{ backgroundImage: 'url(https://image.tmdb.org/t/p/w1280/uDgy6hyPd82kOHh6I95FLtLnj6p.jpg)' }} />
              <div className="login-content">
                <div className="login-logo">
                  <div className="logo-circle logo-orange" />
                  <div className="logo-circle logo-green" />
                  <div className="logo-circle logo-blue" />
                </div>
                <h1 className="login-title">Episodic</h1>
                <p className="login-tagline">The social network for TV lovers.</p>
                
                <div className="login-buttons">
                  <button className="login-btn login-btn-primary" onClick={() => setScreen('main')}>Sign in</button>
                  <button className="login-btn login-btn-divider">Create account</button>
                  <button className="login-btn login-btn-ghost" onClick={() => setScreen('onboarding')}>Skip this step</button>
                </div>
                
                <p className="login-footer">An account is not required to browse content, but you must have one to track episodes and participate.</p>
                <div className="carousel-dots">{[0,1,2,3,4,5].map(i => <div key={i} className={`carousel-dot ${i === 0 ? 'active' : ''}`} />)}</div>
              </div>
            </div>
            <div className="bottom-nav">
              <button className="nav-item active"><Icon name="Profile" size={24} filled /></button>
              <button className="nav-item"><Icon name="Films" size={24} /></button>
              <button className="nav-item"><Icon name="Search" size={24} /></button>
            </div>
          </div>
        );
      }
      
      // ONBOARDING
      if (screen === 'onboarding') {
        return (
          <div className="app">
            <div className="onboarding-screen">
              <div className="onboarding-poster-row">
                <img src={SHOWS[10].poster} alt="" className="onboarding-poster" />
                <img src={SHOWS[11].poster} alt="" className="onboarding-poster center" />
                <img src={SHOWS[12].poster} alt="" className="onboarding-poster" />
              </div>
              <div className="onboarding-actions">
                <div className="onboarding-action"><Icon name="Eye" size={28} /><span>I've watched it!</span></div>
                <div className="onboarding-action" style={{ color: 'var(--brand-orange)' }}><Icon name="Heart" size={28} filled /><span>loved it!</span></div>
                <div className="onboarding-action"><Icon name="Star" size={28} /></div>
                <div className="onboarding-action"><Icon name="Clock" size={28} filled /></div>
              </div>
              <div className="onboarding-content">
                <h2 className="onboarding-title">Get started</h2>
                <p className="onboarding-desc">Would you like to browse our most popular shows and tell us what you've watched and liked?</p>
                <p className="onboarding-desc">Titles you mark as watched are added to the <strong>Films</strong> tab on your profile, and used to recommend content and improve filters.</p>
              </div>
              <div className="onboarding-buttons">
                <button className="onboarding-btn onboarding-btn-skip" onClick={() => setScreen('main')}>Skip for now</button>
                <button className="onboarding-btn onboarding-btn-action" onClick={() => setScreen('main')}>Browse shows</button>
              </div>
            </div>
          </div>
        );
      }
      
      // MAIN APP
      return (
        <div className="app">
          {/* HEADERS */}
          {bottomTab === 'home' && (
            <>
              <div className="header"><h1 className="header-title">Episodic</h1></div>
              <div className="top-tabs">
                {['Films', 'Reviews', 'Lists', 'Journal'].map(tab => (
                  <button key={tab} className={`top-tab ${mainTab === tab.toLowerCase() ? 'active' : ''}`} onClick={() => setMainTab(tab.toLowerCase())}>
                    {tab}{tab === 'Journal' && <span className="notification-dot" />}
                  </button>
                ))}
              </div>
            </>
          )}
          
          {bottomTab === 'search' && <div className="search-header">Search</div>}
          
          {bottomTab === 'activity' && (
            <>
              <div className="header">
                <div className="header-row">
                  <div style={{ width: 44 }} />
                  <span style={{ fontSize: 17, fontWeight: 600 }}>Activity</span>
                  <button className="header-btn" onClick={() => setShowFilters(true)}><Icon name="Filter" size={22} /></button>
                </div>
              </div>
              <div className="segment-control">
                {['Friends', 'You', 'Incoming'].map(tab => (
                  <button key={tab} className={`segment-btn ${activityTab === tab.toLowerCase() ? 'active' : ''}`} onClick={() => setActivityTab(tab.toLowerCase())}>{tab}</button>
                ))}
              </div>
            </>
          )}
          
          {bottomTab === 'profile' && (
            <>
              <div className="profile-header-row">
                <button className="header-btn"><Icon name="Settings" size={24} /></button>
                <span className="profile-username">{USERS.me.username}</span>
                <button className="header-btn"><Icon name="MoreHorizontal" size={24} /></button>
              </div>
              <div className="top-tabs">
                {['Profile', 'Diary', 'Lists', 'Watchlist'].map(tab => (
                  <button key={tab} className={`top-tab ${profileTab === tab.toLowerCase() ? 'active' : ''}`} onClick={() => setProfileTab(tab.toLowerCase())}>{tab}</button>
                ))}
              </div>
            </>
          )}
          
          {/* CONTENT */}
          <div className="main-content">
            {/* FILMS TAB */}
            {bottomTab === 'home' && mainTab === 'films' && (
              <>
                <div className="genre-pills">
                  {['All', 'Reality', 'Drama', 'Comedy'].map(g => (
                    <button key={g} className={`genre-pill ${genreFilter === g ? 'active' : ''}`} onClick={() => setGenreFilter(g)}>{g}</button>
                  ))}
                </div>
                <div className="section-header">Popular this week</div>
                <div className="poster-grid">
                  {filteredShows.map(show => (
                    <div key={show.id} className="poster-item" onClick={() => handleEpisodePress({ id: show.id, poster: show.poster, showName: show.name, season: 1, episode: 1, name: 'Episode 1' })}>
                      <img src={show.poster} alt={show.name} className="poster-img" />
                      {watched[show.id] && <div className="poster-watched"><Icon name="Check" size={12} /></div>}
                    </div>
                  ))}
                </div>
              </>
            )}
            
            {/* REVIEWS TAB - FIXED: poster on RIGHT */}
            {bottomTab === 'home' && mainTab === 'reviews' && REVIEWS.map(review => {
              const user = USERS[review.userId];
              return (
                <div key={review.id} className="review-card">
                  <div className="review-header">
                    <div className="review-left">
                      <div className="review-user-row">
                        <Avatar user={user} size="sm" />
                        <span style={{ fontSize: 13 }}>{user?.username}</span>
                        <Badge type={user?.badge} />
                      </div>
                      <div className="review-title-row">
                        <span className="review-title">{review.showName}</span>
                        <span className="review-year">{review.year}</span>
                      </div>
                      <div className="review-rating-row">
                        <Stars rating={review.rating} />
                        <Icon name="Heart" size={14} filled style={{ color: 'var(--brand-orange)' }} />
                      </div>
                      <div className="review-date">{review.date}</div>
                    </div>
                    <img src={review.poster} alt="" className="review-poster" />
                  </div>
                  <p className="review-text">{review.text}</p>
                </div>
              );
            })}
            
            {/* LISTS TAB */}
            {bottomTab === 'home' && mainTab === 'lists' && (
              <>
                <div className="section-header">Popular this week</div>
                {LISTS.map(list => {
                  const user = USERS[list.userId];
                  return (
                    <div key={list.id} className="list-card" onClick={() => setShowListDetail(true)}>
                      <div className="list-card-header">
                        <span className="list-title">{list.title}</span>
                        <div className="list-user">
                          <span style={{ fontSize: 13, color: 'var(--text-secondary)' }}>{user?.username}</span>
                          <Avatar user={user} size="sm" />
                        </div>
                      </div>
                      <p className="list-desc">{list.desc}</p>
                      <div className="list-posters-scroll">
                        {list.posters.map((p, i) => <img key={i} src={p} alt="" className="list-poster-sm" />)}
                      </div>
                    </div>
                  );
                })}
              </>
            )}
            
            {/* JOURNAL TAB */}
            {bottomTab === 'home' && mainTab === 'journal' && (
              <>
                <div className="journal-card">
                  <img src="https://image.tmdb.org/t/p/w1280/uDgy6hyPd82kOHh6I95FLtLnj6p.jpg" alt="" className="journal-img" />
                  <h3 className="journal-title">Live and Learn</h3>
                  <p className="journal-desc"><em>Half Nelson</em> filmmakers Ryan Fleck and Anna Boden reflect on twenty years of their scrappy indie drama.</p>
                </div>
                <div className="journal-card">
                  <img src="https://image.tmdb.org/t/p/w1280/9z3CCXR7UsCWqmGXVj5aJP0Tc6p.jpg" alt="" className="journal-img" />
                  <h3 className="journal-title">Freedom Now!</h3>
                  <p className="journal-desc">A starter pack of 24 films about the Civil Rights Movement and Black liberation.</p>
                </div>
              </>
            )}
            
            {/* SEARCH */}
            {bottomTab === 'search' && (
              <>
                <div className="search-bar">
                  <Icon name="Search" size={18} />
                  <input type="text" placeholder="Find films, cast + crew, members, reviews..." />
                </div>
                <div className="browse-title">Browse by</div>
                {['Release date', 'Genre, country or language', 'Service', 'Episodic Video Store', 'Most popular', 'Highest rated', 'Most anticipated', 'Top 250 narrative features', 'Featured lists'].map(item => (
                  <div key={item} className="browse-row"><span className="browse-row-label">{item}</span><Icon name="ChevronRight" size={20} /></div>
                ))}
                <div className="browse-title">Episodic.app</div>
                {['New here?', 'Frequent questions', 'About subscriptions', 'Journal / Editorial', 'Showdown challenges', 'Year in Review', 'Gift Guide', 'Merch', 'Contact', 'Social accounts / Follow us', 'Terms of use / Community policy'].map(item => (
                  <div key={item} className="browse-row"><span className="browse-row-label">{item}</span><Icon name="ChevronRight" size={20} /></div>
                ))}
              </>
            )}
            
            {/* ACTIVITY - FIXED: time on RIGHT, stars INLINE */}
            {bottomTab === 'activity' && activityTab === 'friends' && FRIEND_ACTIVITY.map(a => {
              const user = Object.values(USERS).find(u => u.id === a.userId);
              return (
                <div key={a.id} className="activity-item">
                  <Avatar user={user} />
                  <div className="activity-content">
                    <div className="activity-row">
                      <p className="activity-text">
                        <strong>{user?.username}</strong>
                        {a.type === 'liked_review' && <> liked <strong>{a.target}</strong>'s {a.rating && <Stars rating={a.rating} />} review of <strong>{a.showName}</strong></>}
                        {a.type === 'followed' && <> followed <strong>{a.target}</strong></>}
                        {a.type === 'watchlist' && <> added <strong>{a.showName}</strong> to his watchlist</>}
                      </p>
                      <span className="activity-time">{a.time}</span>
                    </div>
                  </div>
                </div>
              );
            })}
            {bottomTab === 'activity' && activityTab === 'you' && <EmptyState title="No activity." quoteIndex={1} />}
            {bottomTab === 'activity' && activityTab === 'incoming' && <EmptyState title="No activity." quoteIndex={2} />}
            
            {/* PROFILE */}
            {bottomTab === 'profile' && profileTab === 'profile' && (
              <>
                <div className="profile-avatar-section"><Avatar user={USERS.me} size="lg" className="avatar-placeholder" /></div>
                <div className="profile-row" style={{ borderTop: '1px solid var(--divider)' }}><span className="profile-row-label">Activity</span><span className="profile-row-value"><Icon name="ChevronRight" size={20} /></span></div>
                <div className="remove-ads">REMOVE ADS</div>
                {[{ label: 'Films', value: 0 }, { label: 'Diary', value: 0 }, { label: 'Reviews', value: 0 }, { label: 'Lists', value: 0, arrow: true }, { label: 'Watchlist', value: 0, arrow: true }].map(row => (
                  <div key={row.label} className="profile-row"><span className="profile-row-label">{row.label}</span><span className="profile-row-value">{row.value}{row.arrow && <Icon name="ChevronRight" size={20} />}</span></div>
                ))}
              </>
            )}
            
            {/* DIARY */}
            {bottomTab === 'profile' && profileTab === 'diary' && (
              <>
                <div className="diary-month">JANUARY 2016</div>
                {DIARY_ENTRIES.map(entry => (
                  <div key={entry.id} className="diary-entry">
                    <div className="diary-date">{entry.day}</div>
                    <img src={entry.poster} alt="" className="diary-poster" />
                    <div className="diary-info">
                      <div className="diary-title-row"><span className="diary-title">{entry.showName}</span><span className="diary-year">{entry.year}</span></div>
                      <div className="diary-actions">
                        <Stars rating={entry.rating} />
                        {entry.liked && <Icon name="Heart" size={14} filled style={{ color: 'var(--brand-orange)' }} />}
                        {entry.rewatch && <Icon name="Repeat" size={14} style={{ color: 'var(--brand-green)' }} />}
                        <span className="diary-menu"><Icon name="Menu" size={16} /></span>
                      </div>
                    </div>
                  </div>
                ))}
              </>
            )}
            
            {bottomTab === 'profile' && profileTab === 'lists' && <EmptyState title="No lists." quoteIndex={3} />}
            
            {bottomTab === 'profile' && profileTab === 'watchlist' && (
              <>
                <div className="header-row" style={{ padding: '8px 16px', justifyContent: 'flex-end', gap: 8 }}>
                  <button className="header-btn"><Icon name="Copy" size={22} /></button>
                  <button className="header-btn" onClick={() => setShowFilters(true)}><Icon name="Filter" size={22} /></button>
                </div>
                <EmptyState title="No films." quoteIndex={3} />
              </>
            )}
          </div>
          
          {/* BOTTOM NAV */}
          <div className="bottom-nav">
            <button className={`nav-item ${bottomTab === 'home' ? 'active' : ''}`} onClick={() => setBottomTab('home')}><Icon name="Films" size={24} /></button>
            <button className={`nav-item ${bottomTab === 'search' ? 'active' : ''}`} onClick={() => setBottomTab('search')}><Icon name="Search" size={24} /></button>
            <div className="nav-add"><button className="nav-add-btn" onClick={() => setShowAddFilm(true)}><Icon name="Plus" size={24} /></button></div>
            <button className={`nav-item ${bottomTab === 'activity' ? 'active' : ''}`} onClick={() => setBottomTab('activity')}><Icon name="Activity" size={24} filled={bottomTab === 'activity'} /></button>
            <button className={`nav-item ${bottomTab === 'profile' ? 'active' : ''}`} onClick={() => setBottomTab('profile')}><Icon name="Profile" size={24} filled={bottomTab === 'profile'} /></button>
          </div>
          
          {/* ACTION SHEET */}
          {showActionSheet && selectedEpisode && (
            <>
              <div className="overlay" onClick={() => setShowActionSheet(false)} />
              <div className="bottom-sheet">
                <div className="sheet-handle" />
                <div className="action-sheet-content">
                  <div className="action-poster-section"><img src={selectedEpisode.poster} alt="" className="action-poster" /></div>
                  <div className="action-row">
                    <button className={`action-btn ${watched[selectedEpisode.id] ? 'active' : ''}`} onClick={() => setWatched(p => ({ ...p, [selectedEpisode.id]: !p[selectedEpisode.id] }))}>
                      <Icon name="Eye" size={32} filled={watched[selectedEpisode.id]} /><span className="action-label">Logged</span>
                    </button>
                    <button className={`action-btn ${liked[selectedEpisode.id] ? 'liked' : ''}`} onClick={() => setLiked(p => ({ ...p, [selectedEpisode.id]: !p[selectedEpisode.id] }))}>
                      <Icon name="Heart" size={32} filled={liked[selectedEpisode.id]} /><span className="action-label">Liked</span>
                    </button>
                    <button className="action-btn"><Icon name="Clock" size={32} filled /><span className="action-label">Watchlist</span></button>
                  </div>
                  <div className="action-divider" />
                  <div className="rating-section">
                    <div className="rating-label">Rated</div>
                    <StarRating rating={ratings[selectedEpisode.id] || 0} onChange={(r) => setRatings(p => ({ ...p, [selectedEpisode.id]: p[selectedEpisode.id] === r ? 0 : r }))} />
                  </div>
                  <div className="action-divider" />
                  <div className="menu-item">Review or log again</div>
                  <div className="menu-item">Add to a list</div>
                  <div className="menu-item" onClick={() => { setShowActionSheet(false); setShowChat(selectedEpisode); }}>💬 Episode Chat Room</div>
                  <div className="menu-item">Go to episode</div>
                  <div className="menu-item disabled">Share to Instagram Stories</div>
                </div>
              </div>
            </>
          )}
          
          {/* ADD FILM */}
          {showAddFilm && (
            <>
              <div className="overlay" onClick={() => setShowAddFilm(false)} />
              <div className="bottom-sheet">
                <div className="sheet-header">
                  <button className="sheet-cancel" onClick={() => setShowAddFilm(false)}>Cancel</button>
                  <span className="sheet-title">Add a Film</span>
                  <Avatar user={USERS.me} size="sm" />
                </div>
                <div style={{ padding: 16 }}>
                  <input type="text" placeholder="Name of film" style={{ width: '100%', background: '#F5F5F5', border: 'none', borderRadius: 8, padding: '14px 16px', fontSize: 16, color: '#1A1A1A', outline: 'none' }} autoFocus />
                </div>
              </div>
            </>
          )}
          
          {/* NEW LIST */}
          {showNewList && (
            <>
              <div className="overlay" onClick={() => setShowNewList(false)} />
              <div className="bottom-sheet">
                <div className="sheet-header">
                  <button className="sheet-cancel" onClick={() => setShowNewList(false)}>Cancel</button>
                  <span className="sheet-title">New List</span>
                  <button className="sheet-save" disabled>Save</button>
                </div>
                <div className="new-list-content">
                  <label className="form-label">LIST NAME</label>
                  <input type="text" className="form-input" placeholder="Add list name..." />
                  <input type="text" className="form-input" placeholder="Add description..." />
                  <div className="form-link">Add entries...</div>
                  <div className="form-tags">Add tags...</div>
                  <div className="list-options">
                    <div className="list-option"><Icon name="Globe" size={28} /><span>Public</span></div>
                    <div className="list-option"><Icon name="Trophy" size={28} /><span>Not ranked</span></div>
                    <div className="list-option"><Icon name="Comment" size={28} /><span>Anyone can reply</span></div>
                  </div>
                </div>
              </div>
            </>
          )}
          
          {/* LIST DETAIL - 4 column grid with numbers */}
          {showListDetail && (
            <>
              <div className="overlay" onClick={() => setShowListDetail(false)} />
              <div className="bottom-sheet" style={{ height: '85vh' }}>
                <div className="sheet-header">
                  <button className="sheet-cancel" onClick={() => setShowListDetail(false)}><Icon name="ChevronLeft" size={24} /></button>
                  <span className="sheet-title">List</span>
                  <button className="header-btn"><Icon name="MoreHorizontal" size={24} /></button>
                </div>
                <div style={{ padding: '16px' }}>
                  <div style={{ display: 'flex', alignItems: 'center', gap: 8, marginBottom: 12 }}>
                    <Avatar user={USERS.princess} size="sm" />
                    <span style={{ fontSize: 13 }}>Adrian Wills</span>
                    <Badge type="patron" />
                  </div>
                  <h2 style={{ fontSize: 20, fontWeight: 700, marginBottom: 8 }}>Official Top 250 Narrative Feature Films</h2>
                  <p style={{ fontSize: 14, color: 'var(--text-secondary)', lineHeight: 1.5 }}>Letterboxd's Top 250 movies, based on the average weighted rating of all Letterboxd users.</p>
                </div>
                <div className="list-grid-4">
                  {SHOWS.slice(0, 12).map((show, i) => (
                    <div key={show.id} className="list-grid-item">
                      <img src={show.poster} alt="" style={{ width: '100%', height: '100%', objectFit: 'cover' }} />
                      <div className="list-grid-number">{i + 1}</div>
                    </div>
                  ))}
                </div>
              </div>
            </>
          )}
          
          {/* FILTERS */}
          {showFilters && (
            <>
              <div className="overlay" onClick={() => setShowFilters(false)} />
              <div className="bottom-sheet">
                <div className="sheet-header">
                  <button className="sheet-cancel" onClick={() => setShowFilters(false)}>Cancel</button>
                  <span className="sheet-title">Filters</span>
                  <button className="sheet-save" onClick={() => setShowFilters(false)}>Done</button>
                </div>
                <div className="filters-content">
                  <div className="filter-row"><span className="filter-label">Sort by</span><span className="filter-value">Date added newest first <Icon name="ChevronRight" size={18} /></span></div>
                  <div className="filter-section-label">APPEARANCE</div>
                  <div className="filter-row"><span className="filter-label">Fade watched</span><div className={`toggle ${fadeWatched ? 'active' : ''}`} onClick={() => setFadeWatched(!fadeWatched)}><div className="toggle-knob" /></div></div>
                  <div className="filter-row"><span className="filter-label">Custom posters</span><span className="filter-value">Enabled <Icon name="ChevronRight" size={18} /></span></div>
                  <div className="filter-section-label">CONTENT</div>
                  {['Year', 'Genre', 'Country', 'Language', 'Service', 'Released', 'Length', 'Film/TV'].map(f => (
                    <div key={f} className="filter-row"><span className="filter-label">{f}</span><span className="filter-value">Any <Icon name="ChevronRight" size={18} /></span></div>
                  ))}
                  <div className="filter-section-label">ACCOUNT</div>
                  {['Watched', 'Liked', 'Rated', 'Logged'].map(f => (
                    <div key={f} className="filter-row"><span className="filter-label">{f}</span><span className="filter-value">Any</span></div>
                  ))}
                </div>
              </div>
            </>
          )}
          
          {/* CHAT ROOM */}
          {showChat && (
            <>
              <div className="overlay" onClick={() => setShowChat(null)} />
              <div className="bottom-sheet" style={{ height: '80vh' }}>
                <div className="sheet-header">
                  <button className="sheet-cancel" onClick={() => setShowChat(null)}><Icon name="ChevronLeft" size={24} /></button>
                  <div style={{ textAlign: 'center' }}><div className="sheet-title">{showChat.showName}</div><div style={{ fontSize: 12, color: 'var(--text-tertiary)' }}>S{showChat.season}E{showChat.episode} Discussion</div></div>
                  <button className="header-btn"><Icon name="MoreHorizontal" size={24} /></button>
                </div>
                <div className="chat-container">
                  <div className="chat-messages">
                    <div className="chat-message"><Avatar user={USERS.princess} /><div className="chat-bubble"><div className="chat-username">{USERS.princess.username}</div><div className="chat-text">OMG that ending though!! 😱</div><div className="chat-time">2m ago</div></div></div>
                    <div className="chat-message"><Avatar user={USERS.lobo} /><div className="chat-bubble"><div className="chat-username">{USERS.lobo.username}</div><div className="chat-text">I KNEW IT. Called it from episode 1</div><div className="chat-time">1m ago</div></div></div>
                    <div className="chat-message own"><div className="chat-bubble own"><div className="chat-text">Wait what?? No spoilers I'm still watching!</div><div className="chat-time">Just now</div></div></div>
                  </div>
                  <div className="chat-input-area"><input type="text" className="chat-input" placeholder="Type a message..." /><button className="chat-send"><Icon name="Send" size={18} /></button></div>
                </div>
              </div>
            </>
          )}
        </div>
      );
    }
    
    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(<App />);
  </script>
</body>
</html>
