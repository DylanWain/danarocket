<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="theme-color" content="#14181C">
  <title>Episodic - Track TV Episodes</title>
  
  <!-- Fonts: DM Serif Display for logo, system font for UI (like Letterboxd uses SF Pro) -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=DM+Serif+Display&display=swap" rel="stylesheet">
  
  <!-- React -->
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  
  <style>
    /* ============================================================================
       EPISODIC - PIXEL-PERFECT LETTERBOXD CLONE FOR TV EPISODES
       
       Color System: AUDIT-CORRECTED values
       Measurements: AUDIT-CORRECTED values  
       Typography: Matches Letterboxd iOS app exactly
       
       User Features Added:
       - Activity tabs: Friends / You / Incoming (like old Instagram)
       - Show-specific chat rooms
       - Sub-genre filtering (Reality/Drama/Comedy)
       ============================================================================ */
    
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      -webkit-tap-highlight-color: transparent;
    }
    
    :root {
      /* ========================================================================
         LETTERBOXD COLOR SYSTEM - AUDIT CORRECTED
         ======================================================================== */
      
      /* Background Hierarchy - AUDIT CORRECTED */
      --bg-primary: #14181C;           /* Main app background - CONFIRMED */
      --bg-tab-bar: #1A1F26;           /* Tab bar - CORRECTED from #0D1114 */
      --bg-elevated: #1C2228;          /* Slight elevation */
      --bg-card: #2C3440;              /* General cards, list items */
      --bg-action-sheet: #4A5968;      /* Action sheets - CORRECTED from #3D4752 */
      --bg-modal: #4B5867;             /* Modals - CORRECTED from #3D4752 */
      --bg-input: #3D4752;             /* Input field backgrounds */
      --bg-pill-active: #3D4A58;       /* Active tab pill - CORRECTED */
      
      /* Brand Colors - The Signature Letterboxd Trio */
      --brand-green: #00E054;          /* Watched state, success actions */
      --brand-orange: #FF8000;         /* Liked state, hearts */
      --brand-blue: #40BCF4;           /* Active tabs, links */
      
      /* Text Hierarchy - AUDIT CORRECTED */
      --text-primary: #FFFFFF;         /* Primary text, headings */
      --text-secondary: #8A98A8;       /* Body text - CORRECTED from #9AADBB */
      --text-tertiary: #6A7888;        /* Captions, chevrons - CORRECTED from #728394 */
      --text-muted: #566474;           /* Disabled, inactive */
      --text-placeholder: #8A98A8;     /* Input placeholders - CORRECTED */
      
      /* Semantic Colors */
      --divider: #384250;              /* Divider lines - CONFIRMED */
      --border-subtle: rgba(255,255,255,0.06);
      --border-medium: rgba(255,255,255,0.1);
      
      /* Badge Colors - AUDIT CORRECTED */
      --badge-crew: #6B7A8A;           /* CREW badge - CORRECTED from #5A6B7C */
      --badge-patron: #40A8D8;         /* PATRON badge - CORRECTED from #3BA0CC */
      --badge-live: #FF3B30;           /* Live indicator */
      
      /* Featured/Gold accent for lists */
      --gold-featured: #E8C547;
      
      /* Shadows */
      --shadow-poster: 0 4px 16px rgba(0,0,0,0.4);
      --shadow-card: 0 4px 12px rgba(0,0,0,0.3);
      --shadow-modal: 0 -8px 32px rgba(0,0,0,0.5);
      
      /* ========================================================================
         SPACING SYSTEM - 8px Grid
         ======================================================================== */
      --space-2: 2px;
      --space-4: 4px;
      --space-6: 6px;
      --space-8: 8px;
      --space-10: 10px;
      --space-12: 12px;
      --space-14: 14px;
      --space-16: 16px;
      --space-20: 20px;
      --space-24: 24px;
      --space-32: 32px;
      --space-40: 40px;
      --space-48: 48px;
      
      /* ========================================================================
         MEASUREMENTS - AUDIT CORRECTED
         ======================================================================== */
      
      /* Avatars */
      --avatar-xs: 28px;               /* Tiny (in compact lists) */
      --avatar-sm: 40px;               /* Small - CORRECTED from 32px */
      --avatar-md: 40px;               /* Medium (in reviews) - CORRECTED */
      --avatar-lg: 100px;              /* Large (profile) - CONFIRMED */
      
      /* Posters */
      --poster-grid-w: 85px;           /* Grid thumbnails - CORRECTED from 75px */
      --poster-grid-h: 127px;          /* 2:3 ratio - CORRECTED from 112px */
      --poster-list-w: 50px;           /* Horizontal scroll */
      --poster-list-h: 75px;
      --poster-review-w: 60px;         /* In review cards */
      --poster-review-h: 90px;
      --poster-diary-w: 48px;          /* In diary entries */
      --poster-diary-h: 72px;
      
      /* Heights */
      --row-height: 54px;              /* List rows - CORRECTED from 50px */
      --tab-bar-height: 44px;          /* Top tab bar - CONFIRMED */
      --bottom-nav-height: 56px;       /* Bottom navigation */
      
      /* Other */
      --notification-dot: 8px;         /* Orange dot - CONFIRMED */
      --touch-target: 44px;            /* Minimum touch target */
      
      /* ========================================================================
         BORDER RADIUS
         ======================================================================== */
      --radius-xs: 2px;
      --radius-sm: 4px;                /* Posters - CONFIRMED */
      --radius-md: 8px;                /* Cards, buttons */
      --radius-lg: 12px;               /* Larger cards */
      --radius-xl: 16px;               /* Modal top corners */
      --radius-full: 9999px;           /* Pills, avatars */
      
      /* ========================================================================
         TYPOGRAPHY
         ======================================================================== */
      
      /* Font Families */
      --font-display: 'DM Serif Display', Georgia, serif;
      --font-body: -apple-system, BlinkMacSystemFont, 'SF Pro Text', 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
      
      /* Type Scale */
      --text-xs: 11px;                 /* Badges, micro text */
      --text-sm: 13px;                 /* Captions, timestamps */
      --text-base: 15px;               /* Body text - CONFIRMED */
      --text-md: 16px;                 /* Slightly larger body */
      --text-lg: 17px;                 /* Section headers */
      --text-xl: 20px;                 /* Screen titles */
      --text-2xl: 24px;                /* Large titles, logo */
      --text-3xl: 28px;                /* Hero text */
      
      /* Letter Spacing */
      --tracking-tight: -0.02em;
      --tracking-normal: 0;
      --tracking-wide: 0.5px;
      --tracking-caps: 1.5px;          /* ALL CAPS labels */
      
      /* Line Heights */
      --leading-tight: 1.2;
      --leading-normal: 1.4;
      --leading-relaxed: 1.5;
      --leading-loose: 1.6;
      
      /* Z-Index Scale */
      --z-base: 0;
      --z-sticky: 50;
      --z-dropdown: 100;
      --z-overlay: 900;
      --z-modal: 1000;
      --z-toast: 2000;
    }
    
    /* ========================================================================
       BASE STYLES
       ======================================================================== */
    
    html, body {
      height: 100%;
      overflow: hidden;
    }
    
    body {
      font-family: var(--font-body);
      font-size: var(--text-base);
      line-height: var(--leading-normal);
      color: var(--text-primary);
      background: var(--bg-primary);
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }
    
    #root {
      height: 100%;
      display: flex;
      flex-direction: column;
    }
    
    /* Hide scrollbars but allow scrolling */
    ::-webkit-scrollbar { display: none; }
    * { scrollbar-width: none; }
    
    /* ========================================================================
       ANIMATIONS
       ======================================================================== */
    
    @keyframes slideUp {
      from { 
        opacity: 0; 
        transform: translateY(20px); 
      }
      to { 
        opacity: 1; 
        transform: translateY(0); 
      }
    }
    
    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }
    
    @keyframes slideInModal {
      from { transform: translateY(100%); }
      to { transform: translateY(0); }
    }
    
    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.5; }
    }
    
    @keyframes scaleIn {
      from { 
        opacity: 0; 
        transform: scale(0.95); 
      }
      to { 
        opacity: 1; 
        transform: scale(1); 
      }
    }
    
    @keyframes bounce {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.15); }
    }
    
    .animate-in {
      animation: slideUp 0.4s cubic-bezier(0.16, 1, 0.3, 1) forwards;
      opacity: 0;
    }
    
    .animate-fade {
      animation: fadeIn 0.3s ease-out forwards;
    }
    
    .animate-scale {
      animation: scaleIn 0.25s ease-out forwards;
    }
    
    .animate-bounce {
      animation: bounce 0.3s ease-out;
    }
    
    /* ========================================================================
       LAYOUT
       ======================================================================== */
    
    .app-container {
      display: flex;
      flex-direction: column;
      height: 100%;
      max-width: 430px;
      margin: 0 auto;
      background: var(--bg-primary);
      position: relative;
      overflow: hidden;
    }
    
    .main-content {
      flex: 1;
      overflow-y: auto;
      overflow-x: hidden;
      -webkit-overflow-scrolling: touch;
    }
    
    /* Desktop: Add shadow to simulate phone frame */
    @media (min-width: 768px) {
      .app-container {
        box-shadow: 0 0 80px rgba(0, 0, 0, 0.6);
      }
    }
    
    /* ========================================================================
       HEADER
       ======================================================================== */
    
    .header {
      background: var(--bg-primary);
      padding: var(--space-16) var(--space-16) var(--space-12);
      position: sticky;
      top: 0;
      z-index: var(--z-sticky);
    }
    
    .header-title {
      font-family: var(--font-display);
      font-size: var(--text-2xl);
      color: var(--text-primary);
      text-align: center;
      letter-spacing: var(--tracking-wide);
    }
    
    .header-row {
      display: flex;
      align-items: center;
      justify-content: space-between;
    }
    
    .header-action {
      width: var(--touch-target);
      height: var(--touch-target);
      display: flex;
      align-items: center;
      justify-content: center;
      background: none;
      border: none;
      color: var(--text-primary);
      cursor: pointer;
      border-radius: var(--radius-full);
      transition: background 0.2s;
    }
    
    .header-action:active {
      background: var(--bg-card);
    }
    
    /* ========================================================================
       TOP TAB BAR - 44px height per spec
       ======================================================================== */
    
    .top-tabs {
      display: flex;
      align-items: center;
      gap: var(--space-4);
      padding: var(--space-6) var(--space-16);
      background: var(--bg-tab-bar);
      height: var(--tab-bar-height);
      border-bottom: 1px solid var(--divider);
      overflow-x: auto;
    }
    
    .top-tab {
      padding: var(--space-8) var(--space-16);
      border-radius: var(--radius-md);
      font-size: var(--text-sm);
      font-weight: 500;
      color: var(--text-tertiary);
      background: transparent;
      border: none;
      cursor: pointer;
      white-space: nowrap;
      transition: all 0.2s ease;
      min-height: 32px;
    }
    
    .top-tab:active {
      transform: scale(0.96);
    }
    
    .top-tab.active {
      background: var(--bg-pill-active);
      color: var(--text-primary);
      font-weight: 600;
    }
    
    /* Orange notification dot - 8px per spec */
    .notification-dot {
      width: var(--notification-dot);
      height: var(--notification-dot);
      background: var(--brand-orange);
      border-radius: var(--radius-full);
      margin-left: auto;
      flex-shrink: 0;
    }
    
    /* ========================================================================
       SEGMENTED CONTROL (Activity: Friends/You/Incoming)
       This is the user's #1 requested feature - like old Instagram
       ======================================================================== */
    
    .segment-control {
      display: flex;
      background: var(--bg-tab-bar);
      border-radius: var(--radius-md);
      padding: var(--space-4);
      margin: var(--space-16);
    }
    
    .segment-btn {
      flex: 1;
      padding: var(--space-8) var(--space-12);
      border-radius: var(--space-6);
      font-size: var(--text-sm);
      font-weight: 500;
      color: var(--text-tertiary);
      background: transparent;
      border: none;
      cursor: pointer;
      transition: all 0.2s ease;
    }
    
    .segment-btn:active {
      transform: scale(0.96);
    }
    
    .segment-btn.active {
      background: var(--bg-pill-active);
      color: var(--text-primary);
      font-weight: 600;
    }
    
    /* ========================================================================
       SECTION HEADER
       ======================================================================== */
    
    .section-header {
      font-size: var(--text-lg);
      font-weight: 700;
      color: var(--text-primary);
      padding: var(--space-16);
      padding-bottom: var(--space-12);
    }
    
    .section-header-caps {
      font-size: var(--text-xs);
      font-weight: 600;
      color: var(--text-secondary);
      text-transform: uppercase;
      letter-spacing: var(--tracking-caps);
      padding: var(--space-8) var(--space-16);
      background: var(--bg-modal);
    }
    
    /* ========================================================================
       POSTER GRID - 3 columns, 2:3 aspect ratio
       ======================================================================== */
    
    .poster-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: var(--space-8);
      padding: 0 var(--space-16) var(--space-16);
    }
    
    .poster-item {
      aspect-ratio: 2/3;
      border-radius: var(--radius-sm);
      overflow: hidden;
      position: relative;
      cursor: pointer;
      box-shadow: var(--shadow-poster);
      transition: transform 0.2s ease;
    }
    
    .poster-item:active {
      transform: scale(0.96);
    }
    
    .poster-img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      background: var(--bg-card);
    }
    
    /* Rating badge on poster */
    .poster-badge {
      position: absolute;
      top: var(--space-4);
      right: var(--space-4);
      background: rgba(0, 0, 0, 0.8);
      backdrop-filter: blur(8px);
      -webkit-backdrop-filter: blur(8px);
      padding: var(--space-2) var(--space-6);
      border-radius: var(--radius-xs);
      font-size: 10px;
      font-weight: 700;
      color: var(--brand-green);
      display: flex;
      align-items: center;
      gap: 3px;
    }
    
    /* Watched indicator on poster */
    .poster-watched {
      position: absolute;
      bottom: var(--space-4);
      left: var(--space-4);
      width: 20px;
      height: 20px;
      background: var(--brand-green);
      border-radius: var(--radius-full);
      display: flex;
      align-items: center;
      justify-content: center;
      color: #000;
    }
    
    /* ========================================================================
       CARDS
       ======================================================================== */
    
    .card {
      background: var(--bg-card);
      border-radius: var(--radius-lg);
      padding: var(--space-16);
      margin: 0 var(--space-16) var(--space-12);
    }
    
    .card-interactive {
      cursor: pointer;
      transition: transform 0.2s ease, background 0.2s ease;
    }
    
    .card-interactive:active {
      transform: scale(0.98);
      background: var(--bg-modal);
    }
    
    /* ========================================================================
       REVIEW CARD - Letterboxd style
       ======================================================================== */
    
    .review-card {
      padding: var(--space-16);
      border-bottom: 1px solid var(--divider);
    }
    
    .review-card:last-child {
      border-bottom: none;
    }
    
    .review-header {
      display: flex;
      align-items: flex-start;
      gap: var(--space-12);
      margin-bottom: var(--space-12);
    }
    
    .review-poster {
      width: var(--poster-review-w);
      height: var(--poster-review-h);
      border-radius: var(--radius-sm);
      object-fit: cover;
      flex-shrink: 0;
    }
    
    .review-info {
      flex: 1;
      min-width: 0;
    }
    
    .review-title {
      font-size: var(--text-base);
      font-weight: 700;
      color: var(--text-primary);
      margin-bottom: var(--space-4);
    }
    
    .review-meta {
      display: flex;
      align-items: center;
      gap: var(--space-8);
      font-size: var(--text-sm);
      color: var(--text-tertiary);
      flex-wrap: wrap;
      margin-bottom: var(--space-8);
    }
    
    .review-user {
      display: flex;
      align-items: center;
      gap: var(--space-8);
      margin-bottom: var(--space-8);
    }
    
    .review-username {
      font-size: var(--text-sm);
      font-weight: 600;
      color: var(--text-primary);
    }
    
    .review-text {
      font-size: var(--text-sm);
      color: var(--text-secondary);
      line-height: var(--leading-relaxed);
    }
    
    /* ========================================================================
       STAR RATING - Green like Letterboxd
       ======================================================================== */
    
    .star-rating {
      display: inline-flex;
      align-items: center;
      gap: 1px;
      color: var(--brand-green);
    }
    
    .star-rating svg {
      width: 14px;
      height: 14px;
    }
    
    .star-rating-lg {
      gap: var(--space-4);
    }
    
    .star-rating-lg svg {
      width: 28px;
      height: 28px;
    }
    
    .star-rating-interactive svg {
      width: 32px;
      height: 32px;
      cursor: pointer;
      transition: transform 0.1s ease;
    }
    
    .star-rating-interactive svg:active {
      transform: scale(1.2);
    }
    
    /* ========================================================================
       AVATAR - CORRECTED to 40px for lists/activity
       ======================================================================== */
    
    .avatar {
      width: var(--avatar-sm);
      height: var(--avatar-sm);
      border-radius: var(--radius-full);
      background: linear-gradient(135deg, var(--brand-orange), var(--brand-green));
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: var(--text-sm);
      font-weight: 700;
      color: white;
      flex-shrink: 0;
      text-transform: uppercase;
    }
    
    .avatar-xs {
      width: var(--avatar-xs);
      height: var(--avatar-xs);
      font-size: 10px;
    }
    
    .avatar-lg {
      width: var(--avatar-lg);
      height: var(--avatar-lg);
      font-size: var(--text-3xl);
    }
    
    .avatar-img {
      width: 100%;
      height: 100%;
      border-radius: var(--radius-full);
      object-fit: cover;
    }
    
    /* ========================================================================
       BADGES - CORRECTED colors
       ======================================================================== */
    
    .badge {
      display: inline-flex;
      align-items: center;
      padding: var(--space-2) var(--space-6);
      border-radius: var(--radius-sm);
      font-size: var(--text-xs);
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: var(--tracking-wide);
    }
    
    .badge-crew {
      background: var(--badge-crew);
      color: white;
    }
    
    .badge-patron {
      background: var(--badge-patron);
      color: white;
    }
    
    .badge-live {
      background: rgba(255, 59, 48, 0.15);
      color: var(--badge-live);
      animation: pulse 2s infinite;
    }
    
    .badge-pro {
      background: var(--brand-green);
      color: #000;
    }
    
    /* ========================================================================
       SPOILER BLOCK - With mask/Darth Vader style icon
       ======================================================================== */
    
    .spoiler-block {
      background: var(--bg-modal);
      border-radius: var(--radius-md);
      padding: var(--space-16);
      display: flex;
      align-items: center;
      gap: var(--space-12);
      cursor: pointer;
      transition: background 0.2s ease;
    }
    
    .spoiler-block:active {
      background: var(--bg-input);
    }
    
    .spoiler-icon {
      width: 40px;
      height: 40px;
      color: var(--text-muted);
      flex-shrink: 0;
    }
    
    .spoiler-text {
      font-size: var(--text-sm);
      color: var(--text-tertiary);
    }
    
    /* ========================================================================
       LIST CARD
       ======================================================================== */
    
    .list-card {
      padding: var(--space-16);
      border-bottom: 1px solid var(--divider);
      cursor: pointer;
    }
    
    .list-card:active {
      background: var(--bg-elevated);
    }
    
    .list-header {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      margin-bottom: var(--space-8);
    }
    
    .list-title {
      font-size: var(--text-lg);
      font-weight: 700;
      color: var(--text-primary);
      flex: 1;
    }
    
    .list-title.featured {
      color: var(--gold-featured);
    }
    
    .list-desc {
      font-size: var(--text-sm);
      color: var(--text-secondary);
      line-height: var(--leading-relaxed);
      margin-bottom: var(--space-12);
    }
    
    .list-posters {
      display: flex;
      gap: var(--space-6);
      overflow-x: auto;
      padding-bottom: var(--space-4);
    }
    
    .list-poster {
      width: var(--poster-list-w);
      height: var(--poster-list-h);
      border-radius: var(--radius-sm);
      object-fit: cover;
      flex-shrink: 0;
    }
    
    .list-meta {
      display: flex;
      align-items: center;
      gap: var(--space-8);
      margin-top: var(--space-12);
      font-size: var(--text-xs);
      color: var(--text-tertiary);
    }
    
    /* ========================================================================
       JOURNAL/EDITORIAL CARD
       ======================================================================== */
    
    .journal-card {
      margin: 0 var(--space-16) var(--space-16);
      cursor: pointer;
    }
    
    .journal-card:active {
      opacity: 0.9;
    }
    
    .journal-img {
      width: 100%;
      height: 200px;
      border-radius: var(--radius-md);
      object-fit: cover;
      margin-bottom: var(--space-12);
    }
    
    .journal-title {
      font-size: var(--text-xl);
      font-weight: 700;
      color: var(--text-primary);
      margin-bottom: var(--space-8);
    }
    
    .journal-desc {
      font-size: var(--text-base);
      color: var(--text-secondary);
      line-height: var(--leading-relaxed);
    }
    
    .journal-desc em {
      font-style: italic;
    }
    
    /* ========================================================================
       ACTIVITY ITEM
       ======================================================================== */
    
    .activity-item {
      display: flex;
      gap: var(--space-12);
      padding: var(--space-16);
      border-bottom: 1px solid var(--divider);
      cursor: pointer;
    }
    
    .activity-item:active {
      background: var(--bg-elevated);
    }
    
    .activity-content {
      flex: 1;
      min-width: 0;
    }
    
    .activity-text {
      font-size: var(--text-sm);
      color: var(--text-secondary);
      line-height: var(--leading-normal);
    }
    
    .activity-text strong {
      color: var(--text-primary);
      font-weight: 600;
    }
    
    .activity-time {
      font-size: var(--text-xs);
      color: var(--text-muted);
      margin-top: var(--space-4);
    }
    
    .activity-posters {
      display: flex;
      gap: var(--space-4);
      margin-top: var(--space-8);
    }
    
    .activity-poster {
      width: 36px;
      height: 54px;
      border-radius: var(--radius-xs);
      object-fit: cover;
    }
    
    /* ========================================================================
       DIARY ENTRY - CORRECTED with bordered date box
       ======================================================================== */
    
    .diary-month {
      background: var(--bg-modal);
      padding: var(--space-8) var(--space-16);
      font-size: var(--text-xs);
      font-weight: 600;
      color: var(--text-secondary);
      text-transform: uppercase;
      letter-spacing: var(--tracking-caps);
    }
    
    .diary-entry {
      display: flex;
      gap: var(--space-12);
      padding: var(--space-12) var(--space-16);
      border-bottom: 1px solid var(--divider);
      cursor: pointer;
      min-height: 80px;
    }
    
    .diary-entry:active {
      background: var(--bg-elevated);
    }
    
    /* Date box with border (not filled) - per spec */
    .diary-date {
      width: 44px;
      height: 44px;
      border: 1.5px solid var(--text-muted);
      border-radius: var(--radius-sm);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: var(--text-xl);
      font-weight: 500;
      color: var(--text-primary);
      flex-shrink: 0;
      background: transparent;
    }
    
    .diary-poster {
      width: var(--poster-diary-w);
      height: var(--poster-diary-h);
      border-radius: var(--radius-sm);
      object-fit: cover;
      flex-shrink: 0;
    }
    
    .diary-info {
      flex: 1;
      min-width: 0;
      display: flex;
      flex-direction: column;
      justify-content: center;
    }
    
    .diary-title {
      font-size: var(--text-base);
      font-weight: 600;
      color: var(--text-primary);
      margin-bottom: var(--space-4);
    }
    
    .diary-meta {
      font-size: var(--text-sm);
      color: var(--text-tertiary);
      margin-bottom: var(--space-8);
    }
    
    .diary-actions {
      display: flex;
      align-items: center;
      gap: var(--space-12);
    }
    
    .diary-actions svg {
      color: var(--text-tertiary);
    }
    
    .diary-rewatch {
      color: var(--brand-green);
    }
    
    .diary-menu {
      margin-left: auto;
      color: var(--text-muted);
    }
    
    /* ========================================================================
       CHAT ROOM - User's key feature request
       ======================================================================== */
    
    .chat-room {
      display: flex;
      flex-direction: column;
      height: 100%;
    }
    
    .chat-header {
      background: var(--bg-tab-bar);
      padding: var(--space-16);
      border-bottom: 1px solid var(--divider);
    }
    
    .chat-header-info {
      text-align: center;
    }
    
    .chat-header-title {
      font-size: var(--text-md);
      font-weight: 600;
      color: var(--text-primary);
    }
    
    .chat-header-subtitle {
      font-size: var(--text-xs);
      color: var(--text-tertiary);
      margin-top: var(--space-2);
    }
    
    .chat-messages {
      flex: 1;
      overflow-y: auto;
      padding: var(--space-16);
    }
    
    .chat-message {
      display: flex;
      gap: var(--space-12);
      margin-bottom: var(--space-16);
    }
    
    .chat-message.own {
      flex-direction: row-reverse;
    }
    
    .chat-bubble {
      background: var(--bg-card);
      padding: var(--space-12);
      border-radius: var(--radius-md);
      border-top-left-radius: var(--radius-sm);
      max-width: 80%;
    }
    
    .chat-bubble.own {
      background: var(--brand-green);
      color: #000;
      border-top-left-radius: var(--radius-md);
      border-top-right-radius: var(--radius-sm);
    }
    
    .chat-bubble-username {
      font-size: var(--text-xs);
      font-weight: 600;
      margin-bottom: var(--space-4);
    }
    
    .chat-bubble-text {
      font-size: var(--text-sm);
      line-height: var(--leading-normal);
    }
    
    .chat-bubble-time {
      font-size: 10px;
      opacity: 0.7;
      margin-top: var(--space-4);
    }
    
    .chat-input-area {
      display: flex;
      gap: var(--space-12);
      padding: var(--space-16);
      background: var(--bg-tab-bar);
      border-top: 1px solid var(--divider);
    }
    
    .chat-input {
      flex: 1;
      background: var(--bg-card);
      border: none;
      border-radius: var(--radius-full);
      padding: var(--space-12) var(--space-16);
      font-size: var(--text-base);
      color: var(--text-primary);
      outline: none;
    }
    
    .chat-input::placeholder {
      color: var(--text-placeholder);
    }
    
    .chat-send {
      width: var(--touch-target);
      height: var(--touch-target);
      border-radius: var(--radius-full);
      background: var(--brand-green);
      border: none;
      color: #000;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: transform 0.2s ease;
    }
    
    .chat-send:active {
      transform: scale(0.9);
    }
    
    .chat-send:disabled {
      background: var(--bg-modal);
      color: var(--text-muted);
    }
    
    /* ========================================================================
       PROFILE STATS
       ======================================================================== */
    
    .profile-header {
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: var(--space-24) var(--space-16);
    }
    
    .profile-stats {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: var(--space-16);
      padding: var(--space-24) var(--space-16);
      border-bottom: 1px solid var(--divider);
    }
    
    .stat-item {
      text-align: center;
      cursor: pointer;
    }
    
    .stat-item:active {
      opacity: 0.7;
    }
    
    .stat-value {
      font-size: var(--text-2xl);
      font-weight: 700;
      color: var(--brand-green);
      margin-bottom: var(--space-4);
    }
    
    .stat-label {
      font-size: var(--text-xs);
      font-weight: 600;
      color: var(--text-tertiary);
      text-transform: uppercase;
      letter-spacing: var(--tracking-wide);
    }
    
    /* ========================================================================
       PROFILE ROW - CORRECTED to 54px height
       ======================================================================== */
    
    .profile-row {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 0 var(--space-16);
      height: var(--row-height);
      border-bottom: 1px solid var(--divider);
      cursor: pointer;
    }
    
    .profile-row:active {
      background: var(--bg-elevated);
    }
    
    .profile-row-label {
      font-size: var(--text-base);
      color: var(--text-primary);
    }
    
    .profile-row-value {
      font-size: var(--text-base);
      color: var(--text-tertiary);
      display: flex;
      align-items: center;
      gap: var(--space-8);
    }
    
    .profile-section-label {
      padding: var(--space-12) var(--space-16);
      font-size: var(--text-xs);
      font-weight: 600;
      color: var(--text-tertiary);
      text-transform: uppercase;
      letter-spacing: var(--tracking-caps);
      text-align: center;
    }
    
    /* ========================================================================
       EMPTY STATE - With movie quotes
       ======================================================================== */
    
    .empty-state {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: var(--space-48);
      text-align: center;
      min-height: 300px;
    }
    
    .empty-icon {
      width: 64px;
      height: 64px;
      color: var(--text-muted);
      margin-bottom: var(--space-16);
      opacity: 0.5;
    }
    
    .empty-title {
      font-size: var(--text-xl);
      font-weight: 600;
      color: var(--text-muted);
      margin-bottom: var(--space-8);
    }
    
    .empty-quote {
      font-size: var(--text-sm);
      color: var(--text-muted);
      font-style: italic;
      opacity: 0.7;
      max-width: 280px;
      line-height: var(--leading-relaxed);
    }
    
    /* ========================================================================
       BOTTOM NAVIGATION
       ======================================================================== */
    
    .bottom-nav {
      display: flex;
      background: var(--bg-tab-bar);
      border-top: 1px solid var(--divider);
      padding: var(--space-8) 0;
      padding-bottom: calc(var(--space-8) + env(safe-area-inset-bottom));
    }
    
    .nav-item {
      flex: 1;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: var(--space-4);
      padding: var(--space-8);
      background: none;
      border: none;
      cursor: pointer;
      color: var(--text-tertiary);
      transition: color 0.2s ease;
    }
    
    .nav-item:active {
      opacity: 0.7;
    }
    
    .nav-item.active {
      color: var(--brand-blue);
    }
    
    .nav-item svg {
      width: 24px;
      height: 24px;
    }
    
    .nav-label {
      font-size: 10px;
      font-weight: 500;
    }
    
    /* Center add button with green ring */
    .nav-add {
      flex: 1;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    
    .nav-add-btn {
      width: var(--touch-target);
      height: var(--touch-target);
      border-radius: var(--radius-full);
      border: 2px solid var(--brand-green);
      background: transparent;
      color: var(--brand-green);
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.2s ease;
    }
    
    .nav-add-btn:active {
      background: var(--brand-green);
      color: #000;
      transform: scale(0.9);
    }
    
    /* ========================================================================
       MODAL / BOTTOM SHEET
       ======================================================================== */
    
    .overlay {
      position: fixed;
      inset: 0;
      background: rgba(0, 0, 0, 0.6);
      z-index: var(--z-overlay);
      animation: fadeIn 0.2s ease-out;
    }
    
    .bottom-sheet {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      max-width: 430px;
      margin: 0 auto;
      background: var(--bg-action-sheet);
      border-radius: var(--radius-xl) var(--radius-xl) 0 0;
      z-index: var(--z-modal);
      max-height: 90vh;
      overflow-y: auto;
      animation: slideInModal 0.3s cubic-bezier(0.16, 1, 0.3, 1);
    }
    
    .sheet-handle {
      width: 36px;
      height: 4px;
      background: var(--text-muted);
      border-radius: var(--radius-full);
      margin: var(--space-12) auto;
    }
    
    .sheet-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: var(--space-12) var(--space-16);
      border-bottom: 1px solid var(--divider);
    }
    
    .sheet-cancel {
      font-size: var(--text-base);
      color: var(--text-secondary);
      background: none;
      border: none;
      cursor: pointer;
      padding: var(--space-8);
      margin: calc(-1 * var(--space-8));
    }
    
    .sheet-title {
      font-size: var(--text-lg);
      font-weight: 600;
      color: var(--text-primary);
    }
    
    .sheet-action {
      font-size: var(--text-base);
      font-weight: 600;
      color: var(--brand-green);
      background: none;
      border: none;
      cursor: pointer;
      padding: var(--space-8);
      margin: calc(-1 * var(--space-8));
    }
    
    .sheet-action:disabled {
      color: var(--text-muted);
    }
    
    /* ========================================================================
       ACTION SHEET - Letterboxd style (Logged/Liked/Watchlist)
       ======================================================================== */
    
    .action-sheet {
      padding: var(--space-20) var(--space-24);
    }
    
    .action-row {
      display: flex;
      justify-content: space-around;
      margin-bottom: var(--space-20);
    }
    
    .action-btn {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: var(--space-8);
      background: none;
      border: none;
      cursor: pointer;
      color: var(--text-secondary);
      padding: var(--space-8);
      transition: transform 0.2s ease;
    }
    
    .action-btn:active {
      transform: scale(0.9);
    }
    
    .action-btn.active {
      color: var(--brand-green);
    }
    
    .action-btn.liked {
      color: var(--brand-orange);
    }
    
    .action-btn svg {
      width: 32px;
      height: 32px;
    }
    
    .action-label {
      font-size: var(--text-sm);
      color: var(--text-primary);
      font-weight: 500;
    }
    
    .action-divider {
      height: 1px;
      background: var(--divider);
      margin: var(--space-16) 0;
    }
    
    .rating-section {
      text-align: center;
      margin-bottom: var(--space-20);
    }
    
    .rating-label {
      font-size: var(--text-sm);
      color: var(--text-secondary);
      margin-bottom: var(--space-12);
    }
    
    .rating-stars {
      display: flex;
      justify-content: center;
      gap: var(--space-8);
    }
    
    .rating-star {
      background: none;
      border: none;
      padding: var(--space-4);
      cursor: pointer;
      color: var(--text-tertiary);
      transition: transform 0.1s ease, color 0.2s ease;
    }
    
    .rating-star:active {
      transform: scale(1.2);
    }
    
    .rating-star.active {
      color: var(--brand-green);
    }
    
    .rating-star svg {
      width: 32px;
      height: 32px;
    }
    
    .menu-item {
      padding: var(--space-14) 0;
      text-align: center;
      color: var(--text-secondary);
      font-size: var(--text-md);
      border-bottom: 1px solid var(--divider);
      cursor: pointer;
      transition: background 0.2s ease;
    }
    
    .menu-item:active {
      background: var(--bg-input);
    }
    
    .menu-item:last-child {
      border-bottom: none;
    }
    
    .menu-item.disabled {
      color: var(--text-muted);
    }
    
    /* ========================================================================
       BUTTONS
       ======================================================================== */
    
    .btn {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: var(--space-8);
      padding: var(--space-12) var(--space-20);
      border-radius: var(--radius-md);
      font-size: var(--text-base);
      font-weight: 600;
      border: none;
      cursor: pointer;
      transition: all 0.2s ease;
    }
    
    .btn:active {
      transform: scale(0.96);
    }
    
    .btn-primary {
      background: var(--brand-green);
      color: #000;
    }
    
    .btn-primary:active {
      background: #00C94A;
    }
    
    .btn-secondary {
      background: var(--bg-modal);
      color: var(--text-primary);
    }
    
    .btn-ghost {
      background: transparent;
      color: var(--text-secondary);
    }
    
    .btn-outline {
      background: transparent;
      border: 1px solid var(--divider);
      color: var(--text-secondary);
    }
    
    .btn-full {
      width: 100%;
    }
    
    /* ========================================================================
       INPUTS
       ======================================================================== */
    
    .input-field {
      width: 100%;
      background: var(--bg-input);
      border: none;
      border-radius: var(--radius-md);
      padding: var(--space-12) var(--space-16);
      font-size: var(--text-base);
      color: var(--text-primary);
      outline: none;
      transition: background 0.2s ease;
    }
    
    .input-field:focus {
      background: var(--bg-modal);
    }
    
    .input-field::placeholder {
      color: var(--text-placeholder);
    }
    
    /* Light input for modals (per spec) */
    .input-light {
      background: #F5F5F5;
      color: #1A1A1A;
    }
    
    .input-light:focus {
      background: #EAEAEA;
    }
    
    .input-light::placeholder {
      color: #8E8E93;
    }
    
    /* ========================================================================
       SEARCH BAR
       ======================================================================== */
    
    .search-bar {
      display: flex;
      align-items: center;
      gap: var(--space-8);
      background: var(--bg-card);
      border-radius: var(--radius-md);
      padding: 0 var(--space-12);
      margin: 0 var(--space-16) var(--space-16);
      height: 40px;
    }
    
    .search-bar svg {
      color: var(--text-placeholder);
      flex-shrink: 0;
      width: 18px;
      height: 18px;
    }
    
    .search-bar input {
      flex: 1;
      background: none;
      border: none;
      font-size: var(--text-md);
      color: var(--text-primary);
      outline: none;
    }
    
    .search-bar input::placeholder {
      color: var(--text-placeholder);
    }
    
    /* ========================================================================
       GENRE PILLS - Sub-genre filtering (User request)
       ======================================================================== */
    
    .genre-pills {
      display: flex;
      gap: var(--space-8);
      padding: var(--space-12) var(--space-16);
      overflow-x: auto;
    }
    
    .genre-pill {
      padding: var(--space-8) var(--space-16);
      border-radius: var(--radius-full);
      font-size: var(--text-sm);
      font-weight: 500;
      white-space: nowrap;
      cursor: pointer;
      transition: all 0.2s ease;
      background: var(--bg-card);
      color: var(--text-secondary);
      border: none;
    }
    
    .genre-pill:active {
      transform: scale(0.95);
    }
    
    .genre-pill.active {
      background: var(--brand-green);
      color: #000;
    }
    
    /* ========================================================================
       SHOW HEADER (Detail page)
       ======================================================================== */
    
    .show-header {
      position: relative;
      height: 280px;
      overflow: hidden;
    }
    
    .show-backdrop {
      position: absolute;
      inset: 0;
      object-fit: cover;
      width: 100%;
      height: 100%;
    }
    
    .show-backdrop-overlay {
      position: absolute;
      inset: 0;
      background: linear-gradient(
        to bottom,
        rgba(20, 24, 28, 0) 0%,
        rgba(20, 24, 28, 0.4) 50%,
        rgba(20, 24, 28, 1) 100%
      );
    }
    
    .show-back-btn {
      position: absolute;
      top: var(--space-16);
      left: var(--space-8);
      width: var(--touch-target);
      height: var(--touch-target);
      background: rgba(0, 0, 0, 0.5);
      backdrop-filter: blur(8px);
      -webkit-backdrop-filter: blur(8px);
      border: none;
      border-radius: var(--radius-full);
      color: var(--text-primary);
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    
    .show-info {
      position: absolute;
      bottom: var(--space-16);
      left: var(--space-16);
      right: var(--space-16);
    }
    
    .show-title {
      font-size: var(--text-2xl);
      font-weight: 700;
      color: var(--text-primary);
      margin-bottom: var(--space-8);
      text-shadow: 0 2px 8px rgba(0, 0, 0, 0.5);
    }
    
    .show-meta {
      display: flex;
      align-items: center;
      gap: var(--space-12);
      font-size: var(--text-sm);
      color: var(--text-secondary);
    }
    
    .show-rating {
      display: flex;
      align-items: center;
      gap: var(--space-4);
      color: var(--brand-green);
      font-weight: 600;
    }
    
    /* ========================================================================
       TOAST NOTIFICATION
       ======================================================================== */
    
    .toast {
      position: fixed;
      bottom: 100px;
      left: var(--space-16);
      right: var(--space-16);
      max-width: 400px;
      margin: 0 auto;
      background: var(--bg-card);
      border: 1px solid var(--divider);
      padding: var(--space-16);
      border-radius: var(--radius-lg);
      box-shadow: var(--shadow-modal);
      z-index: var(--z-toast);
      animation: slideUp 0.3s cubic-bezier(0.16, 1, 0.3, 1);
    }
    
    .toast-content {
      display: flex;
      align-items: center;
      gap: var(--space-12);
    }
    
    .toast-icon {
      color: var(--brand-green);
    }
    
    .toast-text {
      font-size: var(--text-base);
      font-weight: 600;
      color: var(--text-primary);
    }
    
    /* ========================================================================
       UTILITIES
       ======================================================================== */
    
    .truncate {
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }
    
    .line-clamp-2 {
      display: -webkit-box;
      -webkit-line-clamp: 2;
      -webkit-box-orient: vertical;
      overflow: hidden;
    }
    
    .line-clamp-3 {
      display: -webkit-box;
      -webkit-line-clamp: 3;
      -webkit-box-orient: vertical;
      overflow: hidden;
    }
    
    .sr-only {
      position: absolute;
      width: 1px;
      height: 1px;
      padding: 0;
      margin: -1px;
      overflow: hidden;
      clip: rect(0, 0, 0, 0);
      white-space: nowrap;
      border: 0;
    }
  </style>
</head>
<body>
  <div id="root"></div>
  
  <script type="text/babel">
    const { useState, useMemo, useCallback, useEffect, useRef } = React;

    // ============================================================================
    // DATA LAYER
    // ============================================================================
    
    // TV Shows - Mix of Reality, Comedy, and Drama for sub-genre filtering
    const SHOWS = [
      // Reality TV (User's primary interest)
      { id: 1, name: 'Love Island', year: '2024', genre: 'Reality', subgenre: 'Dating', poster: 'https://image.tmdb.org/t/p/w500/h9f3vNGZGDRqOw26uwDMYhSLZ01.jpg', backdrop: 'https://image.tmdb.org/t/p/w1280/rCqYXh6ztQLpC1BKW3KF0v3DXNP.jpg', rating: 7.2, trending: true },
      { id: 2, name: 'The Bachelor', year: '2024', genre: 'Reality', subgenre: 'Dating', poster: 'https://image.tmdb.org/t/p/w500/mKadW8gXqVdg01IJYkMHNrzoZ3a.jpg', backdrop: 'https://image.tmdb.org/t/p/w1280/jKOuF93E4sjkCYKYMxcjHNKcMXJ.jpg', rating: 6.8, trending: true },
      { id: 3, name: 'Survivor', year: '2024', genre: 'Reality', subgenre: 'Competition', poster: 'https://image.tmdb.org/t/p/w500/ddYkNcvJJ1FJFy3SaZfqTXExkPc.jpg', backdrop: 'https://image.tmdb.org/t/p/w1280/zcMz1BKuP6kZlOsF3Ckd4EAF2jg.jpg', rating: 7.6, trending: true },
      { id: 4, name: 'The Traitors', year: '2024', genre: 'Reality', subgenre: 'Competition', poster: 'https://image.tmdb.org/t/p/w500/7FN2nmpApXjLjQJKmJBLqZF91pz.jpg', backdrop: 'https://image.tmdb.org/t/p/w1280/qWBLjHB2xFWt2EwFRLxQRpJYXmh.jpg', rating: 8.1, trending: true },
      { id: 5, name: 'Real Housewives', year: '2024', genre: 'Reality', subgenre: 'Lifestyle', poster: 'https://image.tmdb.org/t/p/w500/jCWYWV0TquevYfiJ6pJkGq3Qzhe.jpg', backdrop: 'https://image.tmdb.org/t/p/w1280/1TS0T3WEH9bJWCBYV3DykNqhXTi.jpg', rating: 7.5, trending: false },
      { id: 6, name: 'Love Is Blind', year: '2024', genre: 'Reality', subgenre: 'Dating', poster: 'https://image.tmdb.org/t/p/w500/bHKgb4ShQ8AsCPFe3K4HQC64aKP.jpg', backdrop: 'https://image.tmdb.org/t/p/w1280/wZeOsJBOxWa3WE87tTxuDQEOKc0.jpg', rating: 6.3, trending: true },
      { id: 7, name: 'The Circle', year: '2024', genre: 'Reality', subgenre: 'Competition', poster: 'https://image.tmdb.org/t/p/w500/iLfxuPBWgDg5556UsmREzA9cNiA.jpg', backdrop: 'https://image.tmdb.org/t/p/w1280/9gBEXNqZggRbjHM8c4HjPxUyPd0.jpg', rating: 7.0, trending: false },
      
      // Comedy
      { id: 11, name: 'Saturday Night Live', year: '2024', genre: 'Comedy', subgenre: 'Sketch', poster: 'https://image.tmdb.org/t/p/w500/sHGuKFjIBisPk8cvtCZTDVktYfs.jpg', backdrop: 'https://image.tmdb.org/t/p/w1280/iM8kss04YCaGPXJqBkS4rHZbJTW.jpg', rating: 7.1, trending: true },
      { id: 12, name: 'Abbott Elementary', year: '2024', genre: 'Comedy', subgenre: 'Sitcom', poster: 'https://image.tmdb.org/t/p/w500/fLZJHG8gXF0H1fCYd6cCMKDMkQD.jpg', backdrop: 'https://image.tmdb.org/t/p/w1280/fKGZu5UrLVhXZdmjKMgADPHF2u6.jpg', rating: 8.1, trending: true },
      { id: 13, name: 'What We Do In Shadows', year: '2024', genre: 'Comedy', subgenre: 'Mockumentary', poster: 'https://image.tmdb.org/t/p/w500/chckIPxBbvyFCcCFz5NJwPAkawf.jpg', backdrop: 'https://image.tmdb.org/t/p/w1280/z7D9TxCyBmwuJJqLJF1bW4BtxN2.jpg', rating: 8.6, trending: false },
      { id: 14, name: 'Hacks', year: '2024', genre: 'Comedy', subgenre: 'Dramedy', poster: 'https://image.tmdb.org/t/p/w500/pxb3FLLpJKU6rAcP0nQmTY2L95p.jpg', backdrop: 'https://image.tmdb.org/t/p/w1280/vLe8bM8XCafSBuZ7Q1q2w1UqJ1H.jpg', rating: 8.3, trending: true },
      
      // Drama
      { id: 21, name: 'The Last of Us', year: '2024', genre: 'Drama', subgenre: 'Post-Apocalyptic', poster: 'https://image.tmdb.org/t/p/w500/uKvVjHNqB5VmOrdxqAt2F7J78ED.jpg', backdrop: 'https://image.tmdb.org/t/p/w1280/uDgy6hyPd82kOHh6I95FLtLnj6p.jpg', rating: 8.8, trending: true },
      { id: 22, name: 'The Bear', year: '2024', genre: 'Drama', subgenre: 'Culinary', poster: 'https://image.tmdb.org/t/p/w500/zMpJY5CizTJfH8njYsYk87S9eHf.jpg', backdrop: 'https://image.tmdb.org/t/p/w1280/9z3CCXR7UsCWqmGXVj5aJP0Tc6p.jpg', rating: 8.6, trending: true },
      { id: 23, name: 'Severance', year: '2024', genre: 'Drama', subgenre: 'Thriller', poster: 'https://image.tmdb.org/t/p/w500/lFqJzi7XFuzp3cp6rFxPYL5Frdm.jpg', backdrop: 'https://image.tmdb.org/t/p/w1280/8TJFM24JOaZSdqJqmMlpFcuqSTz.jpg', rating: 8.7, trending: true },
      { id: 24, name: 'House of the Dragon', year: '2024', genre: 'Drama', subgenre: 'Fantasy', poster: 'https://image.tmdb.org/t/p/w500/7QMsOTMUswlwxJP0rTTZfmz2tX2.jpg', backdrop: 'https://image.tmdb.org/t/p/w1280/7BAHB0R2pUYBLPF0aCFoMZnXAcv.jpg', rating: 8.4, trending: true },
      { id: 25, name: 'Yellowstone', year: '2024', genre: 'Drama', subgenre: 'Western', poster: 'https://image.tmdb.org/t/p/w500/peNC0PAVqt91mfoP7MdXMqcGiyK.jpg', backdrop: 'https://image.tmdb.org/t/p/w1280/uwjaCH7PzmOvKFO17lbXS6ikHkO.jpg', rating: 8.7, trending: false },
      { id: 26, name: 'The White Lotus', year: '2024', genre: 'Drama', subgenre: 'Anthology', poster: 'https://image.tmdb.org/t/p/w500/gH5i3JbnLsyTvcImlofNvXtH3i5.jpg', backdrop: 'https://image.tmdb.org/t/p/w1280/qoPjww6vRWd8PGWm4c7D1J8zXsH.jpg', rating: 7.9, trending: true },
      { id: 27, name: 'Succession', year: '2023', genre: 'Drama', subgenre: 'Business', poster: 'https://image.tmdb.org/t/p/w500/7HW47XbkNQ5fiwQFYGWdw9gs144.jpg', backdrop: 'https://image.tmdb.org/t/p/w1280/slZh6x2K8rXS25dHWBxXGY2eZoL.jpg', rating: 8.9, trending: false }
    ];

    // Generate episodes for each show
    const EPISODES = [];
    let episodeId = 1;
    
    SHOWS.forEach(show => {
      const episodeCount = show.genre === 'Reality' ? 12 : 8;
      for (let i = 1; i <= episodeCount; i++) {
        EPISODES.push({
          id: episodeId++,
          showId: show.id,
          season: 1,
          episode: i,
          name: `Episode ${i}`,
          airDate: `Jan ${i + 5}, 2024`,
          runtime: show.genre === 'Reality' ? 45 : 55,
          rating: (6.5 + Math.random() * 3).toFixed(1),
          image: show.poster,
          description: `${show.name} Season 1 Episode ${i}. The stakes are higher than ever as new challenges emerge.`
        });
      }
    });

    // Users
    const USERS = {
      current: { 
        id: '1', 
        username: 'tvlover', 
        name: 'TV Lover', 
        avatar: null,
        bio: 'Reality TV enthusiast. The Bachelor is a lifestyle.',
        following: 127,
        followers: 89
      },
      ari: { id: '2', username: 'ari', name: 'Ari', avatar: null, badge: null },
      princesslucas: { id: '3', username: 'PrincessLucas', name: 'Princess Lucas', avatar: null, badge: 'patron' },
      lobotomommy: { id: '4', username: 'lobotomommy', name: 'Lobotomommy', avatar: null, badge: 'crew' },
      drewcowen: { id: '5', username: 'Drew Cowen', name: 'Drew', avatar: null, badge: null },
      bryanhowell: { id: '6', username: 'Bryan Howell', name: 'Bryan', avatar: null, badge: null },
      realityfan: { id: '7', username: 'realityfan', name: 'Reality Fan', avatar: null, badge: null },
      dramastan: { id: '8', username: 'dramastan', name: 'Drama Stan', avatar: null, badge: 'patron' }
    };

    // Reviews with real-looking content
    const REVIEWS = [
      { 
        id: 1, 
        userId: '7', 
        showId: 1, 
        episodeId: 5, 
        rating: 4.5, 
        content: "This bombshell entrance was EVERYTHING. The villa is in absolute chaos and I am here for it. Best episode of the season so far! Joey is playing the long game and everyone can see it except the other islanders.", 
        hasSpoilers: false, 
        watchedDate: 'Jan 21, 2024',
        likes: 45,
        comments: 12
      },
      { 
        id: 2, 
        userId: '8', 
        showId: 21, 
        episodeId: 85, 
        rating: 5, 
        content: "The Last of Us continues to deliver emotionally devastating television. This episode had me in tears multiple times. Pedro Pascal deserves every award imaginable for this performance.", 
        hasSpoilers: true, 
        watchedDate: 'Jan 20, 2024',
        likes: 89,
        comments: 23
      },
      { 
        id: 3, 
        userId: '4', 
        showId: 11, 
        episodeId: 65, 
        rating: 4, 
        content: "SNL back in form! The cold open was brilliant political satire and Weekend Update absolutely killed it. The host was surprisingly good at sketch comedy.", 
        hasSpoilers: false, 
        watchedDate: 'Jan 19, 2024',
        likes: 34,
        comments: 8
      },
      { 
        id: 4, 
        userId: '7', 
        showId: 22, 
        episodeId: 95, 
        rating: 5, 
        content: "The Bear is the most stressful show on television and I cannot stop watching. The one-take episode was a masterclass in directing and tension building.", 
        hasSpoilers: false, 
        watchedDate: 'Jan 18, 2024',
        likes: 67,
        comments: 15
      },
      { 
        id: 5, 
        userId: '3', 
        showId: 4, 
        episodeId: 25, 
        rating: 5, 
        content: "THE TRAITORS IS PEAK TELEVISION. I literally cannot trust anyone anymore, not even myself. Alan Cumming is perfection as the host. The murder scenes are *chef's kiss*.", 
        hasSpoilers: true, 
        watchedDate: 'Jan 17, 2024',
        likes: 156,
        comments: 42
      }
    ];

    // Activity data styled like Letterboxd's activity feed
    const FRIEND_ACTIVITY = [
      { id: 1, userId: '2', type: 'liked', targetUser: 'PrincessLucas', rating: 4.5, showName: 'Eternity', time: Date.now() - 3 * 60000 },
      { id: 2, userId: '2', type: 'liked', targetUser: 'lobotomommy', rating: 4.5, showName: 'Cecil B. Demented', time: Date.now() - 3 * 60000 },
      { id: 3, userId: '2', type: 'liked', targetUser: 'Drew Cowen', showName: 'Chasing Time', time: Date.now() - 3 * 60000 },
      { id: 4, userId: '6', type: 'followed', targetUser: 'Bryan Howell', time: Date.now() - 21 * 60000 },
      { id: 5, userId: '6', type: 'liked', targetUser: 'Bryan Howell', rating: 2.5, showName: 'Shelby Oaks', time: Date.now() - 21 * 60000 },
      { id: 6, userId: '6', type: 'liked', targetUser: 'Bryan Howell', rating: 4.5, showName: 'Superman', time: Date.now() - 21 * 60000 },
      { id: 7, userId: '7', type: 'added', showName: 'One Night in Miami...', listType: 'watchlist', time: Date.now() - 2 * 3600000 },
      { id: 8, userId: '8', type: 'reviewed', showName: 'The Last of Us', episodeName: 'S1E3', rating: 5, time: Date.now() - 3 * 3600000 },
      { id: 9, userId: '3', type: 'list', listName: 'Best Reality TV 2024', time: Date.now() - 5 * 3600000 }
    ];

    const YOUR_ACTIVITY = [
      { id: 1, type: 'like', fromUser: 'realityfan', content: 'liked your review of Love Island S1E5', time: Date.now() - 5 * 60000 },
      { id: 2, type: 'follow', fromUser: 'dramastan', content: 'started following you', time: Date.now() - 20 * 60000 },
      { id: 3, type: 'comment', fromUser: 'PrincessLucas', content: 'replied to your hot take about The Bachelor', time: Date.now() - 1 * 3600000 }
    ];

    const INCOMING_ACTIVITY = [
      { id: 1, type: 'mention', fromUser: 'realityfan', content: 'mentioned you in a comment on Love Island S1E7', time: Date.now() - 10 * 60000 },
      { id: 2, type: 'reply', fromUser: 'lobotomommy', content: 'replied to your hot take on The Traitors finale', time: Date.now() - 45 * 60000 }
    ];

    // Lists
    const LISTS = [
      { 
        id: 1, 
        userId: '7', 
        name: 'Best Reality TV Moments 2024', 
        description: 'The most jaw-dropping, meme-worthy, and iconic moments from reality TV this year. Updated weekly!',
        showIds: [1, 2, 4, 6],
        likes: 234,
        comments: 45,
        featured: true
      },
      { 
        id: 2, 
        userId: '8', 
        name: 'Prestige TV Hall of Fame', 
        description: 'Episodes that changed television forever. The gold standard.',
        showIds: [21, 22, 23, 27],
        likes: 567,
        comments: 89,
        featured: false
      },
      { 
        id: 3, 
        userId: '3', 
        name: 'Shows That Made Me Cry', 
        description: 'Bring tissues. You\'ve been warned.',
        showIds: [21, 26, 27],
        likes: 123,
        comments: 34,
        featured: false
      }
    ];

    // Chat messages for show-specific chat rooms (User's key feature)
    const CHAT_MESSAGES = {
      1: [ // Love Island chat
        { id: 1, oderId: '7', text: "OMG did you see that recoupling?!", time: Date.now() - 30 * 60000 },
        { id: 2, userId: '8', text: "I SCREAMED. Joey is playing everyone and they don't even see it", time: Date.now() - 28 * 60000 },
        { id: 3, userId: '3', text: "The producers are working OVERTIME this season", time: Date.now() - 25 * 60000 },
        { id: 4, userId: '7', text: "Grace deserves so much better honestly", time: Date.now() - 20 * 60000 },
        { id: 5, userId: '4', text: "This is giving season 2 vibes and I'm HERE for it", time: Date.now() - 15 * 60000 },
        { id: 6, userId: '1', text: "Best season in years, no question", time: Date.now() - 10 * 60000 }
      ],
      4: [ // The Traitors chat
        { id: 1, userId: '3', text: "I don't trust ANYONE anymore", time: Date.now() - 2 * 3600000 },
        { id: 2, userId: '8', text: "The breakfast table scenes are so tense", time: Date.now() - 1.5 * 3600000 },
        { id: 3, userId: '7', text: "Alan Cumming is the perfect host", time: Date.now() - 1 * 3600000 }
      ],
      21: [ // The Last of Us chat
        { id: 1, userId: '8', text: "Episode 3 still makes me cry every time", time: Date.now() - 3 * 3600000 },
        { id: 2, userId: '3', text: "Pedro Pascal IS Joel", time: Date.now() - 2 * 3600000 }
      ],
      22: [ // The Bear chat
        { id: 1, userId: '4', text: "My blood pressure can't take this show", time: Date.now() - 4 * 3600000 },
        { id: 2, userId: '7', text: "YES CHEF YES CHEF YES CHEF", time: Date.now() - 3 * 3600000 }
      ]
    };

    // Movie quotes for empty states (per Letterboxd spec)
    const MOVIE_QUOTES = [
      { quote: "Game over, man! It's game over!", source: "Aliens" },
      { quote: "He speaks a dozen languages, knows every local custom. He'll blend in, disappear, you'll never see him again.", source: "The Bourne Identity" },
      { quote: "Tyler's not here. Tyler went away. Tyler's gone.", source: "Fight Club" },
      { quote: "Nothing left but some damn rocks on the window sill. And that cupcake on the wall!", source: "Eternal Sunshine" }
    ];

    // ============================================================================
    // ICON COMPONENT - Complete SVG icon set
    // ============================================================================
    
    const Icon = ({ name, size = 24, filled = false, className = '' }) => {
      const icons = {
        // Navigation
        Film: filled 
          ? <svg width={size} height={size} viewBox="0 0 24 24" fill="currentColor"><path d="M18 4v1h-2V4c0-.55-.45-1-1-1H9c-.55 0-1 .45-1 1v1H6V4c0-.55-.45-1-1-1s-1 .45-1 1v16c0 .55.45 1 1 1s1-.45 1-1v-1h2v1c0 .55.45 1 1 1h6c.55 0 1-.45 1-1v-1h2v1c0 .55.45 1 1 1s1-.45 1-1V4c0-.55-.45-1-1-1s-1 .45-1 1zM8 17H6v-2h2v2zm0-4H6v-2h2v2zm0-4H6V7h2v2zm10 8h-2v-2h2v2zm0-4h-2v-2h2v2zm0-4h-2V7h2v2z"/></svg>
          : <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><rect x="2" y="2" width="20" height="20" rx="2.18" ry="2.18"/><line x1="7" y1="2" x2="7" y2="22"/><line x1="17" y1="2" x2="17" y2="22"/><line x1="2" y1="12" x2="22" y2="12"/><line x1="2" y1="7" x2="7" y2="7"/><line x1="2" y1="17" x2="7" y2="17"/><line x1="17" y1="17" x2="22" y2="17"/><line x1="17" y1="7" x2="22" y2="7"/></svg>,
        
        Search: <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="11" cy="11" r="8"/><path d="m21 21-4.35-4.35"/></svg>,
        
        Plus: <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg>,
        
        Activity: filled
          ? <svg width={size} height={size} viewBox="0 0 24 24" fill="currentColor"><path d="M13 2L3 14h9l-1 8 10-12h-9l1-8z"/></svg>
          : <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M13 2L3 14h9l-1 8 10-12h-9l1-8z"/></svg>,
        
        User: filled
          ? <svg width={size} height={size} viewBox="0 0 24 24" fill="currentColor"><path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/></svg>
          : <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>,
        
        // Actions
        Eye: filled
          ? <svg width={size} height={size} viewBox="0 0 24 24" fill="currentColor"><path d="M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5zM12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg>
          : <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/><circle cx="12" cy="12" r="3"/></svg>,
        
        Heart: filled
          ? <svg width={size} height={size} viewBox="0 0 24 24" fill="currentColor"><path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/></svg>
          : <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"/></svg>,
        
        Star: filled
          ? <svg width={size} height={size} viewBox="0 0 24 24" fill="currentColor"><path d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"/></svg>
          : <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg>,
        
        Clock: <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>,
        
        Bookmark: filled
          ? <svg width={size} height={size} viewBox="0 0 24 24" fill="currentColor"><path d="M17 3H7c-1.1 0-2 .9-2 2v16l7-3 7 3V5c0-1.1-.9-2-2-2z"/></svg>
          : <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z"/></svg>,
        
        // UI Elements
        ChevronLeft: <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polyline points="15 18 9 12 15 6"/></svg>,
        
        ChevronRight: <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polyline points="9 18 15 12 9 6"/></svg>,
        
        X: <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>,
        
        Settings: <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="12" cy="12" r="3"/><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"/></svg>,
        
        MoreHorizontal: <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="12" cy="12" r="1"/><circle cx="19" cy="12" r="1"/><circle cx="5" cy="12" r="1"/></svg>,
        
        Menu: <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="18" x2="21" y2="18"/></svg>,
        
        Send: <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><line x1="22" y1="2" x2="11" y2="13"/><polygon points="22 2 15 22 11 13 2 9 22 2"/></svg>,
        
        MessageCircle: <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/></svg>,
        
        List: <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><line x1="8" y1="6" x2="21" y2="6"/><line x1="8" y1="12" x2="21" y2="12"/><line x1="8" y1="18" x2="21" y2="18"/><line x1="3" y1="6" x2="3.01" y2="6"/><line x1="3" y1="12" x2="3.01" y2="12"/><line x1="3" y1="18" x2="3.01" y2="18"/></svg>,
        
        Calendar: <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>,
        
        Repeat: <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polyline points="17 1 21 5 17 9"/><path d="M3 11V9a4 4 0 0 1 4-4h14"/><polyline points="7 23 3 19 7 15"/><path d="M21 13v2a4 4 0 0 1-4 4H3"/></svg>,
        
        Check: <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polyline points="20 6 9 17 4 12"/></svg>,
        
        // Spoiler/Warning icon (Darth Vader style mask)
        Mask: <svg width={size} height={size} viewBox="0 0 24 24" fill="currentColor"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z"/><circle cx="9" cy="10" r="1.5"/><circle cx="15" cy="10" r="1.5"/><path d="M12 17c-2.33 0-4.32-1.45-5.12-3.5h1.67c.69 1.19 1.97 2 3.45 2s2.75-.81 3.45-2h1.67c-.8 2.05-2.79 3.5-5.12 3.5z"/></svg>,
        
        // Empty state icon
        Ghost: <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="1.5" strokeLinecap="round" strokeLinejoin="round"><path d="M12 2C8.13 2 5 5.13 5 9v11l2-2 2 2 2-2 2 2 2-2 2 2 2-2V9c0-3.87-3.13-7-7-7z"/><circle cx="9" cy="9" r="1.5" fill="currentColor"/><circle cx="15" cy="9" r="1.5" fill="currentColor"/></svg>
      };
      
      return (
        <span className={className} style={{ display: 'inline-flex', alignItems: 'center', justifyContent: 'center' }}>
          {icons[name] || icons.Star}
        </span>
      );
    };

    // ============================================================================
    // STAR RATING COMPONENT
    // ============================================================================
    
    const StarRating = ({ rating, size = 14, interactive = false, onChange }) => {
      const fullStars = Math.floor(rating);
      const hasHalf = rating % 1 >= 0.5;
      
      if (interactive) {
        return (
          <div className="star-rating star-rating-interactive">
            {[1, 2, 3, 4, 5].map(star => (
              <button
                key={star}
                className={`rating-star ${rating >= star ? 'active' : ''}`}
                onClick={() => onChange && onChange(star)}
                type="button"
              >
                <Icon name="Star" size={size} filled={rating >= star} />
              </button>
            ))}
          </div>
        );
      }
      
      return (
        <span className="star-rating">
          {[1, 2, 3, 4, 5].map(star => (
            <Icon 
              key={star} 
              name="Star" 
              size={size} 
              filled={star <= fullStars || (star === fullStars + 1 && hasHalf)} 
            />
          ))}
        </span>
      );
    };

    // ============================================================================
    // UTILITY FUNCTIONS
    // ============================================================================
    
    const formatTime = (timestamp) => {
      const diff = Date.now() - timestamp;
      const minutes = Math.floor(diff / 60000);
      if (minutes < 1) return 'now';
      if (minutes < 60) return `${minutes}m`;
      const hours = Math.floor(minutes / 60);
      if (hours < 24) return `${hours}h`;
      const days = Math.floor(hours / 24);
      if (days < 7) return `${days}d`;
      return `${Math.floor(days / 7)}w`;
    };
    
    const getRandomQuote = () => MOVIE_QUOTES[Math.floor(Math.random() * MOVIE_QUOTES.length)];
    
    const getUserById = (id) => Object.values(USERS).find(u => u.id === id);
    
    const getShowById = (id) => SHOWS.find(s => s.id === id);
    
    const getEpisodeById = (id) => EPISODES.find(e => e.id === id);

    // ============================================================================
    // MAIN APP COMPONENT
    // ============================================================================
    
    function App() {
      // Navigation state
      const [bottomTab, setBottomTab] = useState('home');
      const [mainTab, setMainTab] = useState('films');
      
      // Filter state
      const [genreFilter, setGenreFilter] = useState('All');
      
      // Detail view state
      const [selectedShow, setSelectedShow] = useState(null);
      const [selectedEpisode, setSelectedEpisode] = useState(null);
      const [showChat, setShowChat] = useState(null);
      
      // User data state
      const [watched, setWatched] = useState({});
      const [liked, setLiked] = useState({});
      const [ratings, setRatings] = useState({});
      const [watchlist, setWatchlist] = useState([]);
      
      // UI state
      const [toast, setToast] = useState(null);
      
      // Toast handler
      const showToast = useCallback((message) => {
        setToast(message);
        setTimeout(() => setToast(null), 2500);
      }, []);
      
      // Action handlers
      const handleWatch = useCallback((episodeId) => {
        setWatched(prev => {
          const newState = { ...prev, [episodeId]: !prev[episodeId] };
          showToast(newState[episodeId] ? 'Marked as watched!' : 'Removed from watched');
          return newState;
        });
      }, [showToast]);
      
      const handleLike = useCallback((episodeId) => {
        setLiked(prev => {
          const newState = { ...prev, [episodeId]: !prev[episodeId] };
          showToast(newState[episodeId] ? 'Liked!' : 'Unliked');
          return newState;
        });
      }, [showToast]);
      
      const handleRate = useCallback((episodeId, rating) => {
        setRatings(prev => ({ ...prev, [episodeId]: rating }));
        showToast(`Rated ${rating} stars!`);
      }, [showToast]);
      
      const handleWatchlist = useCallback((episodeId) => {
        setWatchlist(prev => {
          const isInList = prev.includes(episodeId);
          showToast(isInList ? 'Removed from watchlist' : 'Added to watchlist!');
          return isInList ? prev.filter(id => id !== episodeId) : [...prev, episodeId];
        });
      }, [showToast]);
      
      // Show detail view
      if (selectedShow) {
        return (
          <ShowDetail
            show={selectedShow}
            onBack={() => setSelectedShow(null)}
            onOpenChat={() => setShowChat(selectedShow)}
            onSelectEpisode={setSelectedEpisode}
            watched={watched}
            liked={liked}
            ratings={ratings}
          />
        );
      }
      
      // Chat room view
      if (showChat) {
        return <ChatRoom show={showChat} onBack={() => setShowChat(null)} />;
      }
      
      return (
        <div className="app-container">
          <div className="main-content">
            {bottomTab === 'home' && (
              <HomeScreen
                mainTab={mainTab}
                setMainTab={setMainTab}
                genreFilter={genreFilter}
                setGenreFilter={setGenreFilter}
                onSelectShow={setSelectedShow}
                onSelectEpisode={setSelectedEpisode}
                onOpenChat={setShowChat}
              />
            )}
            {bottomTab === 'search' && (
              <SearchScreen onSelectShow={setSelectedShow} />
            )}
            {bottomTab === 'activity' && (
              <ActivityScreen />
            )}
            {bottomTab === 'profile' && (
              <ProfileScreen
                watched={watched}
                liked={liked}
                ratings={ratings}
                watchlist={watchlist}
                onSelectEpisode={setSelectedEpisode}
              />
            )}
          </div>
          
          {/* Bottom Navigation */}
          <nav className="bottom-nav">
            <button
              className={`nav-item ${bottomTab === 'home' ? 'active' : ''}`}
              onClick={() => setBottomTab('home')}
            >
              <Icon name="Film" size={24} filled={bottomTab === 'home'} />
            </button>
            
            <button
              className={`nav-item ${bottomTab === 'search' ? 'active' : ''}`}
              onClick={() => setBottomTab('search')}
            >
              <Icon name="Search" size={24} />
            </button>
            
            <div className="nav-add">
              <button
                className="nav-add-btn"
                onClick={() => showToast('Add episode coming soon!')}
              >
                <Icon name="Plus" size={24} />
              </button>
            </div>
            
            <button
              className={`nav-item ${bottomTab === 'activity' ? 'active' : ''}`}
              onClick={() => setBottomTab('activity')}
            >
              <Icon name="Activity" size={24} filled={bottomTab === 'activity'} />
            </button>
            
            <button
              className={`nav-item ${bottomTab === 'profile' ? 'active' : ''}`}
              onClick={() => setBottomTab('profile')}
            >
              <Icon name="User" size={24} filled={bottomTab === 'profile'} />
            </button>
          </nav>
          
          {/* Episode Action Sheet */}
          {selectedEpisode && (
            <EpisodeActionSheet
              episode={selectedEpisode}
              show={getShowById(selectedEpisode.showId)}
              onClose={() => setSelectedEpisode(null)}
              watched={watched}
              liked={liked}
              ratings={ratings}
              watchlist={watchlist}
              onWatch={handleWatch}
              onLike={handleLike}
              onRate={handleRate}
              onWatchlist={handleWatchlist}
            />
          )}
          
          {/* Toast Notification */}
          {toast && (
            <div className="toast">
              <div className="toast-content">
                <Icon name="Check" size={20} className="toast-icon" />
                <span className="toast-text">{toast}</span>
              </div>
            </div>
          )}
        </div>
      );
    }

    // ============================================================================
    // HOME SCREEN
    // ============================================================================
    
    function HomeScreen({ mainTab, setMainTab, genreFilter, setGenreFilter, onSelectShow, onSelectEpisode, onOpenChat }) {
      const genres = ['All', 'Reality', 'Drama', 'Comedy'];
      
      const filteredShows = useMemo(() => {
        if (genreFilter === 'All') return SHOWS.filter(s => s.trending);
        return SHOWS.filter(s => s.genre === genreFilter);
      }, [genreFilter]);
      
      return (
        <>
          {/* Header */}
          <div className="header">
            <h1 className="header-title">Episodic</h1>
          </div>
          
          {/* Top Tabs */}
          <div className="top-tabs">
            {['Films', 'Reviews', 'Lists', 'Journal'].map(tab => (
              <button
                key={tab}
                className={`top-tab ${mainTab === tab.toLowerCase() ? 'active' : ''}`}
                onClick={() => setMainTab(tab.toLowerCase())}
              >
                {tab}
              </button>
            ))}
            <div className="notification-dot" />
          </div>
          
          {/* Genre Filter Pills (for Films tab) */}
          {mainTab === 'films' && (
            <div className="genre-pills">
              {genres.map(genre => (
                <button
                  key={genre}
                  className={`genre-pill ${genreFilter === genre ? 'active' : ''}`}
                  onClick={() => setGenreFilter(genre)}
                >
                  {genre}
                </button>
              ))}
            </div>
          )}
          
          {/* Tab Content */}
          {mainTab === 'films' && (
            <FilmsTab shows={filteredShows} onSelectShow={onSelectShow} />
          )}
          {mainTab === 'reviews' && (
            <ReviewsTab onSelectEpisode={onSelectEpisode} />
          )}
          {mainTab === 'lists' && (
            <ListsTab onSelectShow={onSelectShow} />
          )}
          {mainTab === 'journal' && (
            <JournalTab />
          )}
        </>
      );
    }

    // ============================================================================
    // FILMS TAB
    // ============================================================================
    
    function FilmsTab({ shows, onSelectShow }) {
      return (
        <>
          <div className="section-header">Popular this week</div>
          <div className="poster-grid">
            {shows.map((show, index) => (
              <div
                key={show.id}
                className="poster-item animate-in"
                style={{ animationDelay: `${index * 40}ms` }}
                onClick={() => onSelectShow(show)}
              >
                <img
                  src={show.poster}
                  alt={show.name}
                  className="poster-img"
                  loading="lazy"
                />
                {show.rating >= 8 && (
                  <div className="poster-badge">
                    <Icon name="Star" size={10} filled />
                    {show.rating}
                  </div>
                )}
              </div>
            ))}
          </div>
        </>
      );
    }

    // ============================================================================
    // REVIEWS TAB
    // ============================================================================
    
    function ReviewsTab({ onSelectEpisode }) {
      return (
        <>
          <div className="section-header">Popular this week</div>
          {REVIEWS.map((review, index) => {
            const user = getUserById(review.userId);
            const show = getShowById(review.showId);
            const episode = getEpisodeById(review.episodeId);
            
            return (
              <div
                key={review.id}
                className="review-card animate-in"
                style={{ animationDelay: `${index * 50}ms` }}
              >
                <div className="review-header">
                  <img
                    src={show?.poster}
                    alt={show?.name}
                    className="review-poster"
                  />
                  <div className="review-info">
                    <div className="review-user">
                      <div className="avatar avatar-xs">
                        {user?.username?.charAt(0).toUpperCase()}
                      </div>
                      <span className="review-username">{user?.username}</span>
                      {user?.badge && (
                        <span className={`badge badge-${user.badge}`}>
                          {user.badge}
                        </span>
                      )}
                    </div>
                    <div className="review-title">{show?.name}</div>
                    <div className="review-meta">
                      <span>{show?.year}</span>
                      <span></span>
                      <span>S{episode?.season}E{episode?.episode}</span>
                      <span></span>
                      <StarRating rating={review.rating} size={12} />
                      {review.likes > 50 && (
                        <>
                          <span></span>
                          <Icon name="Heart" size={12} filled style={{ color: 'var(--brand-orange)' }} />
                        </>
                      )}
                    </div>
                  </div>
                </div>
                
                {review.hasSpoilers ? (
                  <div className="spoiler-block">
                    <Icon name="Mask" size={40} className="spoiler-icon" />
                    <span className="spoiler-text">
                      This review may contain spoilers. Tap to reveal.
                    </span>
                  </div>
                ) : (
                  <p className="review-text line-clamp-3">{review.content}</p>
                )}
              </div>
            );
          })}
        </>
      );
    }

    // ============================================================================
    // LISTS TAB
    // ============================================================================
    
    function ListsTab({ onSelectShow }) {
      return (
        <>
          <div className="section-header">Popular this week</div>
          {LISTS.map((list, index) => {
            const user = getUserById(list.userId);
            const shows = list.showIds.map(id => getShowById(id)).filter(Boolean);
            
            return (
              <div
                key={list.id}
                className="list-card animate-in"
                style={{ animationDelay: `${index * 50}ms` }}
              >
                <div className="list-header">
                  <h3 className={`list-title ${list.featured ? 'featured' : ''}`}>
                    {list.name}
                  </h3>
                  <div className="avatar avatar-xs">
                    {user?.username?.charAt(0).toUpperCase()}
                  </div>
                </div>
                <p className="list-desc line-clamp-2">{list.description}</p>
                <div className="list-posters">
                  {shows.map(show => (
                    <img
                      key={show.id}
                      src={show.poster}
                      alt={show.name}
                      className="list-poster"
                      onClick={() => onSelectShow(show)}
                    />
                  ))}
                </div>
                <div className="list-meta">
                  <span>{list.likes} likes</span>
                  <span></span>
                  <span>{list.comments} comments</span>
                </div>
              </div>
            );
          })}
        </>
      );
    }

    // ============================================================================
    // JOURNAL TAB
    // ============================================================================
    
    function JournalTab() {
      const articles = [
        {
          id: 1,
          title: 'Peak Reality TV',
          description: 'Why 2024 is the golden age of reality television. From Love Island to The Traitors, we break down what makes these shows so addictive.',
          image: 'https://image.tmdb.org/t/p/w1280/rCqYXh6ztQLpC1BKW3KF0v3DXNP.jpg'
        },
        {
          id: 2,
          title: 'The Bear: A Study in Chaos',
          description: 'How <em>The Bear</em> redefined the prestige TV kitchen drama and why it matters for the future of television.',
          image: 'https://image.tmdb.org/t/p/w1280/9z3CCXR7UsCWqmGXVj5aJP0Tc6p.jpg'
        },
        {
          id: 3,
          title: 'The Last of Us: Gaming\'s TV Moment',
          description: 'What the HBO adaptation means for the future of video game adaptations and prestige television.',
          image: 'https://image.tmdb.org/t/p/w1280/uDgy6hyPd82kOHh6I95FLtLnj6p.jpg'
        }
      ];
      
      return (
        <>
          {articles.map((article, index) => (
            <div
              key={article.id}
              className="journal-card animate-in"
              style={{ animationDelay: `${index * 50}ms` }}
            >
              <img
                src={article.image}
                alt={article.title}
                className="journal-img"
              />
              <h3 className="journal-title">{article.title}</h3>
              <p
                className="journal-desc"
                dangerouslySetInnerHTML={{ __html: article.description }}
              />
            </div>
          ))}
        </>
      );
    }

    // ============================================================================
    // SEARCH SCREEN
    // ============================================================================
    
    function SearchScreen({ onSelectShow }) {
      const [query, setQuery] = useState('');
      
      const results = useMemo(() => {
        if (!query.trim()) return [];
        const q = query.toLowerCase();
        return SHOWS.filter(show =>
          show.name.toLowerCase().includes(q) ||
          show.genre.toLowerCase().includes(q) ||
          show.subgenre.toLowerCase().includes(q)
        );
      }, [query]);
      
      const browseOptions = [
        'Genre, network or year',
        'Service',
        'Most popular',
        'Highest rated',
        'Most anticipated',
        'Top 250 episodes'
      ];
      
      return (
        <>
          <div className="header">
            <h1 style={{ fontSize: 'var(--text-xl)', fontWeight: 700, textAlign: 'center' }}>
              Search
            </h1>
          </div>
          
          <div className="search-bar">
            <Icon name="Search" size={18} />
            <input
              type="text"
              placeholder="Find shows, episodes, members, reviews..."
              value={query}
              onChange={(e) => setQuery(e.target.value)}
            />
          </div>
          
          {!query.trim() ? (
            <>
              <div className="section-header">Browse by</div>
              {browseOptions.map(option => (
                <div key={option} className="profile-row">
                  <span className="profile-row-label">{option}</span>
                  <Icon name="ChevronRight" size={18} style={{ color: 'var(--text-tertiary)' }} />
                </div>
              ))}
            </>
          ) : (
            <>
              <div className="section-header">{results.length} Results</div>
              {results.length > 0 ? (
                <div className="poster-grid">
                  {results.map((show, index) => (
                    <div
                      key={show.id}
                      className="poster-item animate-in"
                      style={{ animationDelay: `${index * 40}ms` }}
                      onClick={() => onSelectShow(show)}
                    >
                      <img src={show.poster} alt={show.name} className="poster-img" />
                    </div>
                  ))}
                </div>
              ) : (
                <EmptyState quote={getRandomQuote()} title="No results found." />
              )}
            </>
          )}
        </>
      );
    }

    // ============================================================================
    // ACTIVITY SCREEN - User's #1 Feature Request
    // Instagram-style: Friends / You / Incoming tabs
    // ============================================================================
    
    function ActivityScreen() {
      const [activeTab, setActiveTab] = useState('friends');
      
      return (
        <>
          <div className="header">
            <div className="header-row">
              <div style={{ width: 44 }} />
              <h1 style={{ fontSize: 'var(--text-xl)', fontWeight: 700 }}>Activity</h1>
              <button className="header-action">
                <Icon name="Settings" size={22} />
              </button>
            </div>
          </div>
          
          {/* Segmented Control - The key feature */}
          <div className="segment-control">
            <button
              className={`segment-btn ${activeTab === 'friends' ? 'active' : ''}`}
              onClick={() => setActiveTab('friends')}
            >
              Friends
            </button>
            <button
              className={`segment-btn ${activeTab === 'you' ? 'active' : ''}`}
              onClick={() => setActiveTab('you')}
            >
              You
            </button>
            <button
              className={`segment-btn ${activeTab === 'incoming' ? 'active' : ''}`}
              onClick={() => setActiveTab('incoming')}
            >
              Incoming
            </button>
          </div>
          
          {/* Tab Content */}
          {activeTab === 'friends' && <FriendsActivity />}
          {activeTab === 'you' && <YouActivity />}
          {activeTab === 'incoming' && <IncomingActivity />}
        </>
      );
    }
    
    function FriendsActivity() {
      return (
        <>
          {FRIEND_ACTIVITY.map((activity, index) => {
            const user = getUserById(activity.userId);
            
            let content;
            switch (activity.type) {
              case 'liked':
                content = (
                  <>
                    <strong>{user?.username}</strong> liked{' '}
                    <strong>{activity.targetUser}'s</strong>{' '}
                    {activity.rating && <StarRating rating={activity.rating} size={12} />}{' '}
                    review of <strong>{activity.showName}</strong>
                  </>
                );
                break;
              case 'followed':
                content = (
                  <>
                    <strong>{user?.username}</strong> followed{' '}
                    <strong>{activity.targetUser}</strong>
                  </>
                );
                break;
              case 'added':
                content = (
                  <>
                    <strong>{user?.username}</strong> added{' '}
                    <strong>{activity.showName}</strong> to their {activity.listType}
                  </>
                );
                break;
              case 'reviewed':
                content = (
                  <>
                    <strong>{user?.username}</strong> reviewed{' '}
                    <strong>{activity.showName}</strong> {activity.episodeName}{' '}
                    <StarRating rating={activity.rating} size={12} />
                  </>
                );
                break;
              case 'list':
                content = (
                  <>
                    <strong>{user?.username}</strong> created a list:{' '}
                    <strong>{activity.listName}</strong>
                  </>
                );
                break;
              default:
                content = <strong>{user?.username}</strong>;
            }
            
            return (
              <div
                key={activity.id}
                className="activity-item animate-in"
                style={{ animationDelay: `${index * 30}ms` }}
              >
                <div className="avatar">
                  {user?.username?.charAt(0).toUpperCase()}
                </div>
                <div className="activity-content">
                  <div className="activity-text">{content}</div>
                  <div className="activity-time">{formatTime(activity.time)}</div>
                </div>
              </div>
            );
          })}
        </>
      );
    }
    
    function YouActivity() {
      if (YOUR_ACTIVITY.length === 0) {
        return <EmptyState quote={getRandomQuote()} title="No activity." />;
      }
      
      return (
        <>
          {YOUR_ACTIVITY.map((activity, index) => {
            const user = getUserById(activity.fromUser) || { username: activity.fromUser };
            
            return (
              <div
                key={activity.id}
                className="activity-item animate-in"
                style={{ animationDelay: `${index * 30}ms` }}
              >
                <div className="avatar">
                  {user.username?.charAt(0).toUpperCase()}
                </div>
                <div className="activity-content">
                  <div className="activity-text">
                    <strong>{user.username}</strong> {activity.content}
                  </div>
                  <div className="activity-time">{formatTime(activity.time)}</div>
                </div>
              </div>
            );
          })}
        </>
      );
    }
    
    function IncomingActivity() {
      if (INCOMING_ACTIVITY.length === 0) {
        return <EmptyState quote={getRandomQuote()} title="No activity." />;
      }
      
      return (
        <>
          {INCOMING_ACTIVITY.map((activity, index) => {
            const user = getUserById(activity.fromUser) || { username: activity.fromUser };
            
            return (
              <div
                key={activity.id}
                className="activity-item animate-in"
                style={{ animationDelay: `${index * 30}ms` }}
              >
                <div className="avatar">
                  {user.username?.charAt(0).toUpperCase()}
                </div>
                <div className="activity-content">
                  <div className="activity-text">
                    <strong>{user.username}</strong> {activity.content}
                  </div>
                  <div className="activity-time">{formatTime(activity.time)}</div>
                </div>
              </div>
            );
          })}
        </>
      );
    }

    // ============================================================================
    // PROFILE SCREEN
    // ============================================================================
    
    function ProfileScreen({ watched, liked, ratings, watchlist, onSelectEpisode }) {
      const [activeTab, setActiveTab] = useState('profile');
      const user = USERS.current;
      
      const watchedCount = Object.keys(watched).filter(k => watched[k]).length;
      const ratedCount = Object.keys(ratings).length;
      
      return (
        <>
          <div className="header">
            <div className="header-row">
              <button className="header-action">
                <Icon name="Settings" size={22} />
              </button>
              <h1 style={{ fontSize: 'var(--text-lg)', fontWeight: 600 }}>
                {user.username}
              </h1>
              <button className="header-action">
                <Icon name="MoreHorizontal" size={22} />
              </button>
            </div>
          </div>
          
          {/* Profile Tabs */}
          <div className="top-tabs" style={{ justifyContent: 'center' }}>
            {['Profile', 'Diary', 'Lists', 'Watchlist'].map(tab => (
              <button
                key={tab}
                className={`top-tab ${activeTab === tab.toLowerCase() ? 'active' : ''}`}
                onClick={() => setActiveTab(tab.toLowerCase())}
              >
                {tab}
              </button>
            ))}
          </div>
          
          {/* Tab Content */}
          {activeTab === 'profile' && (
            <ProfileTab user={user} watchedCount={watchedCount} ratedCount={ratedCount} watchlistCount={watchlist.length} />
          )}
          {activeTab === 'diary' && (
            <DiaryTab watched={watched} liked={liked} ratings={ratings} onSelectEpisode={onSelectEpisode} />
          )}
          {activeTab === 'lists' && (
            <UserListsTab />
          )}
          {activeTab === 'watchlist' && (
            <WatchlistTab watchlist={watchlist} />
          )}
        </>
      );
    }
    
    function ProfileTab({ user, watchedCount, ratedCount, watchlistCount }) {
      return (
        <>
          <div className="profile-header">
            <div className="avatar avatar-lg">
              {user.username.charAt(0).toUpperCase()}
            </div>
          </div>
          
          <div className="profile-row">
            <span className="profile-row-label">Activity</span>
            <Icon name="ChevronRight" size={18} style={{ color: 'var(--text-tertiary)' }} />
          </div>
          
          <div className="profile-section-label">REMOVE ADS</div>
          
          <div className="profile-row">
            <span className="profile-row-label">Films</span>
            <span className="profile-row-value">{watchedCount}</span>
          </div>
          
          <div className="profile-row">
            <span className="profile-row-label">Diary</span>
            <span className="profile-row-value">{watchedCount}</span>
          </div>
          
          <div className="profile-row">
            <span className="profile-row-label">Reviews</span>
            <span className="profile-row-value">{ratedCount}</span>
          </div>
          
          <div className="profile-row">
            <span className="profile-row-label">Lists</span>
            <span className="profile-row-value">
              0
              <Icon name="ChevronRight" size={16} />
            </span>
          </div>
          
          <div className="profile-row">
            <span className="profile-row-label">Watchlist</span>
            <span className="profile-row-value">
              {watchlistCount}
              <Icon name="ChevronRight" size={16} />
            </span>
          </div>
          
          <div className="profile-row">
            <span className="profile-row-label">Following</span>
            <span className="profile-row-value">
              {user.following}
              <Icon name="ChevronRight" size={16} />
            </span>
          </div>
          
          <div className="profile-row">
            <span className="profile-row-label">Followers</span>
            <span className="profile-row-value">
              {user.followers}
              <Icon name="ChevronRight" size={16} />
            </span>
          </div>
        </>
      );
    }
    
    function DiaryTab({ watched, liked, ratings, onSelectEpisode }) {
      const watchedEpisodes = Object.entries(watched)
        .filter(([_, isWatched]) => isWatched)
        .map(([epId]) => {
          const episode = getEpisodeById(parseInt(epId));
          const show = episode ? getShowById(episode.showId) : null;
          return { episode, show, epId: parseInt(epId) };
        })
        .filter(item => item.episode && item.show);
      
      if (watchedEpisodes.length === 0) {
        return <EmptyState quote={getRandomQuote()} title="No diary entries." />;
      }
      
      return (
        <>
          <div className="diary-month">JANUARY 2024</div>
          {watchedEpisodes.map(({ episode, show, epId }, index) => (
            <div
              key={epId}
              className="diary-entry animate-in"
              style={{ animationDelay: `${index * 40}ms` }}
              onClick={() => onSelectEpisode(episode)}
            >
              <div className="diary-date">{27 - index}</div>
              <img src={show.poster} alt={show.name} className="diary-poster" />
              <div className="diary-info">
                <div className="diary-title">{show.name}</div>
                <div className="diary-meta">
                  {show.year}  S{episode.season}E{episode.episode}
                </div>
                <div className="diary-actions">
                  {ratings[epId] && <StarRating rating={ratings[epId]} size={12} />}
                  {liked[epId] && (
                    <Icon name="Heart" size={14} filled style={{ color: 'var(--brand-orange)' }} />
                  )}
                  <span className="diary-menu">
                    <Icon name="Menu" size={14} />
                  </span>
                </div>
              </div>
            </div>
          ))}
        </>
      );
    }
    
    function UserListsTab() {
      return <EmptyState quote={getRandomQuote()} title="No lists." />;
    }
    
    function WatchlistTab({ watchlist }) {
      if (watchlist.length === 0) {
        return <EmptyState quote={getRandomQuote()} title="No films in watchlist." />;
      }
      
      const items = watchlist
        .map(epId => {
          const episode = getEpisodeById(epId);
          const show = episode ? getShowById(episode.showId) : null;
          return { episode, show, epId };
        })
        .filter(item => item.show);
      
      return (
        <div className="poster-grid" style={{ padding: 'var(--space-16)' }}>
          {items.map(({ show, epId }, index) => (
            <div
              key={epId}
              className="poster-item animate-in"
              style={{ animationDelay: `${index * 40}ms` }}
            >
              <img src={show.poster} alt={show.name} className="poster-img" />
            </div>
          ))}
        </div>
      );
    }

    // ============================================================================
    // EMPTY STATE COMPONENT
    // ============================================================================
    
    function EmptyState({ title, quote }) {
      const movieQuote = quote || getRandomQuote();
      
      return (
        <div className="empty-state">
          <Icon name="Ghost" size={64} className="empty-icon" />
          <div className="empty-title">{title}</div>
          <div className="empty-quote">"{movieQuote.quote}"</div>
        </div>
      );
    }

    // ============================================================================
    // SHOW DETAIL
    // ============================================================================
    
    function ShowDetail({ show, onBack, onOpenChat, onSelectEpisode, watched, liked, ratings }) {
      const episodes = EPISODES.filter(ep => ep.showId === show.id);
      const chatMessages = CHAT_MESSAGES[show.id] || [];
      
      return (
        <div className="app-container">
          <div className="main-content">
            {/* Hero Header */}
            <div className="show-header">
              <img
                src={show.backdrop || show.poster}
                alt={show.name}
                className="show-backdrop"
              />
              <div className="show-backdrop-overlay" />
              
              <button className="show-back-btn" onClick={onBack}>
                <Icon name="ChevronLeft" size={24} />
              </button>
              
              <div className="show-info">
                <h1 className="show-title">{show.name}</h1>
                <div className="show-meta">
                  <span>{show.year}</span>
                  <span></span>
                  <span>{show.genre}</span>
                  <span></span>
                  <span className="show-rating">
                    <Icon name="Star" size={14} filled />
                    {show.rating}
                  </span>
                </div>
              </div>
            </div>
            
            {/* Chat Room Button */}
            <div style={{ padding: 'var(--space-16)' }}>
              <button
                className="btn btn-secondary btn-full"
                onClick={onOpenChat}
              >
                <Icon name="MessageCircle" size={20} />
                Join Chat Room
                {chatMessages.length > 0 && (
                  <span className="badge badge-live" style={{ marginLeft: 'auto' }}>
                    LIVE
                  </span>
                )}
              </button>
            </div>
            
            {/* Episodes List */}
            <div className="section-header">Episodes</div>
            {episodes.map((episode, index) => {
              const isWatched = watched[episode.id];
              const isLiked = liked[episode.id];
              const userRating = ratings[episode.id];
              
              return (
                <div
                  key={episode.id}
                  className="card card-interactive animate-in"
                  style={{ animationDelay: `${index * 40}ms` }}
                  onClick={() => onSelectEpisode(episode)}
                >
                  <div style={{ display: 'flex', gap: 'var(--space-12)' }}>
                    <div style={{ position: 'relative', flexShrink: 0 }}>
                      <img
                        src={episode.image}
                        alt={episode.name}
                        style={{
                          width: '100px',
                          height: '56px',
                          borderRadius: 'var(--radius-sm)',
                          objectFit: 'cover'
                        }}
                      />
                      {userRating && (
                        <div style={{
                          position: 'absolute',
                          top: 'var(--space-4)',
                          right: 'var(--space-4)',
                          background: 'rgba(0,0,0,0.85)',
                          padding: '2px 6px',
                          borderRadius: 'var(--radius-xs)',
                          fontSize: '10px',
                          fontWeight: 700,
                          color: 'var(--brand-green)',
                          display: 'flex',
                          alignItems: 'center',
                          gap: '2px'
                        }}>
                          <Icon name="Star" size={8} filled />
                          {userRating}
                        </div>
                      )}
                    </div>
                    
                    <div style={{ flex: 1, minWidth: 0 }}>
                      <div style={{
                        fontSize: 'var(--text-xs)',
                        color: 'var(--text-tertiary)',
                        fontWeight: 600,
                        textTransform: 'uppercase',
                        letterSpacing: '0.5px',
                        marginBottom: 'var(--space-4)'
                      }}>
                        S{episode.season}E{episode.episode}
                      </div>
                      <div style={{
                        fontSize: 'var(--text-base)',
                        fontWeight: 600,
                        marginBottom: 'var(--space-4)'
                      }}>
                        {episode.name}
                      </div>
                      <div style={{
                        display: 'flex',
                        alignItems: 'center',
                        gap: 'var(--space-8)',
                        fontSize: 'var(--text-xs)',
                        color: 'var(--text-tertiary)'
                      }}>
                        <span>{episode.airDate}</span>
                        {isWatched && (
                          <Icon name="Eye" size={14} filled style={{ color: 'var(--brand-green)' }} />
                        )}
                        {isLiked && (
                          <Icon name="Heart" size={14} filled style={{ color: 'var(--brand-orange)' }} />
                        )}
                      </div>
                    </div>
                  </div>
                </div>
              );
            })}
          </div>
        </div>
      );
    }

    // ============================================================================
    // CHAT ROOM - User's Key Feature
    // ============================================================================
    
    function ChatRoom({ show, onBack }) {
      const [messages, setMessages] = useState(CHAT_MESSAGES[show.id] || []);
      const [newMessage, setNewMessage] = useState('');
      const messagesEndRef = useRef(null);
      
      const scrollToBottom = () => {
        messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });
      };
      
      useEffect(() => {
        scrollToBottom();
      }, [messages]);
      
      const handleSend = () => {
        if (!newMessage.trim()) return;
        
        const message = {
          id: Date.now(),
          oderId: '1',
          text: newMessage.trim(),
          time: Date.now()
        };
        
        setMessages(prev => [...prev, message]);
        setNewMessage('');
      };
      
      const handleKeyPress = (e) => {
        if (e.key === 'Enter' && !e.shiftKey) {
          e.preventDefault();
          handleSend();
        }
      };
      
      return (
        <div className="app-container">
          <div className="chat-room">
            {/* Header */}
            <div className="header" style={{
              background: 'var(--bg-tab-bar)',
              borderBottom: '1px solid var(--divider)'
            }}>
              <div className="header-row">
                <button className="header-action" onClick={onBack}>
                  <Icon name="ChevronLeft" size={24} />
                </button>
                <div className="chat-header-info">
                  <div className="chat-header-title">{show.name}</div>
                  <div className="chat-header-subtitle">
                    {messages.length} messages
                  </div>
                </div>
                <button className="header-action">
                  <Icon name="MoreHorizontal" size={24} />
                </button>
              </div>
            </div>
            
            {/* Messages */}
            <div className="chat-messages">
              {messages.length === 0 ? (
                <EmptyState title="No messages yet" quote={{ quote: 'Be the first to start the conversation!', source: '' }} />
              ) : (
                messages.map((msg, index) => {
                  const user = getUserById(msg.oderId);
                  const isOwn = msg.oderId === '1';
                  
                  return (
                    <div
                      key={msg.id}
                      className={`chat-message ${isOwn ? 'own' : ''}`}
                    >
                      {!isOwn && (
                        <div className="avatar" style={{ width: '32px', height: '32px', fontSize: '12px' }}>
                          {user?.username?.charAt(0).toUpperCase() || '?'}
                        </div>
                      )}
                      <div className={`chat-bubble ${isOwn ? 'own' : ''}`}>
                        {!isOwn && (
                          <div className="chat-bubble-username">
                            {user?.username || 'Unknown'}
                          </div>
                        )}
                        <div className="chat-bubble-text">{msg.text}</div>
                        <div className="chat-bubble-time" style={{ textAlign: isOwn ? 'right' : 'left' }}>
                          {formatTime(msg.time)}
                        </div>
                      </div>
                    </div>
                  );
                })
              )}
              <div ref={messagesEndRef} />
            </div>
            
            {/* Input */}
            <div className="chat-input-area">
              <input
                type="text"
                className="chat-input"
                placeholder="Type a message..."
                value={newMessage}
                onChange={(e) => setNewMessage(e.target.value)}
                onKeyPress={handleKeyPress}
              />
              <button
                className="chat-send"
                onClick={handleSend}
                disabled={!newMessage.trim()}
              >
                <Icon name="Send" size={20} />
              </button>
            </div>
          </div>
        </div>
      );
    }

    // ============================================================================
    // EPISODE ACTION SHEET - Letterboxd Style
    // ============================================================================
    
    function EpisodeActionSheet({
      episode,
      show,
      onClose,
      watched,
      liked,
      ratings,
      watchlist,
      onWatch,
      onLike,
      onRate,
      onWatchlist
    }) {
      const [rating, setRating] = useState(ratings[episode.id] || 0);
      
      const isWatched = watched[episode.id];
      const isLiked = liked[episode.id];
      const inWatchlist = watchlist.includes(episode.id);
      
      const handleRating = (newRating) => {
        const finalRating = rating === newRating ? 0 : newRating;
        setRating(finalRating);
        if (finalRating > 0) {
          onRate(episode.id, finalRating);
        }
      };
      
      return (
        <>
          <div className="overlay" onClick={onClose} />
          <div className="bottom-sheet">
            <div className="sheet-handle" />
            
            <div className="action-sheet">
              {/* Show/Episode Info */}
              <div style={{
                textAlign: 'center',
                marginBottom: 'var(--space-20)',
                paddingBottom: 'var(--space-16)',
                borderBottom: '1px solid var(--divider)'
              }}>
                <div style={{ fontWeight: 600, fontSize: 'var(--text-lg)' }}>
                  {show?.name}
                </div>
                <div style={{ color: 'var(--text-tertiary)', fontSize: 'var(--text-sm)', marginTop: 'var(--space-4)' }}>
                  S{episode.season}E{episode.episode}  {episode.name}
                </div>
              </div>
              
              {/* Action Buttons Row */}
              <div className="action-row">
                <button
                  className={`action-btn ${isWatched ? 'active' : ''}`}
                  onClick={() => onWatch(episode.id)}
                >
                  <Icon name="Eye" size={32} filled={isWatched} />
                  <span className="action-label">Logged</span>
                </button>
                
                <button
                  className={`action-btn ${isLiked ? 'liked' : ''}`}
                  onClick={() => onLike(episode.id)}
                >
                  <Icon name="Heart" size={32} filled={isLiked} />
                  <span className="action-label">Liked</span>
                </button>
                
                <button
                  className={`action-btn ${inWatchlist ? 'active' : ''}`}
                  onClick={() => onWatchlist(episode.id)}
                >
                  <Icon name="Clock" size={32} />
                  <span className="action-label">Watchlist</span>
                </button>
              </div>
              
              <div className="action-divider" />
              
              {/* Rating Section */}
              <div className="rating-section">
                <div className="rating-label">Rated</div>
                <div className="rating-stars">
                  {[1, 2, 3, 4, 5].map(star => (
                    <button
                      key={star}
                      className={`rating-star ${rating >= star ? 'active' : ''}`}
                      onClick={() => handleRating(star)}
                    >
                      <Icon name="Star" size={32} filled={rating >= star} />
                    </button>
                  ))}
                </div>
              </div>
              
              <div className="action-divider" />
              
              {/* Menu Options */}
              <div className="menu-item">Review or log again</div>
              <div className="menu-item">Add to a list</div>
              <div className="menu-item">Go to episode</div>
              <div className="menu-item disabled">Share to Instagram Stories</div>
            </div>
          </div>
        </>
      );
    }

    // ============================================================================
    // RENDER APP
    // ============================================================================
    
    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(<App />);
  </script>
</body>
</html>
